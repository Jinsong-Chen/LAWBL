<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="PEFA is a partially exploratory approach to factor analysis, which can incorporate
partial knowledge together with unknown number of factors, using bi-level Bayesian regularization.
When partial knowledge is not needed, it reduces to the fully exploratory factor analysis (FEFA; Chen, 2021).
A large number of factors can be imposed for selection where true factors will be identified against spurious factors.
The loading vector is reparameterized to tackle model sparsity at the factor and loading levels
with the multivariate spike and slab priors. Parameters are obtained by sampling from the posterior
distributions with the Markov chain Monte Carlo (MCMC) techniques. The estimation results can be summarized
with summary.lawbl and the trace or density of the posterior can be plotted with plot_lawbl."><title>Partially Exploratory Factor Analysis — pefa • LAWBL</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Partially Exploratory Factor Analysis — pefa"><meta property="og:description" content="PEFA is a partially exploratory approach to factor analysis, which can incorporate
partial knowledge together with unknown number of factors, using bi-level Bayesian regularization.
When partial knowledge is not needed, it reduces to the fully exploratory factor analysis (FEFA; Chen, 2021).
A large number of factors can be imposed for selection where true factors will be identified against spurious factors.
The loading vector is reparameterized to tackle model sparsity at the factor and loading levels
with the multivariate spike and slab priors. Parameters are obtained by sampling from the posterior
distributions with the Markov chain Monte Carlo (MCMC) techniques. The estimation results can be summarized
with summary.lawbl and the trace or density of the posterior can be plotted with plot_lawbl."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LAWBL</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/LAWBL.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Examples/gpcfa-examples.html">gpcfa-examples</a>
    <a class="dropdown-item" href="../articles/Examples/pcfa-examples.html">pcfa-examples</a>
    <a class="dropdown-item" href="../articles/Examples/pcirm-examples.html">pcirm-examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Jinsong-Chen/LAWBL/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Partially Exploratory Factor Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/Jinsong-Chen/LAWBL/blob/HEAD/R/pefa.R" class="external-link"><code>R/pefa.R</code></a></small>
      <div class="d-none name"><code>pefa.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>PEFA</code> is a partially exploratory approach to factor analysis, which can incorporate
partial knowledge together with unknown number of factors, using bi-level Bayesian regularization.
When partial knowledge is not needed, it reduces to the fully exploratory factor analysis (<code>FEFA</code>; Chen, 2021).
A large number of factors can be imposed for selection where true factors will be identified against spurious factors.
The loading vector is reparameterized to tackle model sparsity at the factor and loading levels
with the multivariate spike and slab priors. Parameters are obtained by sampling from the posterior
distributions with the Markov chain Monte Carlo (MCMC) techniques. The estimation results can be summarized
with <code><a href="summary.lawbl.html">summary.lawbl</a></code> and the trace or density of the posterior can be plotted with <code><a href="plot_lawbl.html">plot_lawbl</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pefa</span><span class="op">(</span>
  <span class="va">dat</span>,
  Q <span class="op">=</span> <span class="cn">NULL</span>,
  K <span class="op">=</span> <span class="fl">8</span>,
  mjf <span class="op">=</span> <span class="fl">3</span>,
  PPMC <span class="op">=</span> <span class="cn">FALSE</span>,
  burn <span class="op">=</span> <span class="fl">5000</span>,
  iter <span class="op">=</span> <span class="fl">5000</span>,
  missing <span class="op">=</span> <span class="cn">NA</span>,
  eig_eps <span class="op">=</span> <span class="fl">1</span>,
  sign_eps <span class="op">=</span> <span class="fl">0</span>,
  rfit <span class="op">=</span> <span class="cn">TRUE</span>,
  rs <span class="op">=</span> <span class="cn">FALSE</span>,
  update <span class="op">=</span> <span class="fl">1000</span>,
  rseed <span class="op">=</span> <span class="fl">12345</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  auto_stop <span class="op">=</span> <span class="cn">FALSE</span>,
  max_conv <span class="op">=</span> <span class="fl">10</span>,
  digits <span class="op">=</span> <span class="fl">4</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dat</dt>
<dd><p>A \(N \times J\) data <em>matrix</em> or <em>data.frame</em> consisting of the
responses of \(N\) individuals to \(J\) items.</p></dd>
<dt>Q</dt>
<dd><p>A \(J \times K\) design matrix for the loading pattern with \(K\) factors and \(J\) items for <code>PEFA</code>.
Elements are 1, -1, and 0 for specified, unspecified, and zero-fixed loadings, respectively. It's not needed
for <code>FEFA</code>, which is the default. See <code>Examples</code>.</p></dd>
<dt>K</dt>
<dd><p>Maximum number of factors for selection under <code>FEFA</code>. Not used for <code>PEFA</code>.</p></dd>
<dt>mjf</dt>
<dd><p>Minimum number of items per factor.</p></dd>
<dt>PPMC</dt>
<dd><p>logical; <code>TRUE</code> for conducting posterior predictive model checking.</p></dd>
<dt>burn</dt>
<dd><p>Number of burn-in iterations before posterior sampling.</p></dd>
<dt>iter</dt>
<dd><p>Number of formal iterations for posterior sampling (&gt; 0).</p></dd>
<dt>eig_eps</dt>
<dd><p>minimum eigenvalue for factor extraction.</p></dd>
<dt>sign_eps</dt>
<dd><p>minimum value for switch sign of loading vector.</p></dd>
<dt>rfit</dt>
<dd><p>logical; <code>TRUE</code> for providing relative fit (DIC, BIC, AIC).</p></dd>
<dt>rs</dt>
<dd><p>logical; <code>TRUE</code> for enabling recommendation system.</p></dd>
<dt>update</dt>
<dd><p>Number of iterations to update the sampling information.</p></dd>
<dt>rseed</dt>
<dd><p>An integer for the random seed.</p></dd>
<dt>verbose</dt>
<dd><p>logical; to display the sampling information every <code>update</code> or not.</p><ul><li><p><code>Feigen</code>: Eigenvalue for each factor.</p></li>
<li><p><code>NLA_lg0</code>: Number of Loading magnitudes &gt; 0 for each factor.</p></li>
<li><p><code>iShrink</code>: Inverted shrinkage parameter for each factor.</p></li>
<li><p><code>True Fa</code>: Is the factor identified as true or not.</p></li>
<li><p><code>EPSR &amp; NCOV</code>: EPSR for each factor &amp; # of convergence.</p></li>
<li><p><code>ROW: LA overflow,sign switch,bk=0, &lt;eig_eps</code>: Loading overflow, sign switch,
     vector bk=0 and eigenvalue&lt;eig_eps.</p></li>
</ul></dd>
<dt>auto_stop</dt>
<dd><p>logical; <code>TRUE</code> for enabling auto stop based on EPSR.</p></dd>
<dt>max_conv</dt>
<dd><p>maximum consecutive number of convergence for auto stop.</p></dd>
<dt>digits</dt>
<dd><p>Number of significant digits to print when printing numeric values.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>pcfa</code> returns an object of class <code>lawbl</code> without item intercepts. It contains a lot of information about
the posteriors that can be summarized using <code><a href="summary.lawbl.html">summary.lawbl</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chen, J. (2021). A Bayesian regularized approach to exploratory factor analysis in one step.
 <em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
  28(4), 518-528. DOI: 10.1080/10705511.2020.1854763.</p>
<p>Chen, J. (In Press). Fully and partially exploratory factor analysis with bi-level Bayesian regularization.
 <em>Behavior Research Methods</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co">#####################################################</span></span>
<span class="r-in"><span class="co">#  Example 1: Fully EFA                             #</span></span>
<span class="r-in"><span class="co">#####################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18cfa0</span><span class="op">$</span><span class="va">dat</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu">pefa</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, K<span class="op">=</span><span class="fl">5</span>, burn <span class="op">=</span> <span class="fl">2000</span>, iter <span class="op">=</span> <span class="fl">2000</span>,verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]    [,3]    [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen  3.0751 0.0000000  2.9399  3.1796 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 9.0000 0.0000000 12.0000 10.0000 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink 0.2006 0.0003665  0.2937  0.3649 2.847e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  195    0    0  240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0  432    0    0  502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1  544    3    8  498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]  [,3]    [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen  2.8513 0.0000000 2.853  3.0671 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 9.0000 0.0000000 9.000 10.0000 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink 0.2843 0.0005151 1.029  0.3692 1.657e-20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  366    0    0  502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0  921    0    0  975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1 1055    3    8 1025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]   [,2]   [,3]   [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen   3.3503 0.0000 2.6914 3.1388 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 11.0000 0.0000 9.0000 9.0000 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink  0.3073 0.0459 0.4774 0.2367 7.354e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tru Fac 1 0 1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EPSR &amp; NCONV 1.01 1.022 1.012 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  519    0    0  764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0 1505    0    0 1488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1 1471    3    8 1512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]    [,2]   [,3]  [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen   3.2592 0.00000 3.1686 3.221 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 11.0000 0.00000 8.0000 8.000 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink  0.8602 0.04228 0.3323 1.006 7.724e-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tru Fac 1 0 1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EPSR &amp; NCONV 1.011 1.005 1.006 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  519    0    0 1009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0 2501    0    0 2022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1 1475    3    8 1978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14.52    0.02   14.57 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># summarize basic information</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $NJK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000   18    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Miss%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`LD Allowed`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Burn in`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Iteration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`No. of sig lambda`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Selected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE FALSE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Auto, NCONV, MCONV`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0  2 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $EPSR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Point est. Upper C.I.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1.0111     1.0306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     1.0046     1.0065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1.0061     1.0313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`DIC, BIC, AIC`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4911.460 2892.593 2313.478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14.52    0.02   14.57 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> <span class="co">#summarize significant loadings in pattern/Q-matrix format</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1      3      4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I1  0.0000 0.0000 0.6798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I2  0.0000 0.0000 0.6883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I3  0.0000 0.0000 0.7043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I4  0.0000 0.0000 0.7103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I5  0.3235 0.0000 0.6952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I6  0.3406 0.0000 0.6749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I7  0.7229 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I8  0.7178 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I9  0.7231 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I10 0.6968 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I11 0.6961 0.2924 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I12 0.6972 0.2853 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I13 0.0000 0.6785 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I14 0.0000 0.6744 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I15 0.0000 0.7082 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I16 0.0000 0.6772 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I17 0.0000 0.6895 0.3005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I18 0.0000 0.6853 0.2872</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'phi'</span><span class="op">)</span> <span class="co">#summarize factorial correlations</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      row col    est     sd  lower  upper sig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   3   1 0.2881 0.0358 0.2196 0.3587   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   4   1 0.2688 0.0361 0.2025 0.3421   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   4   3 0.3154 0.0358 0.2523 0.3897   1</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'eigen'</span><span class="op">)</span> <span class="co">#summarize factorial eigenvalue</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       est     sd  lower  upper sig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 3.2443 0.1612 2.9169 3.5517   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F3 2.9944 0.1521 2.7198 3.3141   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F4 3.0561 0.1577 2.7607 3.3788   1</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##########################################################</span></span>
<span class="r-in"><span class="co">#  Example 2: PEFA with two factors partially specified  #</span></span>
<span class="r-in"><span class="co">##########################################################</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span class="r-in"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;</span>
<span class="r-in"><span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span class="r-in"><span class="va">Q</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]   -1    1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]   -1    1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]   -1   -1   -1   -1   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]   -1   -1   -1   -1   -1</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">pefa</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,burn <span class="op">=</span> <span class="fl">2000</span>, iter <span class="op">=</span> <span class="fl">2000</span>,verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]   [,2]    [,3]     [,4]     [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen  3.0879 3.3755  3.1763 0.000000 0.00e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 9.0000 8.0000 10.0000 0.000000 0.00e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink 0.8762 0.7396  0.5269 0.005856 3.38e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0  160  219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0  485  490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    1  515  510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]  [,2]   [,3]     [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen  3.139 3.046  2.818 0.000000 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 8.000 8.000 10.000 0.000000 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink 1.218 0.937  1.071 0.002086 4.385e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0  348  469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0  972  964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    1 1028 1036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]   [,2]   [,3]      [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen  3.1556 3.5876 2.8366 0.000e+00 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 9.0000 9.0000 8.0000 0.000e+00 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink 0.4709 0.8438 0.7828 4.889e-09 1.519e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tru Fac 1 1 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EPSR &amp; NCONV 1.044 1.001 1.092 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0  587  740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0 1468 1463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    1 1532 1537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tot. Iter = 4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]  [,2]   [,3]      [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Feigen  2.9765 2.998  3.223 0.000e+00 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLA_lg0 9.0000 8.000 11.000 0.000e+00 0.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iShrink 0.5865 1.365  1.191 8.653e-15 1.355e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tru Fac 1 1 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EPSR &amp; NCONV 1.004 1.008 1.013 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ROW: LA overflow, sign switch, bk=0, &lt;eig_eps"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0  856 1009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0 1944 1942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    1 2056 2058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15.13    0.00   15.14 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $NJK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000   18    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Miss%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`LD Allowed`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Burn in`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Iteration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`No. of sig lambda`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Selected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE  TRUE  TRUE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Auto, NCONV, MCONV`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0  2 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $EPSR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Point est. Upper C.I.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     1.0041     1.0220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     1.0078     1.0302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     1.0125     1.0507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`DIC, BIC, AIC`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4906.446 2886.731 2307.616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   15.13    0.00   15.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1      2      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I1  0.6834 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I2  0.6924 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I3  0.7067 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I4  0.7122 0.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I5  0.6984 0.3245 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I6  0.6767 0.3411 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I7  0.0000 0.7283 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I8  0.0000 0.7231 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I9  0.0000 0.7268 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I10 0.0000 0.7001 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I11 0.0000 0.7017 0.2905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I12 0.0000 0.6995 0.2850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I13 0.0000 0.0000 0.6784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I14 0.0000 0.0000 0.6741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I15 0.0000 0.0000 0.7090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I16 0.0000 0.0000 0.6776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I17 0.3029 0.0000 0.6876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I18 0.2867 0.0000 0.6870</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'phi'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      row col    est     sd  lower  upper sig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   2   1 0.2711 0.0371 0.1995 0.3424   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   3   1 0.3188 0.0363 0.2507 0.3863   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   3   2 0.2879 0.0352 0.2213 0.3620   1</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       est     sd  lower  upper sig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 3.0802 0.1591 2.8060 3.4049   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F2 3.2822 0.1694 2.9720 3.6228   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F3 2.9940 0.1530 2.7138 3.3128   1</span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jinsong Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LAWBL">
<title>pcfa-examples • LAWBL</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="pcfa-examples">
<meta property="og:description" content="LAWBL">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">LAWBL</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../articles/LAWBL.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/Examples/gpcfa-examples.html">gpcfa-examples</a>
    <a class="dropdown-item" href="../../articles/Examples/pcfa-examples.html">pcfa-examples</a>
    <a class="dropdown-item" href="../../articles/Examples/pcirm-examples.html">pcirm-examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Jinsong-Chen/LAWBL/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>pcfa-examples</h1>
                        <h4 data-toc-skip class="author">Jinsong Chen</h4>
            
            <h4 data-toc-skip class="date">2022-05-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jinsong-Chen/LAWBL/blob/HEAD/vignettes/Examples/pcfa-examples.Rmd" class="external-link"><code>vignettes/Examples/pcfa-examples.Rmd</code></a></small>
      <div class="d-none name"><code>pcfa-examples.Rmd</code></div>
    </div>

    
    
<p><strong>Note: the estimation process can be time consuming depending on the computing power. You can same some time by reducing the length of the chains.</strong></p>
<div class="section level2">
<h2 id="continuous-data-wo-local-dependence">Continuous Data w/o Local Dependence:<a class="anchor" aria-label="anchor" href="#continuous-data-wo-local-dependence"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Load the package, obtain the data, and check the true loading pattern (<em>qlam</em>) and local dependence.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Jinsong-Chen/LAWBL" class="external-link">LAWBL</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## LAWBL Package (version 1.5.0; 2022-05-13)</span>
<span class="co">## For tutorials, see https://jinsong-chen.github.io/LAWBL/</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18cfa0</span><span class="op">$</span><span class="va">dat</span>
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18cfa0</span><span class="op">$</span><span class="va">qlam</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]  0.7  0.0  0.0</span>
<span class="co">##  [2,]  0.7  0.0  0.0</span>
<span class="co">##  [3,]  0.7  0.0  0.0</span>
<span class="co">##  [4,]  0.7  0.0  0.0</span>
<span class="co">##  [5,]  0.7  0.3  0.0</span>
<span class="co">##  [6,]  0.7  0.3  0.0</span>
<span class="co">##  [7,]  0.0  0.7  0.0</span>
<span class="co">##  [8,]  0.0  0.7  0.0</span>
<span class="co">##  [9,]  0.0  0.7  0.0</span>
<span class="co">## [10,]  0.0  0.7  0.0</span>
<span class="co">## [11,]  0.0  0.7  0.3</span>
<span class="co">## [12,]  0.0  0.7  0.3</span>
<span class="co">## [13,]  0.0  0.0  0.7</span>
<span class="co">## [14,]  0.0  0.0  0.7</span>
<span class="co">## [15,]  0.0  0.0  0.7</span>
<span class="co">## [16,]  0.0  0.0  0.7</span>
<span class="co">## [17,]  0.3  0.0  0.7</span>
<span class="co">## [18,]  0.3  0.0  0.7</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim18cfa0</span><span class="op">$</span><span class="va">LD</span></code></pre></div>
<pre><code><span class="co">##      row col</span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the PCFA-LI model (E-step) by setting <em>LD=F</em> and the design matrix Q. Only a few loadings need to be specified in Q (e.g., 2 per factor). Longer chain is suggested for stabler performance (<em>burn=iter=5,000</em> by default).</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]   -1   -1   -1</span>
<span class="co">##  [4,]   -1   -1   -1</span>
<span class="co">##  [5,]   -1   -1   -1</span>
<span class="co">##  [6,]   -1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1   -1   -1</span>
<span class="co">## [10,]   -1   -1   -1</span>
<span class="co">## [11,]   -1   -1   -1</span>
<span class="co">## [12,]   -1   -1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1   -1</span>
<span class="co">## [16,]   -1   -1   -1</span>
<span class="co">## [17,]   -1   -1   -1</span>
<span class="co">## [18,]   -1   -1   -1</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># summarize basic information</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0624     1.0667</span>
<span class="co">## [2,]     1.0780     1.0824</span>
<span class="co">## [3,]     1.0324     1.1183</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 4855.375 2701.101 2333.019</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##   47.59    3.60   51.25</span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#summarize significant loadings in pattern/Q-matrix format</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.7134 0.0000 0.0000</span>
<span class="co">## I2  0.7274 0.0000 0.0000</span>
<span class="co">## I3  0.7343 0.0000 0.0000</span>
<span class="co">## I4  0.7523 0.0000 0.0000</span>
<span class="co">## I5  0.7324 0.2731 0.0000</span>
<span class="co">## I6  0.7060 0.2893 0.0000</span>
<span class="co">## I7  0.0000 0.7340 0.0000</span>
<span class="co">## I8  0.0000 0.7310 0.0000</span>
<span class="co">## I9  0.0000 0.7421 0.0000</span>
<span class="co">## I10 0.0000 0.7262 0.0000</span>
<span class="co">## I11 0.0000 0.7115 0.2661</span>
<span class="co">## I12 0.0000 0.7021 0.2487</span>
<span class="co">## I13 0.0000 0.0000 0.7028</span>
<span class="co">## I14 0.0000 0.0000 0.6825</span>
<span class="co">## I15 0.0000 0.0000 0.7151</span>
<span class="co">## I16 0.0000 0.0000 0.7147</span>
<span class="co">## I17 0.2909 0.0000 0.6870</span>
<span class="co">## I18 0.2787 0.0000 0.6920</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#factorial eigenvalue</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.4409 0.5717 2.5379 4.7755   1</span>
<span class="co">## F2 3.4564 0.4431 2.7413 4.4195   1</span>
<span class="co">## F3 3.1777 0.4515 2.3685 4.0800   1</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plotting factorial eigenvalue</span>
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="co">#density</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the PCFA model by setting <em>LD=TRUE</em> (by default). Longer chain is suggested for stabler performance. Results are very close to the E-step, since there’s no LD in the data.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="co">#alternatively</span>
<span class="co">#Q[1:6,1]&lt;-Q[7:12,2]&lt;-Q[13:18,3]&lt;-1 # 1 for specified items</span>

<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0180     1.0589</span>
<span class="co">## [2,]     1.0253     1.0897</span>
<span class="co">## [3,]     1.0008     1.0009</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 5323.362 4298.661 3179.693</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  123.67    8.46  132.22</span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6787 0.0000 0.0000</span>
<span class="co">## I2  0.7055 0.0000 0.0000</span>
<span class="co">## I3  0.7096 0.0000 0.0000</span>
<span class="co">## I4  0.7309 0.0000 0.0000</span>
<span class="co">## I5  0.7080 0.2743 0.0000</span>
<span class="co">## I6  0.6785 0.2920 0.0000</span>
<span class="co">## I7  0.0000 0.7332 0.0000</span>
<span class="co">## I8  0.0000 0.7218 0.0000</span>
<span class="co">## I9  0.0000 0.7379 0.0000</span>
<span class="co">## I10 0.0000 0.7240 0.0000</span>
<span class="co">## I11 0.0000 0.7099 0.2376</span>
<span class="co">## I12 0.0000 0.7052 0.2253</span>
<span class="co">## I13 0.0000 0.0000 0.6985</span>
<span class="co">## I14 0.0000 0.0000 0.6740</span>
<span class="co">## I15 0.0000 0.0000 0.7154</span>
<span class="co">## I16 0.0000 0.0000 0.7082</span>
<span class="co">## I17 0.2479 0.0000 0.6910</span>
<span class="co">## I18 0.2345 0.0000 0.6977</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span> <span class="co">#summarize significant LD terms</span></code></pre></div>
<pre><code><span class="co">##      row col est sd lower upper sig</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.1446 0.2822 2.6145 3.7453   1</span>
<span class="co">## F2 3.3541 0.2975 2.8197 3.9469   1</span>
<span class="co">## F3 3.1052 0.2789 2.6008 3.6856   1</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plotting factorial eigenvalue</span>
<span class="co"># par(mar = rep(2, 4))</span>
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="co">#density</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> One can also configure the Q matrix for a CFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step. Results are also very close.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##     1 2 3</span>
<span class="co">## I1  1 0 0</span>
<span class="co">## I2  1 0 0</span>
<span class="co">## I3  1 0 0</span>
<span class="co">## I4  1 0 0</span>
<span class="co">## I5  1 1 0</span>
<span class="co">## I6  1 1 0</span>
<span class="co">## I7  0 1 0</span>
<span class="co">## I8  0 1 0</span>
<span class="co">## I9  0 1 0</span>
<span class="co">## I10 0 1 0</span>
<span class="co">## I11 0 1 1</span>
<span class="co">## I12 0 1 1</span>
<span class="co">## I13 0 0 1</span>
<span class="co">## I14 0 0 1</span>
<span class="co">## I15 0 0 1</span>
<span class="co">## I16 0 0 1</span>
<span class="co">## I17 1 0 1</span>
<span class="co">## I18 1 0 1</span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0081     1.0153</span>
<span class="co">## [2,]     1.0122     1.0583</span>
<span class="co">## [3,]     1.0057     1.0203</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 5122.965 3670.614 2698.878</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##   93.88    7.67  101.93</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6829 0.0000 0.0000</span>
<span class="co">## I2  0.6974 0.0000 0.0000</span>
<span class="co">## I3  0.7117 0.0000 0.0000</span>
<span class="co">## I4  0.7103 0.0000 0.0000</span>
<span class="co">## I5  0.6830 0.3292 0.0000</span>
<span class="co">## I6  0.6707 0.3427 0.0000</span>
<span class="co">## I7  0.0000 0.7294 0.0000</span>
<span class="co">## I8  0.0000 0.7251 0.0000</span>
<span class="co">## I9  0.0000 0.7245 0.0000</span>
<span class="co">## I10 0.0000 0.6925 0.0000</span>
<span class="co">## I11 0.0000 0.6935 0.2903</span>
<span class="co">## I12 0.0000 0.6907 0.2914</span>
<span class="co">## I13 0.0000 0.0000 0.6747</span>
<span class="co">## I14 0.0000 0.0000 0.6791</span>
<span class="co">## I15 0.0000 0.0000 0.7174</span>
<span class="co">## I16 0.0000 0.0000 0.6660</span>
<span class="co">## I17 0.3112 0.0000 0.6787</span>
<span class="co">## I18 0.2866 0.0000 0.6812</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col est sd lower upper sig</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.0682 0.1615 2.7644 3.3982   1</span>
<span class="co">## F2 3.2549 0.1830 2.9039 3.6055   1</span>
<span class="co">## F3 2.9784 0.1751 2.6335 3.3177   1</span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="co"># Eigens' traces are excellent without regularization of the loadings</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="continuous-data-with-local-dependence">Continuous Data with Local Dependence:<a class="anchor" aria-label="anchor" href="#continuous-data-with-local-dependence"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Obtain the data and check the true loading pattern (<em>qlam</em>) and local dependence.</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18cfa1</span><span class="op">$</span><span class="va">dat</span>
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18cfa1</span><span class="op">$</span><span class="va">qlam</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]  0.7  0.0  0.0</span>
<span class="co">##  [2,]  0.7  0.0  0.0</span>
<span class="co">##  [3,]  0.7  0.0  0.0</span>
<span class="co">##  [4,]  0.7  0.0  0.0</span>
<span class="co">##  [5,]  0.7  0.3  0.0</span>
<span class="co">##  [6,]  0.7  0.3  0.0</span>
<span class="co">##  [7,]  0.0  0.7  0.0</span>
<span class="co">##  [8,]  0.0  0.7  0.0</span>
<span class="co">##  [9,]  0.0  0.7  0.0</span>
<span class="co">## [10,]  0.0  0.7  0.0</span>
<span class="co">## [11,]  0.0  0.7  0.3</span>
<span class="co">## [12,]  0.0  0.7  0.3</span>
<span class="co">## [13,]  0.0  0.0  0.7</span>
<span class="co">## [14,]  0.0  0.0  0.7</span>
<span class="co">## [15,]  0.0  0.0  0.7</span>
<span class="co">## [16,]  0.0  0.0  0.7</span>
<span class="co">## [17,]  0.3  0.0  0.7</span>
<span class="co">## [18,]  0.3  0.0  0.7</span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim18cfa1</span><span class="op">$</span><span class="va">LD</span> <span class="co"># effect size = .3</span></code></pre></div>
<pre><code><span class="co">##      row col</span>
<span class="co">## [1,]  14   1</span>
<span class="co">## [2,]   7   2</span>
<span class="co">## [3,]   4   3</span>
<span class="co">## [4,]  13   8</span>
<span class="co">## [5,]  10   9</span>
<span class="co">## [6,]  16  15</span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the PCFA-LI model (E-step) by setting <em>LD=FALSE</em> and the design matrix Q. Only a few loadings need to be specified in Q (e.g., 2 per factor). Some loading estimates are biased due to ignoring the LD. So do the eigenvalues.</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]   -1   -1   -1</span>
<span class="co">##  [4,]   -1   -1   -1</span>
<span class="co">##  [5,]   -1   -1   -1</span>
<span class="co">##  [6,]   -1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1   -1   -1</span>
<span class="co">## [10,]   -1   -1   -1</span>
<span class="co">## [11,]   -1   -1   -1</span>
<span class="co">## [12,]   -1   -1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1   -1</span>
<span class="co">## [16,]   -1   -1   -1</span>
<span class="co">## [17,]   -1   -1   -1</span>
<span class="co">## [18,]   -1   -1   -1</span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 22</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0268     1.1202</span>
<span class="co">## [2,]     1.3077     2.1823</span>
<span class="co">## [3,]     1.0682     1.2584</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3729.068 2180.126 1812.044</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##   48.62    4.45   53.22</span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6508 0.0000 0.0000</span>
<span class="co">## I2  0.6538 0.0000 0.0000</span>
<span class="co">## I3  0.8787 0.0000 0.0000</span>
<span class="co">## I4  0.8822 0.0000 0.0000</span>
<span class="co">## I5  0.6997 0.2283 0.0000</span>
<span class="co">## I6  0.6745 0.2398 0.0000</span>
<span class="co">## I7  0.0000 0.7103 0.0000</span>
<span class="co">## I8  0.0000 0.6613 0.0000</span>
<span class="co">## I9  0.0000 0.9186 0.0000</span>
<span class="co">## I10 0.0000 0.9091 0.0000</span>
<span class="co">## I11 0.0000 0.6889 0.0000</span>
<span class="co">## I12 0.0000 0.7078 0.0000</span>
<span class="co">## I13 0.0000 0.0000 0.6723</span>
<span class="co">## I14 0.0000 0.0000 0.6606</span>
<span class="co">## I15 0.0000 0.0000 0.7828</span>
<span class="co">## I16 0.0000 0.0000 0.7876</span>
<span class="co">## I17 0.3045 0.0000 0.6567</span>
<span class="co">## I18 0.2978 0.0000 0.6622</span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.6387 0.4013 2.8974 4.4469   1</span>
<span class="co">## F2 3.7860 0.4673 2.9911 4.6466   1</span>
<span class="co">## F3 3.3188 0.4206 2.5796 4.2597   1</span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="pcfa-examples_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the PCFA model by setting <em>LD=TRUE</em> (by default). The estimates are more accurate, and the LD terms can be largely recovered.</li>
</ol>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]    1   -1   -1</span>
<span class="co">##  [4,]    1   -1   -1</span>
<span class="co">##  [5,]    1   -1   -1</span>
<span class="co">##  [6,]    1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1    1   -1</span>
<span class="co">## [10,]   -1    1   -1</span>
<span class="co">## [11,]   -1    1   -1</span>
<span class="co">## [12,]   -1    1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1    1</span>
<span class="co">## [16,]   -1   -1    1</span>
<span class="co">## [17,]   -1   -1    1</span>
<span class="co">## [18,]   -1   -1    1</span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 22</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0230     1.0636</span>
<span class="co">## [2,]     1.0309     1.1124</span>
<span class="co">## [3,]     1.2228     1.7416</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 6</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3670.479 2706.037 1587.069</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  120.57   11.51  132.48</span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6915 0.0000 0.0000</span>
<span class="co">## I2  0.6730 0.0000 0.0000</span>
<span class="co">## I3  0.7588 0.0000 0.0000</span>
<span class="co">## I4  0.7633 0.0000 0.0000</span>
<span class="co">## I5  0.7623 0.0000 0.0000</span>
<span class="co">## I6  0.7309 0.0000 0.0000</span>
<span class="co">## I7  0.0000 0.7467 0.0000</span>
<span class="co">## I8  0.0000 0.6745 0.0000</span>
<span class="co">## I9  0.0000 0.7462 0.0000</span>
<span class="co">## I10 0.0000 0.7270 0.0000</span>
<span class="co">## I11 0.0000 0.7184 0.2125</span>
<span class="co">## I12 0.0000 0.7324 0.2005</span>
<span class="co">## I13 0.0000 0.0000 0.7128</span>
<span class="co">## I14 0.0000 0.0000 0.6762</span>
<span class="co">## I15 0.0000 0.0000 0.7225</span>
<span class="co">## I16 0.0000 0.0000 0.7213</span>
<span class="co">## I17 0.2542 0.0000 0.7095</span>
<span class="co">## I18 0.2385 0.0000 0.7155</span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.4266 0.3704 2.7396 4.2256   1</span>
<span class="co">## F2 3.3057 0.3302 2.6959 3.9784   1</span>
<span class="co">## F3 3.2109 0.3410 2.6139 3.9488   1</span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col    est     sd  lower  upper sig</span>
<span class="co">## [1,]  14   1 0.2918 0.0479 0.1996 0.3825   1</span>
<span class="co">## [2,]   7   2 0.2569 0.0480 0.1648 0.3496   1</span>
<span class="co">## [3,]   4   3 0.2661 0.0683 0.1246 0.3898   1</span>
<span class="co">## [4,]  13   8 0.2799 0.0451 0.1976 0.3783   1</span>
<span class="co">## [5,]  10   9 0.2971 0.0665 0.1525 0.4270   1</span>
<span class="co">## [6,]  16  15 0.2688 0.0704 0.1258 0.3978   1</span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> Configure the Q matrix for a CFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step. Results are better than, but similar to the C-step.</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##     1 2 3</span>
<span class="co">## I1  1 0 0</span>
<span class="co">## I2  1 0 0</span>
<span class="co">## I3  1 0 0</span>
<span class="co">## I4  1 0 0</span>
<span class="co">## I5  1 0 0</span>
<span class="co">## I6  1 0 0</span>
<span class="co">## I7  0 1 0</span>
<span class="co">## I8  0 1 0</span>
<span class="co">## I9  0 1 0</span>
<span class="co">## I10 0 1 0</span>
<span class="co">## I11 0 1 1</span>
<span class="co">## I12 0 1 1</span>
<span class="co">## I13 0 0 1</span>
<span class="co">## I14 0 0 1</span>
<span class="co">## I15 0 0 1</span>
<span class="co">## I16 0 0 1</span>
<span class="co">## I17 1 0 1</span>
<span class="co">## I18 1 0 1</span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 22</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0222     1.1003</span>
<span class="co">## [2,]     1.2677     1.9349</span>
<span class="co">## [3,]     1.0009     1.0028</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 26</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 4851.891 3231.894 2269.974</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##   94.25    8.77  103.23</span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6514 0.0000 0.0000</span>
<span class="co">## I2  0.6837 0.0000 0.0000</span>
<span class="co">## I3  0.7026 0.0000 0.0000</span>
<span class="co">## I4  0.6882 0.0000 0.0000</span>
<span class="co">## I5  0.8461 0.0000 0.0000</span>
<span class="co">## I6  0.8415 0.0000 0.0000</span>
<span class="co">## I7  0.0000 0.6948 0.0000</span>
<span class="co">## I8  0.0000 0.6235 0.0000</span>
<span class="co">## I9  0.0000 0.6198 0.0000</span>
<span class="co">## I10 0.0000 0.5916 0.0000</span>
<span class="co">## I11 0.0000 0.6317 0.2934</span>
<span class="co">## I12 0.0000 0.6082 0.2875</span>
<span class="co">## I13 0.0000 0.0000 0.6595</span>
<span class="co">## I14 0.0000 0.0000 0.6769</span>
<span class="co">## I15 0.0000 0.0000 0.7223</span>
<span class="co">## I16 0.0000 0.0000 0.7395</span>
<span class="co">## I17 0.3054 0.0000 0.6916</span>
<span class="co">## I18 0.2926 0.0000 0.6915</span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.4757 0.2171 3.0650 3.9089   1</span>
<span class="co">## F2 2.3975 0.3131 1.7467 2.9940   1</span>
<span class="co">## F3 3.1007 0.1769 2.7689 3.4376   1</span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       row col     est     sd   lower   upper sig</span>
<span class="co">##  [1,]   7   1 -0.0726 0.0331 -0.1347 -0.0077   1</span>
<span class="co">##  [2,]   8   1 -0.0683 0.0333 -0.1305 -0.0017   1</span>
<span class="co">##  [3,]   9   1 -0.0845 0.0359 -0.1489 -0.0094   1</span>
<span class="co">##  [4,]  10   1 -0.0976 0.0357 -0.1624 -0.0233   1</span>
<span class="co">##  [5,]  11   1 -0.0753 0.0329 -0.1383 -0.0134   1</span>
<span class="co">##  [6,]  12   1 -0.0725 0.0333 -0.1328 -0.0027   1</span>
<span class="co">##  [7,]  14   1  0.2992 0.0305  0.2432  0.3603   1</span>
<span class="co">##  [8,]   7   2  0.2045 0.0408  0.1245  0.2854   1</span>
<span class="co">##  [9,]  11   2 -0.0881 0.0359 -0.1559 -0.0191   1</span>
<span class="co">## [10,]  12   2 -0.0766 0.0375 -0.1481 -0.0010   1</span>
<span class="co">## [11,]   4   3  0.3159 0.0581  0.1976  0.4252   1</span>
<span class="co">## [12,]   7   3 -0.0869 0.0326 -0.1504 -0.0197   1</span>
<span class="co">## [13,]  12   3 -0.0887 0.0327 -0.1529 -0.0245   1</span>
<span class="co">## [14,]   7   4 -0.0791 0.0331 -0.1415 -0.0098   1</span>
<span class="co">## [15,]  11   4 -0.0670 0.0322 -0.1345 -0.0072   1</span>
<span class="co">## [16,]  12   4 -0.0810 0.0326 -0.1447 -0.0153   1</span>
<span class="co">## [17,]  11   8  0.1067 0.0540  0.0110  0.2166   1</span>
<span class="co">## [18,]  12   8  0.1216 0.0590  0.0158  0.2426   1</span>
<span class="co">## [19,]  13   8  0.3333 0.0351  0.2669  0.4051   1</span>
<span class="co">## [20,]  10   9  0.4249 0.0822  0.2734  0.6082   1</span>
<span class="co">## [21,]  11   9  0.1080 0.0607  0.0114  0.2481   1</span>
<span class="co">## [22,]  12   9  0.1357 0.0676  0.0128  0.2824   1</span>
<span class="co">## [23,]  11  10  0.1071 0.0616  0.0057  0.2418   1</span>
<span class="co">## [24,]  12  10  0.1239 0.0670  0.0055  0.2700   1</span>
<span class="co">## [25,]  12  11  0.1200 0.0579  0.0206  0.2423   1</span>
<span class="co">## [26,]  16  15  0.2403 0.0620  0.1137  0.3750   1</span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jinsong Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

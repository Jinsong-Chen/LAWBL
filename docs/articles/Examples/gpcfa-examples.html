<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gpcfa-examples • LAWBL</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="gpcfa-examples">
<meta property="og:description" content="LAWBL">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">LAWBL</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/LAWBL.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Examples/pcfa-examples.html">pcfa-examples</a>
    </li>
    <li>
      <a href="../../articles/Examples/pcirm-examples.html">pcirm-examples</a>
    </li>
    <li>
      <a href="../../articles/Examples/gpcfa-examples.html">gpcfa-examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Jinsong-Chen/LAWBL/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gpcfa-examples_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="gpcfa-examples_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="gpcfa-examples_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>gpcfa-examples</h1>
                        <h4 class="author">Jinsong Chen</h4>
            
            <h4 class="date">2021-03-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jinsong-Chen/LAWBL/blob/master/vignettes/Examples/gpcfa-examples.Rmd"><code>vignettes/Examples/gpcfa-examples.Rmd</code></a></small>
      <div class="hidden name"><code>gpcfa-examples.Rmd</code></div>

    </div>

    
    
<p><strong>Note: the estimation process can be time consuming depending on the computing power. You can same some time by reducing the length of the chains.</strong></p>
<div id="categorical-data-with-missingness-but-no-local-dependence" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical-data-with-missingness-but-no-local-dependence" class="anchor"></a>Categorical Data with Missingness but no Local Dependence:</h2>
<ol style="list-style-type: decimal">
<li>Load the package, obtain the data, loading pattern (<em>qlam</em>), and setup the design matrix Q.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Jinsong-Chen/LAWBL">LAWBL</a></span><span class="op">)</span></pre></div>
<pre><code>## LAWBL Package (version 1.4.0; 2021-03-21)
## For tutorials, see  https://jinsong-chen.github.io/LAWBL/</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18ccfa40</span><span class="op">$</span><span class="va">dat</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></pre></div>
<pre><code>## [1] 1000   18</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#10% missingness at random</span></pre></div>
<pre><code>##        V1             V2              V3             V4             V5       
##  Min.   :1.00   Min.   :1.000   Min.   :1.00   Min.   :1.00   Min.   :1.000  
##  1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.00   1st Qu.:2.000  
##  Median :3.00   Median :3.000   Median :3.00   Median :3.00   Median :3.000  
##  Mean   :2.51   Mean   :2.502   Mean   :2.54   Mean   :2.53   Mean   :2.542  
##  3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.00   3rd Qu.:3.000  
##  Max.   :4.00   Max.   :4.000   Max.   :4.00   Max.   :4.00   Max.   :4.000  
##  NA's   :88     NA's   :99      NA's   :81     NA's   :102    NA's   :101    
##        V6              V7              V8              V9       
##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :3.000   Median :2.000   Median :2.000   Median :2.000  
##  Mean   :2.508   Mean   :2.445   Mean   :2.503   Mean   :2.476  
##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  
##  NA's   :95      NA's   :103     NA's   :113     NA's   :87     
##       V10             V11             V12             V13       
##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :3.000   Median :2.000   Median :2.000   Median :2.000  
##  Mean   :2.498   Mean   :2.507   Mean   :2.502   Mean   :2.447  
##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  
##  NA's   :97      NA's   :117     NA's   :106     NA's   :85     
##       V14             V15             V16             V17       
##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :2.000   Median :2.000   Median :2.000   Median :3.000  
##  Mean   :2.461   Mean   :2.481   Mean   :2.473   Mean   :2.512  
##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  
##  NA's   :111     NA's   :111     NA's   :110     NA's   :78     
##       V18       
##  Min.   :1.000  
##  1st Qu.:2.000  
##  Median :3.000  
##  Mean   :2.523  
##  3rd Qu.:3.000  
##  Max.   :4.000  
##  NA's   :95</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">qlam</span> <span class="op">&lt;-</span> <span class="va">sim18ccfa40</span><span class="op">$</span><span class="va">qlam</span>
<span class="va">qlam</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]  0.7  0.0  0.0
##  [2,]  0.7  0.0  0.0
##  [3,]  0.7  0.0  0.0
##  [4,]  0.7  0.0  0.0
##  [5,]  0.7  0.4  0.0
##  [6,]  0.7  0.4  0.0
##  [7,]  0.0  0.7  0.0
##  [8,]  0.0  0.7  0.0
##  [9,]  0.0  0.7  0.0
## [10,]  0.0  0.7  0.0
## [11,]  0.0  0.7  0.4
## [12,]  0.0  0.7  0.4
## [13,]  0.0  0.0  0.7
## [14,]  0.0  0.0  0.7
## [15,]  0.0  0.0  0.7
## [16,]  0.0  0.0  0.7
## [17,]  0.4  0.0  0.7
## [18,]  0.4  0.0  0.7</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]    1   -1   -1
##  [2,]    1   -1   -1
##  [3,]    1   -1   -1
##  [4,]   -1   -1   -1
##  [5,]   -1   -1   -1
##  [6,]   -1   -1   -1
##  [7,]   -1    1   -1
##  [8,]   -1    1   -1
##  [9,]   -1    1   -1
## [10,]   -1   -1   -1
## [11,]   -1   -1   -1
## [12,]   -1   -1   -1
## [13,]   -1   -1    1
## [14,]   -1   -1    1
## [15,]   -1   -1    1
## [16,]   -1   -1   -1
## [17,]   -1   -1   -1
## [18,]   -1   -1   -1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the GPCFA-LI model (E-step) by setting <em>LD=F</em>. Only a few loadings need to be specified in Q (e.g., 3 per factor). Longer chain is suggested for more accurate and stable estimation.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>

<span class="co"># summarize basic information</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 9.883333
## 
## $`LD enabled`
## [1] FALSE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.107622   1.234978
## F2   1.208851   1.700794
## F3   1.293353   1.996376
## 
## $`Cat Items`
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">#summarize significant loadings in pattern/Q-matrix format</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7692609 0.0000000 0.0000000
## I2  0.7753720 0.0000000 0.0000000
## I3  0.7301689 0.0000000 0.0000000
## I4  0.6803175 0.0000000 0.0000000
## I5  0.7091764 0.3888040 0.0000000
## I6  0.6936929 0.3610245 0.0000000
## I7  0.0000000 0.7379586 0.0000000
## I8  0.0000000 0.6768006 0.0000000
## I9  0.0000000 0.6856018 0.0000000
## I10 0.0000000 0.7391442 0.0000000
## I11 0.0000000 0.6929699 0.3819046
## I12 0.0000000 0.6781798 0.4320924
## I13 0.0000000 0.0000000 0.7226262
## I14 0.0000000 0.0000000 0.7109504
## I15 0.0000000 0.0000000 0.7208442
## I16 0.0000000 0.0000000 0.7013467
## I17 0.3410309 0.0000000 0.7582465
## I18 0.3352637 0.0000000 0.7578797</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="co">#factorial eigenvalue</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span> </pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.545531 0.5150427 2.679476 4.592518   1
## F2 3.387946 0.3193160 2.801852 4.045384   1
## F3 3.627917 0.5231366 2.787350 4.616714   1</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="co">#thresholds for categorical items</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]         [,2]     [,3]
## I1  -1.500250 -0.032577846 1.501701
## I2  -1.552104 -0.015537648 1.643518
## I3  -1.589216 -0.064889898 1.477343
## I4  -1.463730 -0.080423103 1.473639
## I5  -1.637244 -0.051446901 1.486746
## I6  -1.555726 -0.012471331 1.526593
## I7  -1.477894  0.061788472 1.677251
## I8  -1.498442  0.025243257 1.396894
## I9  -1.491386  0.026719886 1.535729
## I10 -1.451278 -0.008329922 1.506094
## I11 -1.638535 -0.005952637 1.558021
## I12 -1.583759  0.021700911 1.541355
## I13 -1.386274  0.054296428 1.563823
## I14 -1.443080  0.060442875 1.605402
## I15 -1.388337  0.041749049 1.436064
## I16 -1.482090  0.046235758 1.560795
## I17 -1.486319 -0.054369931 1.572594
## I18 -1.526053 -0.047537946 1.500790</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="co">#plotting factorial eigenvalue</span>
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="co">#density</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'APSR'</span><span class="op">)</span> <span class="co">#adj, PSRF</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the GPCFA model by setting <em>LD=TRUE</em> (by default). Longer chain is suggested for more accurate and stable estimation.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="co">#alternatively</span>
<span class="co">#Q[1:6,1]&lt;-Q[7:12,2]&lt;-Q[13:18,3]&lt;-1 # 1 for specified items</span>

<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 9.883333
## 
## $`LD enabled`
## [1] TRUE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.114854   1.424169
## F2   1.082312   1.318962
## F3   1.066446   1.266210
## 
## $`No. of sig LD terms`
## [1] 0
## 
## $`Cat Items`
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7402390 0.0000000 0.0000000
## I2  0.7495559 0.0000000 0.0000000
## I3  0.7216111 0.0000000 0.0000000
## I4  0.6758195 0.0000000 0.0000000
## I5  0.6873215 0.4173230 0.0000000
## I6  0.6785348 0.3955194 0.0000000
## I7  0.0000000 0.7413706 0.0000000
## I8  0.0000000 0.6889617 0.0000000
## I9  0.0000000 0.7058014 0.0000000
## I10 0.0000000 0.7509057 0.0000000
## I11 0.0000000 0.7209768 0.3277530
## I12 0.0000000 0.7052570 0.3749610
## I13 0.0000000 0.0000000 0.6969163
## I14 0.0000000 0.0000000 0.6933761
## I15 0.0000000 0.0000000 0.6997007
## I16 0.0000000 0.0000000 0.6992478
## I17 0.3263654 0.0000000 0.7455682
## I18 0.3234536 0.0000000 0.7406517</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span> <span class="co">#summarize significant LD terms</span></pre></div>
<pre><code>##      row col est sd lower upper sig</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.306955 0.3072961 2.762889 3.933735   1
## F2 3.512837 0.3368155 2.920131 4.259705   1
## F3 3.402285 0.2938010 2.846449 3.969383   1</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]         [,2]     [,3]
## I1  -1.501782 -0.033301297 1.503910
## I2  -1.544243 -0.014362722 1.636054
## I3  -1.579636 -0.065364166 1.468551
## I4  -1.460606 -0.081420366 1.467636
## I5  -1.629848 -0.049348630 1.481103
## I6  -1.555141 -0.013814287 1.516476
## I7  -1.480269  0.065861983 1.677955
## I8  -1.503559  0.024020376 1.410862
## I9  -1.475153  0.030111408 1.532205
## I10 -1.449427 -0.009294021 1.502760
## I11 -1.637843 -0.009113965 1.549908
## I12 -1.576547  0.019716831 1.533277
## I13 -1.396363  0.053356413 1.551786
## I14 -1.436597  0.054726153 1.587487
## I15 -1.401050  0.034367229 1.441720
## I16 -1.478610  0.037121420 1.558465
## I17 -1.492731 -0.059796770 1.568919
## I18 -1.535788 -0.053685546 1.489608</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="co">#plotting factorial eigenvalue</span>
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># trace</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="co">#density</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">'APSR'</span><span class="op">)</span> <span class="co">#adj, PSRF</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> One can also configure the Q matrix for a CCFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step.</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></pre></div>
<pre><code>##     [,1] [,2] [,3]
## I1     1    0    0
## I2     1    0    0
## I3     1    0    0
## I4     1    0    0
## I5     1    1    0
## I6     1    1    0
## I7     0    1    0
## I8     0    1    0
## I9     0    1    0
## I10    0    1    0
## I11    0    1    1
## I12    0    1    1
## I13    0    0    1
## I14    0    0    1
## I15    0    0    1
## I16    0    0    1
## I17    1    0    1
## I18    1    0    1</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 9.883333
## 
## $`LD enabled`
## [1] TRUE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.002699   1.013682
## F2   1.048247   1.202447
## F3   1.007528   1.019137
## 
## $`No. of sig LD terms`
## [1] 0
## 
## $`Cat Items`
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7161186 0.0000000 0.0000000
## I2  0.7193741 0.0000000 0.0000000
## I3  0.7225507 0.0000000 0.0000000
## I4  0.7160241 0.0000000 0.0000000
## I5  0.6569206 0.4501071 0.0000000
## I6  0.6796744 0.4390882 0.0000000
## I7  0.0000000 0.7361391 0.0000000
## I8  0.0000000 0.6794098 0.0000000
## I9  0.0000000 0.7081985 0.0000000
## I10 0.0000000 0.6900820 0.0000000
## I11 0.0000000 0.7024399 0.3960868
## I12 0.0000000 0.6778220 0.4389052
## I13 0.0000000 0.0000000 0.6819623
## I14 0.0000000 0.0000000 0.6789682
## I15 0.0000000 0.0000000 0.6858838
## I16 0.0000000 0.0000000 0.6778775
## I17 0.3634176 0.0000000 0.7204486
## I18 0.3769893 0.0000000 0.7352626</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></pre></div>
<pre><code>##      row col est sd lower upper sig</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.245933 0.1969988 2.873229 3.651090   1
## F2 3.342188 0.1937694 2.984454 3.739098   1
## F3 3.278255 0.1926074 2.909062 3.654712   1</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]         [,2]     [,3]
## I1  -1.506358 -0.029643198 1.503104
## I2  -1.542543 -0.011251005 1.648233
## I3  -1.575589 -0.062805179 1.471292
## I4  -1.457536 -0.079381531 1.462880
## I5  -1.636069 -0.046502597 1.484705
## I6  -1.548523 -0.011249405 1.510501
## I7  -1.481792  0.063630950 1.675747
## I8  -1.497668  0.023903021 1.401434
## I9  -1.487690  0.029099464 1.533380
## I10 -1.443945 -0.006586674 1.503226
## I11 -1.630884 -0.008417232 1.553603
## I12 -1.575149  0.020716603 1.536251
## I13 -1.384899  0.052288647 1.548053
## I14 -1.438538  0.056757671 1.591668
## I15 -1.392975  0.039100038 1.438922
## I16 -1.470072  0.037418372 1.548457
## I17 -1.484106 -0.059043126 1.572195
## I18 -1.522839 -0.047031597 1.495969</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="co"># Eigens' traces are excellent without regularization of the loadings</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="categorical-data-with-missingness-and-local-dependence" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical-data-with-missingness-and-local-dependence" class="anchor"></a>Categorical Data with Missingness and Local Dependence:</h2>
<ol style="list-style-type: decimal">
<li>Load the the data, loading pattern (<em>qlam</em>), and LD terms, and setup the design matrix Q.</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="downlit">
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18ccfa41</span><span class="op">$</span><span class="va">dat</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#10% missingness at random</span></pre></div>
<pre><code>##        V1              V2              V3              V4       
##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :3.000   Median :2.000   Median :3.000   Median :2.000  
##  Mean   :2.523   Mean   :2.471   Mean   :2.499   Mean   :2.497  
##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  
##        V5              V6              V7              V8       
##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :2.000   Median :2.000   Median :2.000   Median :2.000  
##  Mean   :2.475   Mean   :2.462   Mean   :2.468   Mean   :2.475  
##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  
##        V9             V10            V11            V12             V13       
##  Min.   :1.000   Min.   :1.00   Min.   :1.00   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.000  
##  Median :2.000   Median :2.00   Median :2.00   Median :2.000   Median :2.000  
##  Mean   :2.496   Mean   :2.49   Mean   :2.47   Mean   :2.449   Mean   :2.477  
##  3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.000   Max.   :4.00   Max.   :4.00   Max.   :4.000   Max.   :4.000  
##       V14             V15             V16            V17             V18      
##  Min.   :1.000   Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.00  
##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.00  
##  Median :3.000   Median :2.000   Median :2.00   Median :2.000   Median :2.00  
##  Mean   :2.496   Mean   :2.481   Mean   :2.49   Mean   :2.465   Mean   :2.48  
##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.00  
##  Max.   :4.000   Max.   :4.000   Max.   :4.00   Max.   :4.000   Max.   :4.00</code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit">
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18ccfa41</span><span class="op">$</span><span class="va">qlam</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]  0.7  0.0  0.0
##  [2,]  0.7  0.0  0.0
##  [3,]  0.7  0.0  0.0
##  [4,]  0.7  0.0  0.0
##  [5,]  0.7  0.4  0.0
##  [6,]  0.7  0.4  0.0
##  [7,]  0.0  0.7  0.0
##  [8,]  0.0  0.7  0.0
##  [9,]  0.0  0.7  0.0
## [10,]  0.0  0.7  0.0
## [11,]  0.0  0.7  0.4
## [12,]  0.0  0.7  0.4
## [13,]  0.0  0.0  0.7
## [14,]  0.0  0.0  0.7
## [15,]  0.0  0.0  0.7
## [16,]  0.0  0.0  0.7
## [17,]  0.4  0.0  0.7
## [18,]  0.4  0.0  0.7</code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit">
<span class="va">sim18ccfa41</span><span class="op">$</span><span class="va">LD</span> <span class="co"># effect size = .3</span></pre></div>
<pre><code>##      row col
## [1,]  14   1
## [2,]   7   2
## [3,]   4   3
## [4,]  13   8
## [5,]  10   9
## [6,]  16  15</code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]    1   -1   -1
##  [2,]    1   -1   -1
##  [3,]    1   -1   -1
##  [4,]   -1   -1   -1
##  [5,]   -1   -1   -1
##  [6,]   -1   -1   -1
##  [7,]   -1    1   -1
##  [8,]   -1    1   -1
##  [9,]   -1    1   -1
## [10,]   -1   -1   -1
## [11,]   -1   -1   -1
## [12,]   -1   -1   -1
## [13,]   -1   -1    1
## [14,]   -1   -1    1
## [15,]   -1   -1    1
## [16,]   -1   -1   -1
## [17,]   -1   -1   -1
## [18,]   -1   -1   -1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the GPCFA-LI model (E-step) by setting <em>LD=FALSE</em>. Only a few loadings need to be specified in Q (e.g., 3 per factor). Some loading estimates are biased due to ignoring the LD. So do the eigenvalues.</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="downlit">
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 0
## 
## $`LD enabled`
## [1] FALSE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.062607   1.246232
## F2   1.099613   1.133232
## F3   1.453155   2.616693
## 
## $`Cat Items`
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7220054 0.0000000 0.0000000
## I2  0.7578314 0.0000000 0.0000000
## I3  0.8302307 0.0000000 0.0000000
## I4  0.8474667 0.0000000 0.0000000
## I5  0.7482094 0.3391859 0.0000000
## I6  0.7512840 0.3318368 0.0000000
## I7  0.0000000 0.6023529 0.0000000
## I8  0.0000000 0.6803998 0.0000000
## I9  0.0000000 0.8490253 0.0000000
## I10 0.0000000 0.8359097 0.0000000
## I11 0.0000000 0.6621123 0.4343348
## I12 0.0000000 0.6203983 0.4960346
## I13 0.0000000 0.0000000 0.7013259
## I14 0.0000000 0.0000000 0.7041230
## I15 0.0000000 0.0000000 0.8328650
## I16 0.0000000 0.0000000 0.8600934
## I17 0.3555898 0.0000000 0.6884373
## I18 0.3817822 0.0000000 0.6828377</code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 4.110216 0.6237391 3.154565 5.436945   1
## F2 3.514941 0.5318190 2.584479 4.647850   1
## F3 4.021360 0.7924340 2.715074 5.636274   1</code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]         [,2]     [,3]
## I1  -1.509852 -0.030863927 1.449083
## I2  -1.439761  0.053637153 1.516857
## I3  -1.471154 -0.008531999 1.533473
## I4  -1.478812  0.002263152 1.519927
## I5  -1.412314  0.053322532 1.467887
## I6  -1.454905  0.099784375 1.492414
## I7  -1.468775  0.031221593 1.653617
## I8  -1.541025  0.066973862 1.560229
## I9  -1.551411  0.053035973 1.463737
## I10 -1.568130  0.055176311 1.499528
## I11 -1.462202  0.058066557 1.548029
## I12 -1.405850  0.065415793 1.628259
## I13 -1.473589  0.022011424 1.604010
## I14 -1.512719 -0.010776386 1.611509
## I15 -1.472642  0.029399850 1.544534
## I16 -1.540373  0.027487660 1.541047
## I17 -1.419224  0.045788779 1.569551
## I18 -1.466332  0.042999390 1.513835</code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb65"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'APSR'</span><span class="op">)</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the GPCFA model by setting <em>LD=TRUE</em> (by default). The estimates are more accurate, and the LD terms can be largely recovered.</li>
</ol>
<div class="sourceCode" id="cb66"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]    1   -1   -1
##  [2,]    1   -1   -1
##  [3,]    1   -1   -1
##  [4,]    1   -1   -1
##  [5,]    1   -1   -1
##  [6,]    1   -1   -1
##  [7,]   -1    1   -1
##  [8,]   -1    1   -1
##  [9,]   -1    1   -1
## [10,]   -1    1   -1
## [11,]   -1    1   -1
## [12,]   -1    1   -1
## [13,]   -1   -1    1
## [14,]   -1   -1    1
## [15,]   -1   -1    1
## [16,]   -1   -1    1
## [17,]   -1   -1    1
## [18,]   -1   -1    1</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit">
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 0
## 
## $`LD enabled`
## [1] TRUE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.148985   1.519930
## F2   1.006991   1.010272
## F3   1.061941   1.227715
## 
## $`No. of sig LD terms`
## [1] 6
## 
## $`Cat Items`
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.6947356 0.0000000 0.0000000
## I2  0.7469809 0.0000000 0.0000000
## I3  0.7075269 0.0000000 0.0000000
## I4  0.7267423 0.0000000 0.0000000
## I5  0.6991658 0.3873701 0.0000000
## I6  0.7060150 0.3736497 0.0000000
## I7  0.0000000 0.6804666 0.0000000
## I8  0.0000000 0.7042922 0.0000000
## I9  0.0000000 0.7615140 0.0000000
## I10 0.0000000 0.7489847 0.0000000
## I11 0.0000000 0.7258586 0.3637712
## I12 0.0000000 0.6876764 0.4188351
## I13 0.0000000 0.0000000 0.7253386
## I14 0.0000000 0.0000000 0.7195429
## I15 0.0000000 0.0000000 0.6864824
## I16 0.0000000 0.0000000 0.7277159
## I17 0.3148921 0.0000000 0.7252312
## I18 0.3296082 0.0000000 0.7099247</code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.431590 0.4055397 2.635891 4.132687   1
## F2 3.500584 0.4432121 2.631146 4.387685   1
## F3 3.522603 0.4422174 2.756390 4.507274   1</code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></pre></div>
<pre><code>##        row col       est         sd      lower     upper sig
## var14   14   1 0.2363034 0.04850890 0.13646368 0.3318834   1
## var24    7   2 0.2059439 0.04144952 0.12328314 0.2829947   1
## var37    4   3 0.2675083 0.05749483 0.15892870 0.3802749   1
## var111  13   8 0.2218377 0.04397580 0.13838859 0.3099203   1
## var118  10   9 0.2247866 0.06459134 0.08767764 0.3458805   1
## var163  16  15 0.2897083 0.05495764 0.18402223 0.4011384   1</code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]         [,2]     [,3]
## I1  -1.516249 -0.030331275 1.477447
## I2  -1.450483  0.060526437 1.527532
## I3  -1.496974 -0.008457412 1.562618
## I4  -1.494609  0.004460696 1.550939
## I5  -1.414945  0.059103039 1.473377
## I6  -1.450156  0.101224228 1.495334
## I7  -1.477504  0.028377234 1.686296
## I8  -1.566453  0.064483640 1.572740
## I9  -1.572605  0.046817371 1.476436
## I10 -1.593706  0.055670900 1.508089
## I11 -1.459199  0.052846431 1.542029
## I12 -1.401036  0.058646484 1.637577
## I13 -1.482173  0.023750576 1.582588
## I14 -1.513185 -0.020061857 1.622579
## I15 -1.495443  0.028429302 1.551197
## I16 -1.559033  0.027007340 1.556314
## I17 -1.419262  0.043448456 1.567150
## I18 -1.476041  0.043831366 1.525413</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> Configure the Q matrix for a CCFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step. Results are better than, but similar to the C-step.</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></pre></div>
<pre><code>##     [,1] [,2] [,3]
## I1     1    0    0
## I2     1    0    0
## I3     1    0    0
## I4     1    0    0
## I5     1    1    0
## I6     1    1    0
## I7     0    1    0
## I8     0    1    0
## I9     0    1    0
## I10    0    1    0
## I11    0    1    1
## I12    0    1    1
## I13    0    0    1
## I14    0    0    1
## I15    0    0    1
## I16    0    0    1
## I17    1    0    1
## I18    1    0    1</code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit">
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 0
## 
## $`LD enabled`
## [1] TRUE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.018136   1.074757
## F2   1.001009   1.005539
## F3   1.001142   1.004861
## 
## $`No. of sig LD terms`
## [1] 7
## 
## $`Cat Items`
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7033699 0.0000000 0.0000000
## I2  0.7246922 0.0000000 0.0000000
## I3  0.7278842 0.0000000 0.0000000
## I4  0.7154132 0.0000000 0.0000000
## I5  0.7062961 0.4161100 0.0000000
## I6  0.7140585 0.4036879 0.0000000
## I7  0.0000000 0.7162757 0.0000000
## I8  0.0000000 0.6878586 0.0000000
## I9  0.0000000 0.7576501 0.0000000
## I10 0.0000000 0.7501641 0.0000000
## I11 0.0000000 0.6848584 0.4169362
## I12 0.0000000 0.6413998 0.4750125
## I13 0.0000000 0.0000000 0.6964463
## I14 0.0000000 0.0000000 0.6652202
## I15 0.0000000 0.0000000 0.7126715
## I16 0.0000000 0.0000000 0.7481818
## I17 0.4192972 0.0000000 0.6828915
## I18 0.4397645 0.0000000 0.6685481</code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.451891 0.2038485 3.073827 3.878183   1
## F2 3.351710 0.1955881 2.996229 3.743055   1
## F3 3.322157 0.1955269 2.942498 3.705189   1</code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></pre></div>
<pre><code>##        row col        est         sd      lower        upper sig
## var14   14   1  0.2837306 0.03758614  0.2128667  0.356791929   1
## var24    7   2  0.2227613 0.03343877  0.1582046  0.290172000   1
## var37    4   3  0.2568980 0.04799174  0.1636617  0.351759692   1
## var111  13   8  0.2122590 0.03231273  0.1525654  0.277354919   1
## var112  14   8 -0.0567317 0.03052552 -0.1226302 -0.001515734   1
## var118  10   9  0.2018431 0.04414903  0.1140127  0.287938616   1
## var163  16  15  0.2394704 0.05198108  0.1366992  0.345133381   1</code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]         [,2]     [,3]
## I1  -1.518280 -0.030049068 1.479949
## I2  -1.447943  0.059774871 1.523262
## I3  -1.500915 -0.009382675 1.569127
## I4  -1.493783  0.004027240 1.549100
## I5  -1.405213  0.058666817 1.466204
## I6  -1.451189  0.103108417 1.493024
## I7  -1.469607  0.027552209 1.679559
## I8  -1.560694  0.063042540 1.574797
## I9  -1.564541  0.049950358 1.473947
## I10 -1.583708  0.055291881 1.509504
## I11 -1.449524  0.057888822 1.548453
## I12 -1.396243  0.062527112 1.636905
## I13 -1.483996  0.032001966 1.608497
## I14 -1.519788 -0.012263949 1.645043
## I15 -1.481703  0.032985892 1.549516
## I16 -1.552919  0.035735761 1.560498
## I17 -1.411127  0.053453479 1.575380
## I18 -1.450825  0.050488431 1.519108</code></pre>
</div>
<div id="mixed-type-data-with-missingness-and-local-dependence" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-type-data-with-missingness-and-local-dependence" class="anchor"></a>Mixed-type Data with Missingness and Local Dependence:</h2>
<ol style="list-style-type: decimal">
<li>Load the the data, loading pattern (<em>qlam</em>), and LD terms, and setup the design matrix Q.</li>
</ol>
<div class="sourceCode" id="cb90"><pre class="downlit">
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18mcfa41</span><span class="op">$</span><span class="va">dat</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#10% missingness at random</span></pre></div>
<pre><code>##        V1             V2              V3              V4              V5       
##  Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  
##  Median :2.00   Median :2.000   Median :2.000   Median :2.000   Median :3.000  
##  Mean   :2.48   Mean   :2.462   Mean   :2.493   Mean   :2.479   Mean   :2.504  
##  3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  
##  Max.   :4.00   Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  
##  NA's   :89     NA's   :93      NA's   :120     NA's   :102     NA's   :90     
##        V6              V7                 V8                 V9          
##  Min.   :1.000   Min.   :-3.21001   Min.   :-3.54361   Min.   :-3.32012  
##  1st Qu.:2.000   1st Qu.:-0.68898   1st Qu.:-0.65256   1st Qu.:-0.64327  
##  Median :3.000   Median :-0.03487   Median : 0.06813   Median : 0.03350  
##  Mean   :2.518   Mean   :-0.01623   Mean   : 0.01463   Mean   : 0.03128  
##  3rd Qu.:3.000   3rd Qu.: 0.67435   3rd Qu.: 0.66845   3rd Qu.: 0.70643  
##  Max.   :4.000   Max.   : 4.01783   Max.   : 3.27478   Max.   : 2.97721  
##  NA's   :104     NA's   :94         NA's   :86         NA's   :106       
##       V10                V11                V12                V13          
##  Min.   :-3.21330   Min.   :-4.12769   Min.   :-2.91567   Min.   :-3.22662  
##  1st Qu.:-0.63965   1st Qu.:-0.65700   1st Qu.:-0.66640   1st Qu.:-0.70765  
##  Median : 0.00747   Median : 0.02474   Median :-0.01155   Median :-0.01079  
##  Mean   :-0.00987   Mean   : 0.00479   Mean   :-0.00040   Mean   :-0.02734  
##  3rd Qu.: 0.67062   3rd Qu.: 0.67224   3rd Qu.: 0.64559   3rd Qu.: 0.67594  
##  Max.   : 3.25571   Max.   : 3.62259   Max.   : 2.80134   Max.   : 2.79965  
##  NA's   :92         NA's   :102        NA's   :90         NA's   :105       
##       V14                V15                V16                V17          
##  Min.   :-2.98985   Min.   :-3.35992   Min.   :-3.50378   Min.   :-3.40113  
##  1st Qu.:-0.69722   1st Qu.:-0.74388   1st Qu.:-0.64658   1st Qu.:-0.69758  
##  Median :-0.03728   Median :-0.06034   Median :-0.05346   Median : 0.02840  
##  Mean   :-0.02156   Mean   :-0.02898   Mean   :-0.02239   Mean   :-0.01743  
##  3rd Qu.: 0.68074   3rd Qu.: 0.65601   3rd Qu.: 0.63254   3rd Qu.: 0.67004  
##  Max.   : 3.63462   Max.   : 3.64237   Max.   : 3.61134   Max.   : 2.80767  
##  NA's   :106        NA's   :82         NA's   :90         NA's   :100       
##       V18          
##  Min.   :-2.58909  
##  1st Qu.:-0.70663  
##  Median :-0.01164  
##  Mean   :-0.00992  
##  3rd Qu.: 0.68655  
##  Max.   : 2.54931  
##  NA's   :94</code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit">
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18mcfa41</span><span class="op">$</span><span class="va">qlam</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]  0.7  0.0  0.0
##  [2,]  0.7  0.0  0.0
##  [3,]  0.7  0.0  0.0
##  [4,]  0.7  0.0  0.0
##  [5,]  0.7  0.4  0.0
##  [6,]  0.7  0.4  0.0
##  [7,]  0.0  0.7  0.0
##  [8,]  0.0  0.7  0.0
##  [9,]  0.0  0.7  0.0
## [10,]  0.0  0.7  0.0
## [11,]  0.0  0.7  0.4
## [12,]  0.0  0.7  0.4
## [13,]  0.0  0.0  0.7
## [14,]  0.0  0.0  0.7
## [15,]  0.0  0.0  0.7
## [16,]  0.0  0.0  0.7
## [17,]  0.4  0.0  0.7
## [18,]  0.4  0.0  0.7</code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit">
<span class="va">sim18mcfa41</span><span class="op">$</span><span class="va">LD</span> <span class="co"># effect size = .3</span></pre></div>
<pre><code>##      row col
## [1,]  14   1
## [2,]   7   2
## [3,]   4   3
## [4,]  13   8
## [5,]  10   9
## [6,]  16  15</code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]    1   -1   -1
##  [2,]    1   -1   -1
##  [3,]    1   -1   -1
##  [4,]   -1   -1   -1
##  [5,]   -1   -1   -1
##  [6,]   -1   -1   -1
##  [7,]   -1    1   -1
##  [8,]   -1    1   -1
##  [9,]   -1    1   -1
## [10,]   -1   -1   -1
## [11,]   -1   -1   -1
## [12,]   -1   -1   -1
## [13,]   -1   -1    1
## [14,]   -1   -1    1
## [15,]   -1   -1    1
## [16,]   -1   -1   -1
## [17,]   -1   -1   -1
## [18,]   -1   -1   -1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the GPCFA-LI model (E-step) by setting <em>LD=FALSE</em>. Only a few loadings need to be specified in Q (e.g., 3 per factor). The first 6 items are categorical and need to be specified with <em>cati</em>.</li>
</ol>
<div class="sourceCode" id="cb98"><pre class="downlit">
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span>, cati <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 9.694444
## 
## $`LD enabled`
## [1] FALSE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.014791   1.060706
## F2   1.183764   1.626287
## F3   1.079231   1.232434
## 
## $`Cat Items`
## [1] 1 2 3 4 5 6
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.6953239 0.0000000 0.0000000
## I2  0.7009699 0.0000000 0.0000000
## I3  0.8231428 0.0000000 0.0000000
## I4  0.8054884 0.0000000 0.0000000
## I5  0.6936996 0.3656018 0.0000000
## I6  0.6685262 0.3791111 0.0000000
## I7  0.0000000 0.6391412 0.0000000
## I8  0.0000000 0.6751441 0.0000000
## I9  0.0000000 0.8439126 0.0000000
## I10 0.0000000 0.8451749 0.0000000
## I11 0.0000000 0.6521254 0.4077305
## I12 0.0000000 0.6571528 0.4300227
## I13 0.0000000 0.0000000 0.6734987
## I14 0.0000000 0.0000000 0.6535546
## I15 0.0000000 0.0000000 0.8080817
## I16 0.0000000 0.0000000 0.8171530
## I17 0.3550636 0.0000000 0.7176285
## I18 0.3761606 0.0000000 0.6881290</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.699585 0.5228951 2.822759 4.805683   1
## F2 3.599538 0.4202782 2.823238 4.421873   1
## F3 3.701155 0.5784221 2.785895 4.917882   1</code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span> <span class="co"># only for 12 items </span></pre></div>
<pre><code>##         [,1]        [,2]     [,3]
## I1 -1.453950  0.03719675 1.520939
## I2 -1.484599  0.09986522 1.505816
## I3 -1.495235  0.01062709 1.559552
## I4 -1.457733  0.03460834 1.562277
## I5 -1.480186 -0.01946891 1.509125
## I6 -1.522667 -0.01613079 1.474601</code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb107"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb108"><pre class="downlit">
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'APSR'</span><span class="op">)</span></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the GPCFA model by setting <em>LD=TRUE</em> (by default). The estimates are more accurate, and the LD terms can be largely recovered.</li>
</ol>
<div class="sourceCode" id="cb109"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></pre></div>
<pre><code>##       [,1] [,2] [,3]
##  [1,]    1   -1   -1
##  [2,]    1   -1   -1
##  [3,]    1   -1   -1
##  [4,]    1   -1   -1
##  [5,]    1   -1   -1
##  [6,]    1   -1   -1
##  [7,]   -1    1   -1
##  [8,]   -1    1   -1
##  [9,]   -1    1   -1
## [10,]   -1    1   -1
## [11,]   -1    1   -1
## [12,]   -1    1   -1
## [13,]   -1   -1    1
## [14,]   -1   -1    1
## [15,]   -1   -1    1
## [16,]   -1   -1    1
## [17,]   -1   -1    1
## [18,]   -1   -1    1</code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit">
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 9.694444
## 
## $`LD enabled`
## [1] TRUE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.040368   1.078891
## F2   1.008479   1.015100
## F3   1.034362   1.148520
## 
## $`No. of sig LD terms`
## [1] 6
## 
## $`Cat Items`
## [1] 1 2 3 4 5 6
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7349143 0.0000000 0.0000000
## I2  0.6968074 0.0000000 0.0000000
## I3  0.7519603 0.0000000 0.0000000
## I4  0.7344929 0.0000000 0.0000000
## I5  0.7074218 0.3591906 0.0000000
## I6  0.6979099 0.3591552 0.0000000
## I7  0.0000000 0.6931252 0.0000000
## I8  0.0000000 0.6664873 0.0000000
## I9  0.0000000 0.7439443 0.0000000
## I10 0.0000000 0.7405739 0.0000000
## I11 0.0000000 0.6900820 0.3990889
## I12 0.0000000 0.6951829 0.4095746
## I13 0.0000000 0.0000000 0.6956857
## I14 0.0000000 0.0000000 0.6549785
## I15 0.0000000 0.0000000 0.7013260
## I16 0.0000000 0.0000000 0.7035725
## I17 0.3752405 0.0000000 0.6960130
## I18 0.4011846 0.0000000 0.6656033</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.518429 0.3439559 2.880139 4.181871   1
## F2 3.333810 0.3140799 2.674389 3.892366   1
## F3 3.246867 0.3332286 2.658458 3.972341   1</code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></pre></div>
<pre><code>##        row col       est         sd     lower     upper sig
## var14   14   1 0.2338511 0.04422981 0.1404982 0.3159385   1
## var24    7   2 0.2769114 0.04367867 0.1934845 0.3623250   1
## var37    4   3 0.2512777 0.06346622 0.1342153 0.3776728   1
## var111  13   8 0.2838156 0.04260507 0.2011195 0.3691961   1
## var118  10   9 0.2545230 0.05710038 0.1498265 0.3867077   1
## var163  16  15 0.2969885 0.06265043 0.1670670 0.4173010   1</code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##         [,1]         [,2]     [,3]
## I1 -1.474743  0.048577695 1.540016
## I2 -1.484494  0.089633402 1.524881
## I3 -1.533766  0.008047375 1.592160
## I4 -1.491716  0.031464780 1.586383
## I5 -1.451012 -0.027712485 1.493459
## I6 -1.515820 -0.023821391 1.456559</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> Configure the Q matrix for a mix of CFA and CCFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step. Results are better than, but similar to the C-step.</li>
</ol>
<div class="sourceCode" id="cb121"><pre class="downlit">
<span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></pre></div>
<pre><code>##     [,1] [,2] [,3]
## I1     1    0    0
## I2     1    0    0
## I3     1    0    0
## I4     1    0    0
## I5     1    1    0
## I6     1    1    0
## I7     0    1    0
## I8     0    1    0
## I9     0    1    0
## I10    0    1    0
## I11    0    1    1
## I12    0    1    1
## I13    0    0    1
## I14    0    0    1
## I15    0    0    1
## I16    0    0    1
## I17    1    0    1
## I18    1    0    1</code></pre>
<div class="sourceCode" id="cb123"><pre class="downlit">
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></pre></div>
<pre><code>## $N
## [1] 1000
## 
## $J
## [1] 18
## 
## $K
## [1] 3
## 
## $`Miss%`
## [1] 9.694444
## 
## $`LD enabled`
## [1] TRUE
## 
## $`Burn in`
## [1] 5000
## 
## $Iteration
## [1] 5000
## 
## $`No. of sig lambda`
## [1] 24
## 
## $`True Factor`
## [1] TRUE TRUE TRUE
## 
## $`Adj. PSR`
##    Point est. Upper C.I.
## F1   1.012271   1.012881
## F2   1.035427   1.123449
## F3   1.004575   1.021251
## 
## $`No. of sig LD terms`
## [1] 7
## 
## $`Cat Items`
## [1] 1 2 3 4 5 6
## 
## $`max No. of categories`
## [1] 4</code></pre>
<div class="sourceCode" id="cb125"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </pre></div>
<pre><code>##          [,1]      [,2]      [,3]
## I1  0.7357838 0.0000000 0.0000000
## I2  0.6839071 0.0000000 0.0000000
## I3  0.7315478 0.0000000 0.0000000
## I4  0.6951870 0.0000000 0.0000000
## I5  0.6926652 0.4190639 0.0000000
## I6  0.6849229 0.4110672 0.0000000
## I7  0.0000000 0.7002734 0.0000000
## I8  0.0000000 0.6774278 0.0000000
## I9  0.0000000 0.7179157 0.0000000
## I10 0.0000000 0.7003725 0.0000000
## I11 0.0000000 0.6885715 0.4176884
## I12 0.0000000 0.6754793 0.4215704
## I13 0.0000000 0.0000000 0.6790131
## I14 0.0000000 0.0000000 0.6679788
## I15 0.0000000 0.0000000 0.6962645
## I16 0.0000000 0.0000000 0.7059601
## I17 0.3972944 0.0000000 0.6815546
## I18 0.4323345 0.0000000 0.6628938</code></pre>
<div class="sourceCode" id="cb127"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></pre></div>
<pre><code>##         est        sd    lower    upper sig
## F1 3.332960 0.1918488 2.979858 3.734363   1
## F2 3.240767 0.1898236 2.885587 3.632367   1
## F3 3.156146 0.1862495 2.787459 3.517102   1</code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></pre></div>
<pre><code>##        row col         est         sd      lower        upper sig
## var14   14   1  0.25688370 0.03192128  0.1966027  0.320226449   1
## var24    7   2  0.29051050 0.03184902  0.2257774  0.349614724   1
## var27   10   2 -0.05461109 0.02767465 -0.1111524 -0.001198204   1
## var37    4   3  0.25589614 0.04788696  0.1681942  0.356598703   1
## var111  13   8  0.32325873 0.02880097  0.2646587  0.377369527   1
## var118  10   9  0.27516912 0.04934442  0.1818429  0.377510656   1
## var163  16  15  0.28928539 0.04765757  0.1865460  0.373424165   1</code></pre>
<div class="sourceCode" id="cb131"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></pre></div>
<pre><code>##         [,1]         [,2]     [,3]
## I1 -1.468228  0.043265472 1.534492
## I2 -1.488795  0.084910229 1.524889
## I3 -1.537068  0.008126367 1.581772
## I4 -1.485321  0.029086391 1.568390
## I5 -1.452338 -0.033825540 1.490215
## I6 -1.514454 -0.029300401 1.453408</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jinsong Chen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LAWBL">
<title>gpcfa-examples • LAWBL</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="gpcfa-examples">
<meta property="og:description" content="LAWBL">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">LAWBL</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../articles/LAWBL.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/Examples/gpcfa-examples.html">gpcfa-examples</a>
    <a class="dropdown-item" href="../../articles/Examples/pcfa-examples.html">pcfa-examples</a>
    <a class="dropdown-item" href="../../articles/Examples/pcirm-examples.html">pcirm-examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Jinsong-Chen/LAWBL/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>gpcfa-examples</h1>
                        <h4 data-toc-skip class="author">Jinsong Chen</h4>
            
            <h4 data-toc-skip class="date">2022-05-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Jinsong-Chen/LAWBL/blob/HEAD/vignettes/Examples/gpcfa-examples.Rmd" class="external-link"><code>vignettes/Examples/gpcfa-examples.Rmd</code></a></small>
      <div class="d-none name"><code>gpcfa-examples.Rmd</code></div>
    </div>

    
    
<p><strong>Note: the estimation process can be time consuming depending on the computing power. You can same some time by reducing the length of the chains.</strong></p>
<div class="section level2">
<h2 id="categorical-data-with-missingness-but-no-local-dependence">Categorical Data with Missingness but no Local Dependence:<a class="anchor" aria-label="anchor" href="#categorical-data-with-missingness-but-no-local-dependence"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Load the package, obtain the data, and check the true loading pattern (<em>qlam</em>) and local dependence.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Jinsong-Chen/LAWBL" class="external-link">LAWBL</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## LAWBL Package (version 1.5.0; 2022-05-13)</span>
<span class="co">## For tutorials, see https://jinsong-chen.github.io/LAWBL/</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18ccfa40</span><span class="op">$</span><span class="va">dat</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1000   18</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#10% missingness at random</span></code></pre></div>
<pre><code><span class="co">##        V1              V2             V3              V4              V5       </span>
<span class="co">##  Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :2.000   Median :2.00   Median :2.000   Median :2.000   Median :2.000  </span>
<span class="co">##  Mean   :2.446   Mean   :2.47   Mean   :2.471   Mean   :2.454   Mean   :2.479  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.00   Max.   :4.000   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :86      NA's   :103    NA's   :98      NA's   :101     NA's   :102    </span>
<span class="co">##        V6              V7              V8              V9       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :2.000   Median :2.000   Median :3.000   Median :3.000  </span>
<span class="co">##  Mean   :2.459   Mean   :2.472   Mean   :2.538   Mean   :2.499  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :105     NA's   :99      NA's   :94      NA's   :99     </span>
<span class="co">##       V10             V11             V12             V13       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :2.000   Median :2.000   Median :2.000   Median :3.000  </span>
<span class="co">##  Mean   :2.486   Mean   :2.477   Mean   :2.481   Mean   :2.553  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :99      NA's   :100     NA's   :98      NA's   :90     </span>
<span class="co">##       V14             V15             V16             V17       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :2.000   Median :3.000   Median :2.500   Median :2.000  </span>
<span class="co">##  Mean   :2.478   Mean   :2.529   Mean   :2.511   Mean   :2.475  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :84      NA's   :107     NA's   :100     NA's   :107    </span>
<span class="co">##       V18       </span>
<span class="co">##  Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000  </span>
<span class="co">##  Median :2.000  </span>
<span class="co">##  Mean   :2.478  </span>
<span class="co">##  3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000  </span>
<span class="co">##  NA's   :108</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18ccfa40</span><span class="op">$</span><span class="va">qlam</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]  0.7  0.0  0.0</span>
<span class="co">##  [2,]  0.7  0.0  0.0</span>
<span class="co">##  [3,]  0.7  0.0  0.0</span>
<span class="co">##  [4,]  0.7  0.0  0.0</span>
<span class="co">##  [5,]  0.7  0.3  0.0</span>
<span class="co">##  [6,]  0.7  0.3  0.0</span>
<span class="co">##  [7,]  0.0  0.7  0.0</span>
<span class="co">##  [8,]  0.0  0.7  0.0</span>
<span class="co">##  [9,]  0.0  0.7  0.0</span>
<span class="co">## [10,]  0.0  0.7  0.0</span>
<span class="co">## [11,]  0.0  0.7  0.3</span>
<span class="co">## [12,]  0.0  0.7  0.3</span>
<span class="co">## [13,]  0.0  0.0  0.7</span>
<span class="co">## [14,]  0.0  0.0  0.7</span>
<span class="co">## [15,]  0.0  0.0  0.7</span>
<span class="co">## [16,]  0.0  0.0  0.7</span>
<span class="co">## [17,]  0.3  0.0  0.7</span>
<span class="co">## [18,]  0.3  0.0  0.7</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim18ccfa40</span><span class="op">$</span><span class="va">LD</span></code></pre></div>
<pre><code><span class="co">##      row col</span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the GPCFA-LI model (E-step) by setting <em>LD=F</em> and the design matrix Q. Only a few loadings need to be specified in Q (e.g., 2 per factor). Longer chain is suggested for more accurate and stable estimation.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]   -1   -1   -1</span>
<span class="co">##  [4,]   -1   -1   -1</span>
<span class="co">##  [5,]   -1   -1   -1</span>
<span class="co">##  [6,]   -1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1   -1   -1</span>
<span class="co">## [10,]   -1   -1   -1</span>
<span class="co">## [11,]   -1   -1   -1</span>
<span class="co">## [12,]   -1   -1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1   -1</span>
<span class="co">## [16,]   -1   -1   -1</span>
<span class="co">## [17,]   -1   -1   -1</span>
<span class="co">## [18,]   -1   -1   -1</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>

<span class="co"># summarize basic information</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 9.888889</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0542     1.2080</span>
<span class="co">## [2,]     1.3675     2.1326</span>
<span class="co">## [3,]     1.7886     3.4113</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 4092.631 3636.207 3268.126</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  206.41   36.11  243.20</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#summarize significant loadings in pattern/Q-matrix format</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.7494 0.0000 0.0000</span>
<span class="co">## I2  0.7502 0.0000 0.0000</span>
<span class="co">## I3  0.7564 0.0000 0.0000</span>
<span class="co">## I4  0.7714 0.0000 0.0000</span>
<span class="co">## I5  0.7668 0.2186 0.0000</span>
<span class="co">## I6  0.7243 0.2176 0.0000</span>
<span class="co">## I7  0.0000 0.7452 0.0000</span>
<span class="co">## I8  0.0000 0.7423 0.0000</span>
<span class="co">## I9  0.0000 0.7394 0.0000</span>
<span class="co">## I10 0.0000 0.7101 0.0000</span>
<span class="co">## I11 0.0000 0.7108 0.2506</span>
<span class="co">## I12 0.0000 0.7043 0.2496</span>
<span class="co">## I13 0.0000 0.0000 0.7405</span>
<span class="co">## I14 0.0000 0.0000 0.7169</span>
<span class="co">## I15 0.0000 0.0000 0.7262</span>
<span class="co">## I16 0.0000 0.0000 0.7056</span>
<span class="co">## I17 0.2992 0.0000 0.7270</span>
<span class="co">## I18 0.3182 0.0000 0.6622</span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#factorial eigenvalue</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.7133 0.5313 2.6856 4.7797   1</span>
<span class="co">## F2 3.4365 0.4868 2.5644 4.4104   1</span>
<span class="co">## F3 3.3232 0.4754 2.4596 4.2694   1</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#thresholds for categorical items</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          [,1]    [,2]   [,3]</span>
<span class="co">##  [1,] -1.3548  0.0686 1.6157</span>
<span class="co">##  [2,] -1.4361  0.0550 1.4945</span>
<span class="co">##  [3,] -1.4567  0.0561 1.5076</span>
<span class="co">##  [4,] -1.3796  0.0598 1.6020</span>
<span class="co">##  [5,] -1.4236  0.0158 1.4669</span>
<span class="co">##  [6,] -1.4962  0.0788 1.5805</span>
<span class="co">##  [7,] -1.4978  0.0360 1.6452</span>
<span class="co">##  [8,] -1.5220 -0.0578 1.4083</span>
<span class="co">##  [9,] -1.4744 -0.0130 1.5056</span>
<span class="co">## [10,] -1.4871  0.0100 1.6224</span>
<span class="co">## [11,] -1.4518  0.0191 1.5725</span>
<span class="co">## [12,] -1.5360  0.0168 1.6319</span>
<span class="co">## [13,] -1.5612 -0.0596 1.3936</span>
<span class="co">## [14,] -1.4252  0.0421 1.5051</span>
<span class="co">## [15,] -1.5544 -0.0322 1.4690</span>
<span class="co">## [16,] -1.4710 -0.0154 1.3745</span>
<span class="co">## [17,] -1.4405  0.0543 1.4854</span>
<span class="co">## [18,] -1.5317  0.0301 1.5441</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plotting factorial eigenvalue</span>
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="co">#density</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the GPCFA model by setting <em>LD=TRUE</em> (by default). Longer chain is suggested for more accurate and stable estimation.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="co">#alternatively</span>
<span class="co">#Q[1:6,1]&lt;-Q[7:12,2]&lt;-Q[13:18,3]&lt;-1 # 1 for specified items</span>

<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 9.888889</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0368     1.1365</span>
<span class="co">## [2,]     1.1515     1.5341</span>
<span class="co">## [3,]     1.0408     1.1749</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 4440.175 5223.739 4104.771</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  265.05   33.73  300.14</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.7267 0.0000 0.0000</span>
<span class="co">## I2  0.7174 0.0000 0.0000</span>
<span class="co">## I3  0.7347 0.0000 0.0000</span>
<span class="co">## I4  0.7412 0.0000 0.0000</span>
<span class="co">## I5  0.7332 0.2608 0.0000</span>
<span class="co">## I6  0.7001 0.2541 0.0000</span>
<span class="co">## I7  0.0000 0.7281 0.0000</span>
<span class="co">## I8  0.0000 0.7390 0.0000</span>
<span class="co">## I9  0.0000 0.7309 0.0000</span>
<span class="co">## I10 0.0000 0.7084 0.0000</span>
<span class="co">## I11 0.0000 0.7163 0.2296</span>
<span class="co">## I12 0.0000 0.7058 0.2424</span>
<span class="co">## I13 0.0000 0.0000 0.7384</span>
<span class="co">## I14 0.0000 0.0000 0.7249</span>
<span class="co">## I15 0.0000 0.0000 0.7290</span>
<span class="co">## I16 0.0000 0.0000 0.7118</span>
<span class="co">## I17 0.2468 0.0000 0.7328</span>
<span class="co">## I18 0.2735 0.0000 0.6678</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span> <span class="co">#summarize significant LD terms</span></code></pre></div>
<pre><code><span class="co">##      row col est sd lower upper sig</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.4084 0.4528 2.5969 4.3290   1</span>
<span class="co">## F2 3.3473 0.3250 2.7404 4.0345   1</span>
<span class="co">## F3 3.3178 0.4089 2.5469 4.1735   1</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          [,1]    [,2]   [,3]</span>
<span class="co">##  [1,] -1.3459  0.0683 1.6090</span>
<span class="co">##  [2,] -1.4491  0.0559 1.4960</span>
<span class="co">##  [3,] -1.4544  0.0525 1.4999</span>
<span class="co">##  [4,] -1.3818  0.0531 1.5951</span>
<span class="co">##  [5,] -1.4195  0.0143 1.4589</span>
<span class="co">##  [6,] -1.4877  0.0794 1.5676</span>
<span class="co">##  [7,] -1.4933  0.0406 1.6500</span>
<span class="co">##  [8,] -1.5286 -0.0571 1.4116</span>
<span class="co">##  [9,] -1.4567 -0.0098 1.4929</span>
<span class="co">## [10,] -1.4996  0.0126 1.6338</span>
<span class="co">## [11,] -1.4561  0.0223 1.5706</span>
<span class="co">## [12,] -1.5264  0.0201 1.6214</span>
<span class="co">## [13,] -1.5780 -0.0639 1.3885</span>
<span class="co">## [14,] -1.4250  0.0390 1.4975</span>
<span class="co">## [15,] -1.5565 -0.0362 1.4656</span>
<span class="co">## [16,] -1.4636 -0.0190 1.3684</span>
<span class="co">## [17,] -1.4411  0.0505 1.4726</span>
<span class="co">## [18,] -1.5269  0.0258 1.5274</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plotting factorial eigenvalue</span>
<span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span> <span class="co">#density</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> One can also configure the Q matrix for a CCFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step.</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##     1 2 3</span>
<span class="co">## I1  1 0 0</span>
<span class="co">## I2  1 0 0</span>
<span class="co">## I3  1 0 0</span>
<span class="co">## I4  1 0 0</span>
<span class="co">## I5  1 1 0</span>
<span class="co">## I6  1 1 0</span>
<span class="co">## I7  0 1 0</span>
<span class="co">## I8  0 1 0</span>
<span class="co">## I9  0 1 0</span>
<span class="co">## I10 0 1 0</span>
<span class="co">## I11 0 1 1</span>
<span class="co">## I12 0 1 1</span>
<span class="co">## I13 0 0 1</span>
<span class="co">## I14 0 0 1</span>
<span class="co">## I15 0 0 1</span>
<span class="co">## I16 0 0 1</span>
<span class="co">## I17 1 0 1</span>
<span class="co">## I18 1 0 1</span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 9.888889</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0076     1.0164</span>
<span class="co">## [2,]     1.0308     1.1020</span>
<span class="co">## [3,]     1.0186     1.0865</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 4247.119 4696.680 3724.944</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  247.27   16.60  264.81</span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.7056 0.0000 0.0000</span>
<span class="co">## I2  0.7227 0.0000 0.0000</span>
<span class="co">## I3  0.6963 0.0000 0.0000</span>
<span class="co">## I4  0.7289 0.0000 0.0000</span>
<span class="co">## I5  0.7036 0.3015 0.0000</span>
<span class="co">## I6  0.6923 0.3032 0.0000</span>
<span class="co">## I7  0.0000 0.6828 0.0000</span>
<span class="co">## I8  0.0000 0.7527 0.0000</span>
<span class="co">## I9  0.0000 0.6927 0.0000</span>
<span class="co">## I10 0.0000 0.6862 0.0000</span>
<span class="co">## I11 0.0000 0.6785 0.3011</span>
<span class="co">## I12 0.0000 0.6968 0.3375</span>
<span class="co">## I13 0.0000 0.0000 0.7063</span>
<span class="co">## I14 0.0000 0.0000 0.7253</span>
<span class="co">## I15 0.0000 0.0000 0.6930</span>
<span class="co">## I16 0.0000 0.0000 0.7205</span>
<span class="co">## I17 0.2925 0.0000 0.6826</span>
<span class="co">## I18 0.3184 0.0000 0.6644</span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col est sd lower upper sig</span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.2121 0.1904 2.8286 3.5794   1</span>
<span class="co">## F2 3.1286 0.1873 2.7798 3.5067   1</span>
<span class="co">## F3 3.1529 0.1942 2.7775 3.5456   1</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          [,1]    [,2]   [,3]</span>
<span class="co">##  [1,] -1.3475  0.0734 1.6202</span>
<span class="co">##  [2,] -1.4352  0.0640 1.5033</span>
<span class="co">##  [3,] -1.4400  0.0575 1.5008</span>
<span class="co">##  [4,] -1.3773  0.0622 1.6034</span>
<span class="co">##  [5,] -1.4175  0.0229 1.4704</span>
<span class="co">##  [6,] -1.4756  0.0891 1.5653</span>
<span class="co">##  [7,] -1.4872  0.0434 1.6372</span>
<span class="co">##  [8,] -1.5166 -0.0560 1.4114</span>
<span class="co">##  [9,] -1.4524 -0.0072 1.4929</span>
<span class="co">## [10,] -1.4758  0.0154 1.6270</span>
<span class="co">## [11,] -1.4475  0.0272 1.5720</span>
<span class="co">## [12,] -1.5205  0.0250 1.6386</span>
<span class="co">## [13,] -1.5645 -0.0583 1.3987</span>
<span class="co">## [14,] -1.4151  0.0478 1.5086</span>
<span class="co">## [15,] -1.5323 -0.0250 1.4645</span>
<span class="co">## [16,] -1.4516 -0.0098 1.3737</span>
<span class="co">## [17,] -1.4297  0.0592 1.4922</span>
<span class="co">## [18,] -1.5078  0.0364 1.5444</span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="co"># Eigens' traces are excellent without regularization of the loadings</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="categorical-data-with-missingness-and-local-dependence">Categorical Data with Missingness and Local Dependence:<a class="anchor" aria-label="anchor" href="#categorical-data-with-missingness-and-local-dependence"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Obtain the data and check the true loading pattern (<em>qlam</em>) and local dependence.</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18ccfa41</span><span class="op">$</span><span class="va">dat</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#10% missingness at random</span></code></pre></div>
<pre><code><span class="co">##        V1              V2              V3              V4       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :3.000   Median :3.000   Median :2.000   Median :2.000  </span>
<span class="co">##  Mean   :2.505   Mean   :2.497   Mean   :2.496   Mean   :2.506  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :84      NA's   :101     NA's   :104     NA's   :95     </span>
<span class="co">##        V5              V6              V7             V8              V9       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :3.000   Median :3.000   Median :2.00   Median :3.000   Median :2.000  </span>
<span class="co">##  Mean   :2.524   Mean   :2.515   Mean   :2.49   Mean   :2.532   Mean   :2.499  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.00   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :84      NA's   :104     NA's   :85     NA's   :94      NA's   :112    </span>
<span class="co">##       V10             V11             V12             V13           V14       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.0   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.0   1st Qu.:2.000  </span>
<span class="co">##  Median :3.000   Median :3.000   Median :3.000   Median :3.0   Median :3.000  </span>
<span class="co">##  Mean   :2.514   Mean   :2.503   Mean   :2.502   Mean   :2.5   Mean   :2.503  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.0   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.0   Max.   :4.000  </span>
<span class="co">##  NA's   :125     NA's   :105     NA's   :96      NA's   :118   NA's   :86     </span>
<span class="co">##       V15             V16             V17             V18      </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.00  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00  </span>
<span class="co">##  Median :3.000   Median :3.000   Median :3.000   Median :3.00  </span>
<span class="co">##  Mean   :2.528   Mean   :2.515   Mean   :2.503   Mean   :2.53  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.00  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.00  </span>
<span class="co">##  NA's   :116     NA's   :89      NA's   :120     NA's   :110</span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18ccfa41</span><span class="op">$</span><span class="va">qlam</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]  0.7  0.0  0.0</span>
<span class="co">##  [2,]  0.7  0.0  0.0</span>
<span class="co">##  [3,]  0.7  0.0  0.0</span>
<span class="co">##  [4,]  0.7  0.0  0.0</span>
<span class="co">##  [5,]  0.7  0.3  0.0</span>
<span class="co">##  [6,]  0.7  0.3  0.0</span>
<span class="co">##  [7,]  0.0  0.7  0.0</span>
<span class="co">##  [8,]  0.0  0.7  0.0</span>
<span class="co">##  [9,]  0.0  0.7  0.0</span>
<span class="co">## [10,]  0.0  0.7  0.0</span>
<span class="co">## [11,]  0.0  0.7  0.3</span>
<span class="co">## [12,]  0.0  0.7  0.3</span>
<span class="co">## [13,]  0.0  0.0  0.7</span>
<span class="co">## [14,]  0.0  0.0  0.7</span>
<span class="co">## [15,]  0.0  0.0  0.7</span>
<span class="co">## [16,]  0.0  0.0  0.7</span>
<span class="co">## [17,]  0.3  0.0  0.7</span>
<span class="co">## [18,]  0.3  0.0  0.7</span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim18ccfa41</span><span class="op">$</span><span class="va">LD</span> <span class="co"># effect size = .3</span></code></pre></div>
<pre><code><span class="co">##      row col</span>
<span class="co">## [1,]  14   1</span>
<span class="co">## [2,]   7   2</span>
<span class="co">## [3,]   4   3</span>
<span class="co">## [4,]  13   8</span>
<span class="co">## [5,]  10   9</span>
<span class="co">## [6,]  16  15</span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the GPCFA-LI model (E-step) by setting <em>LD=FALSE</em> and the design matrix Q. Only a few loadings need to be specified in Q (e.g., 2 per factor). Some loading estimates are biased due to ignoring the LD. So do the eigenvalues.</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]   -1   -1   -1</span>
<span class="co">##  [4,]   -1   -1   -1</span>
<span class="co">##  [5,]   -1   -1   -1</span>
<span class="co">##  [6,]   -1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1   -1   -1</span>
<span class="co">## [10,]   -1   -1   -1</span>
<span class="co">## [11,]   -1   -1   -1</span>
<span class="co">## [12,]   -1   -1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1   -1</span>
<span class="co">## [16,]   -1   -1   -1</span>
<span class="co">## [17,]   -1   -1   -1</span>
<span class="co">## [18,]   -1   -1   -1</span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 10.15556</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 23</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.4580     2.3875</span>
<span class="co">## [2,]     1.9994     4.0405</span>
<span class="co">## [3,]     1.1967     1.6815</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3738.775 3687.415 3319.333</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  269.29   63.81  336.04</span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6543 0.0000 0.0000</span>
<span class="co">## I2  0.7263 0.0000 0.0000</span>
<span class="co">## I3  0.8019 0.0000 0.0000</span>
<span class="co">## I4  0.7970 0.0000 0.0000</span>
<span class="co">## I5  0.6798 0.2779 0.0000</span>
<span class="co">## I6  0.6462 0.2727 0.0000</span>
<span class="co">## I7  0.0000 0.6286 0.0000</span>
<span class="co">## I8  0.0000 0.6336 0.0000</span>
<span class="co">## I9  0.0000 0.8457 0.0000</span>
<span class="co">## I10 0.0000 0.8292 0.0000</span>
<span class="co">## I11 0.0000 0.6029 0.4254</span>
<span class="co">## I12 0.0000 0.6159 0.3702</span>
<span class="co">## I13 0.0000 0.0000 0.7052</span>
<span class="co">## I14 0.0000 0.0000 0.7438</span>
<span class="co">## I15 0.0000 0.0000 0.8766</span>
<span class="co">## I16 0.0000 0.0000 0.8670</span>
<span class="co">## I17 0.2373 0.0000 0.6922</span>
<span class="co">## I18 0.0000 0.0000 0.7353</span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.3932 0.4361 2.5928 4.2149   1</span>
<span class="co">## F2 3.3538 0.5630 2.3584 4.4203   1</span>
<span class="co">## F3 4.0893 0.8231 2.8673 5.9234   1</span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          [,1]    [,2]   [,3]</span>
<span class="co">##  [1,] -1.5197 -0.0118 1.5217</span>
<span class="co">##  [2,] -1.4287 -0.0156 1.5713</span>
<span class="co">##  [3,] -1.5167  0.0334 1.5375</span>
<span class="co">##  [4,] -1.6291  0.0278 1.5202</span>
<span class="co">##  [5,] -1.5382 -0.0372 1.4742</span>
<span class="co">##  [6,] -1.5829 -0.0201 1.5531</span>
<span class="co">##  [7,] -1.4971 -0.0116 1.5614</span>
<span class="co">##  [8,] -1.5561 -0.0513 1.4267</span>
<span class="co">##  [9,] -1.5959 -0.0135 1.5820</span>
<span class="co">## [10,] -1.6099 -0.0289 1.5185</span>
<span class="co">## [11,] -1.4588 -0.0442 1.4681</span>
<span class="co">## [12,] -1.4584 -0.0653 1.5872</span>
<span class="co">## [13,] -1.4944 -0.0075 1.5651</span>
<span class="co">## [14,] -1.3893 -0.0212 1.4638</span>
<span class="co">## [15,] -1.4857 -0.0390 1.4791</span>
<span class="co">## [16,] -1.5244 -0.0167 1.4658</span>
<span class="co">## [17,] -1.5263 -0.0132 1.5450</span>
<span class="co">## [18,] -1.4941 -0.0327 1.4575</span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the GPCFA model by setting <em>LD=TRUE</em> (by default). The estimates are more accurate, and the LD terms can be largely recovered.</li>
</ol>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]    1   -1   -1</span>
<span class="co">##  [4,]    1   -1   -1</span>
<span class="co">##  [5,]    1   -1   -1</span>
<span class="co">##  [6,]    1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1    1   -1</span>
<span class="co">## [10,]   -1    1   -1</span>
<span class="co">## [11,]   -1    1   -1</span>
<span class="co">## [12,]   -1    1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1    1</span>
<span class="co">## [16,]   -1   -1    1</span>
<span class="co">## [17,]   -1   -1    1</span>
<span class="co">## [18,]   -1   -1    1</span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 10.15556</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0606     1.2375</span>
<span class="co">## [2,]     1.1442     1.5127</span>
<span class="co">## [3,]     1.0213     1.0360</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 6</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 4056.808 4814.414 3695.445</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  288.63   45.86  337.26</span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.7013 0.0000 0.0000</span>
<span class="co">## I2  0.7248 0.0000 0.0000</span>
<span class="co">## I3  0.7387 0.0000 0.0000</span>
<span class="co">## I4  0.7439 0.0000 0.0000</span>
<span class="co">## I5  0.7146 0.2324 0.0000</span>
<span class="co">## I6  0.6920 0.2382 0.0000</span>
<span class="co">## I7  0.0000 0.6955 0.0000</span>
<span class="co">## I8  0.0000 0.6794 0.0000</span>
<span class="co">## I9  0.0000 0.7872 0.0000</span>
<span class="co">## I10 0.0000 0.7624 0.0000</span>
<span class="co">## I11 0.0000 0.6771 0.3361</span>
<span class="co">## I12 0.0000 0.7016 0.2786</span>
<span class="co">## I13 0.0000 0.0000 0.6898</span>
<span class="co">## I14 0.0000 0.0000 0.7249</span>
<span class="co">## I15 0.0000 0.0000 0.7834</span>
<span class="co">## I16 0.0000 0.0000 0.7671</span>
<span class="co">## I17 0.2378 0.0000 0.6904</span>
<span class="co">## I18 0.1815 0.0000 0.7180</span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.2874 0.3379 2.7130 4.0566   1</span>
<span class="co">## F2 3.3166 0.3758 2.5306 4.0954   1</span>
<span class="co">## F3 3.5054 0.3906 2.7670 4.2822   1</span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col    est     sd  lower  upper sig</span>
<span class="co">## [1,]  14   1 0.2298 0.0485 0.1373 0.3297   1</span>
<span class="co">## [2,]   7   2 0.1967 0.0461 0.1072 0.2883   1</span>
<span class="co">## [3,]   4   3 0.1916 0.0649 0.0840 0.3414   1</span>
<span class="co">## [4,]  13   8 0.2002 0.0417 0.1191 0.2837   1</span>
<span class="co">## [5,]  10   9 0.1939 0.0705 0.0583 0.3293   1</span>
<span class="co">## [6,]  16  15 0.1890 0.0743 0.0462 0.3248   1</span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          [,1]    [,2]   [,3]</span>
<span class="co">##  [1,] -1.5481 -0.0169 1.5362</span>
<span class="co">##  [2,] -1.4707 -0.0202 1.5870</span>
<span class="co">##  [3,] -1.5306  0.0274 1.5410</span>
<span class="co">##  [4,] -1.6467  0.0209 1.5355</span>
<span class="co">##  [5,] -1.5333 -0.0363 1.4573</span>
<span class="co">##  [6,] -1.5638 -0.0219 1.5392</span>
<span class="co">##  [7,] -1.5129 -0.0077 1.5872</span>
<span class="co">##  [8,] -1.5810 -0.0442 1.4556</span>
<span class="co">##  [9,] -1.6115 -0.0061 1.6081</span>
<span class="co">## [10,] -1.6479 -0.0212 1.5501</span>
<span class="co">## [11,] -1.4545 -0.0385 1.4659</span>
<span class="co">## [12,] -1.4504 -0.0612 1.5905</span>
<span class="co">## [13,] -1.5193 -0.0064 1.5701</span>
<span class="co">## [14,] -1.4234 -0.0249 1.4884</span>
<span class="co">## [15,] -1.5135 -0.0521 1.4970</span>
<span class="co">## [16,] -1.5519 -0.0201 1.4865</span>
<span class="co">## [17,] -1.5281 -0.0204 1.5393</span>
<span class="co">## [18,] -1.4973 -0.0386 1.4489</span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> Configure the Q matrix for a CCFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step. Results are better than, but similar to the C-step.</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##     1 2 3</span>
<span class="co">## I1  1 0 0</span>
<span class="co">## I2  1 0 0</span>
<span class="co">## I3  1 0 0</span>
<span class="co">## I4  1 0 0</span>
<span class="co">## I5  1 1 0</span>
<span class="co">## I6  1 1 0</span>
<span class="co">## I7  0 1 0</span>
<span class="co">## I8  0 1 0</span>
<span class="co">## I9  0 1 0</span>
<span class="co">## I10 0 1 0</span>
<span class="co">## I11 0 1 1</span>
<span class="co">## I12 0 1 1</span>
<span class="co">## I13 0 0 1</span>
<span class="co">## I14 0 0 1</span>
<span class="co">## I15 0 0 1</span>
<span class="co">## I16 0 0 1</span>
<span class="co">## I17 1 0 1</span>
<span class="co">## I18 1 0 1</span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 10.15556</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     0.9999     1.0004</span>
<span class="co">## [2,]     1.0226     1.0925</span>
<span class="co">## [3,]     1.0118     1.0118</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 6</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3837.865 4053.762 3082.027</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  260.36   48.14  310.08</span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6868 0.0000 0.0000</span>
<span class="co">## I2  0.7149 0.0000 0.0000</span>
<span class="co">## I3  0.7259 0.0000 0.0000</span>
<span class="co">## I4  0.7261 0.0000 0.0000</span>
<span class="co">## I5  0.7030 0.2744 0.0000</span>
<span class="co">## I6  0.6775 0.2868 0.0000</span>
<span class="co">## I7  0.0000 0.6958 0.0000</span>
<span class="co">## I8  0.0000 0.7012 0.0000</span>
<span class="co">## I9  0.0000 0.7566 0.0000</span>
<span class="co">## I10 0.0000 0.7550 0.0000</span>
<span class="co">## I11 0.0000 0.6467 0.3948</span>
<span class="co">## I12 0.0000 0.6724 0.3567</span>
<span class="co">## I13 0.0000 0.0000 0.6934</span>
<span class="co">## I14 0.0000 0.0000 0.6984</span>
<span class="co">## I15 0.0000 0.0000 0.7650</span>
<span class="co">## I16 0.0000 0.0000 0.7498</span>
<span class="co">## I17 0.3187 0.0000 0.6888</span>
<span class="co">## I18 0.2408 0.0000 0.7205</span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.1686 0.2157 2.7597 3.6062   1</span>
<span class="co">## F2 3.1622 0.1865 2.8028 3.5308   1</span>
<span class="co">## F3 3.4081 0.2017 3.0128 3.8007   1</span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col    est     sd  lower  upper sig</span>
<span class="co">## [1,]  14   1 0.2662 0.0362 0.1935 0.3354   1</span>
<span class="co">## [2,]   7   2 0.2279 0.0368 0.1591 0.3017   1</span>
<span class="co">## [3,]   4   3 0.1939 0.0606 0.0811 0.3107   1</span>
<span class="co">## [4,]  13   8 0.2173 0.0359 0.1471 0.2862   1</span>
<span class="co">## [5,]  10   9 0.1768 0.0493 0.0838 0.2780   1</span>
<span class="co">## [6,]  16  15 0.1958 0.0500 0.0965 0.2906   1</span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          [,1]    [,2]   [,3]</span>
<span class="co">##  [1,] -1.5487 -0.0057 1.5504</span>
<span class="co">##  [2,] -1.4580 -0.0111 1.6059</span>
<span class="co">##  [3,] -1.5197  0.0359 1.5563</span>
<span class="co">##  [4,] -1.6426  0.0321 1.5525</span>
<span class="co">##  [5,] -1.5292 -0.0240 1.4794</span>
<span class="co">##  [6,] -1.5455 -0.0083 1.5423</span>
<span class="co">##  [7,] -1.5052 -0.0044 1.5769</span>
<span class="co">##  [8,] -1.5690 -0.0423 1.4425</span>
<span class="co">##  [9,] -1.6117 -0.0013 1.6046</span>
<span class="co">## [10,] -1.6249 -0.0165 1.5503</span>
<span class="co">## [11,] -1.4469 -0.0312 1.4732</span>
<span class="co">## [12,] -1.4453 -0.0542 1.6037</span>
<span class="co">## [13,] -1.5088 -0.0040 1.5699</span>
<span class="co">## [14,] -1.4217 -0.0207 1.5002</span>
<span class="co">## [15,] -1.4990 -0.0420 1.5054</span>
<span class="co">## [16,] -1.5506 -0.0140 1.4988</span>
<span class="co">## [17,] -1.5112 -0.0103 1.5572</span>
<span class="co">## [18,] -1.4811 -0.0254 1.4605</span></code></pre>
</div>
<div class="section level2">
<h2 id="mixed-type-data-with-missingness-and-local-dependence">Mixed-type Data with Missingness and Local Dependence:<a class="anchor" aria-label="anchor" href="#mixed-type-data-with-missingness-and-local-dependence"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Obtain the data and check the true loading pattern (<em>qlam</em>) and local dependence.</li>
</ol>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim18mcfa41</span><span class="op">$</span><span class="va">dat</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#10% missingness at random</span></code></pre></div>
<pre><code><span class="co">##        V1              V2              V3              V4       </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000  </span>
<span class="co">##  Median :3.000   Median :3.000   Median :2.000   Median :2.000  </span>
<span class="co">##  Mean   :2.505   Mean   :2.497   Mean   :2.496   Mean   :2.506  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000  </span>
<span class="co">##  NA's   :84      NA's   :101     NA's   :104     NA's   :95     </span>
<span class="co">##        V5              V6              V7                 V8          </span>
<span class="co">##  Min.   :1.000   Min.   :1.000   Min.   :-2.81026   Min.   :-3.23753  </span>
<span class="co">##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:-0.71029   1st Qu.:-0.62884  </span>
<span class="co">##  Median :3.000   Median :3.000   Median :-0.00391   Median : 0.04407  </span>
<span class="co">##  Mean   :2.524   Mean   :2.515   Mean   :-0.01609   Mean   : 0.05464  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.: 0.64606   3rd Qu.: 0.76442  </span>
<span class="co">##  Max.   :4.000   Max.   :4.000   Max.   : 2.70247   Max.   : 2.89557  </span>
<span class="co">##  NA's   :84      NA's   :104     NA's   :85         NA's   :94        </span>
<span class="co">##        V9                V10                V11                V12          </span>
<span class="co">##  Min.   :-3.30561   Min.   :-3.02592   Min.   :-3.41374   Min.   :-2.82342  </span>
<span class="co">##  1st Qu.:-0.66089   1st Qu.:-0.61385   1st Qu.:-0.63676   1st Qu.:-0.67127  </span>
<span class="co">##  Median :-0.00165   Median : 0.01598   Median : 0.01521   Median : 0.04094  </span>
<span class="co">##  Mean   : 0.00834   Mean   : 0.02074   Mean   : 0.00846   Mean   : 0.01327  </span>
<span class="co">##  3rd Qu.: 0.68991   3rd Qu.: 0.69146   3rd Qu.: 0.70011   3rd Qu.: 0.69313  </span>
<span class="co">##  Max.   : 3.29942   Max.   : 3.03966   Max.   : 3.24879   Max.   : 3.37976  </span>
<span class="co">##  NA's   :112        NA's   :125        NA's   :105        NA's   :96        </span>
<span class="co">##       V13                V14                V15                V16          </span>
<span class="co">##  Min.   :-2.91486   Min.   :-3.35077   Min.   :-3.79077   Min.   :-2.98539  </span>
<span class="co">##  1st Qu.:-0.63790   1st Qu.:-0.68802   1st Qu.:-0.59432   1st Qu.:-0.65737  </span>
<span class="co">##  Median : 0.01362   Median : 0.04734   Median : 0.07327   Median : 0.03254  </span>
<span class="co">##  Mean   : 0.01722   Mean   : 0.00211   Mean   : 0.04284   Mean   : 0.01089  </span>
<span class="co">##  3rd Qu.: 0.69528   3rd Qu.: 0.67515   3rd Qu.: 0.73561   3rd Qu.: 0.69205  </span>
<span class="co">##  Max.   : 3.44561   Max.   : 2.93371   Max.   : 3.35474   Max.   : 3.16500  </span>
<span class="co">##  NA's   :118        NA's   :86         NA's   :116        NA's   :89        </span>
<span class="co">##       V17                V18          </span>
<span class="co">##  Min.   :-2.72783   Min.   :-2.98409  </span>
<span class="co">##  1st Qu.:-0.64767   1st Qu.:-0.68150  </span>
<span class="co">##  Median : 0.02905   Median : 0.06052  </span>
<span class="co">##  Mean   : 0.00466   Mean   : 0.03421  </span>
<span class="co">##  3rd Qu.: 0.63216   3rd Qu.: 0.71505  </span>
<span class="co">##  Max.   : 3.28462   Max.   : 3.06039  </span>
<span class="co">##  NA's   :120        NA's   :110</span></code></pre>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co"># no. of items</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># no. of factors</span>
<span class="va">sim18mcfa41</span><span class="op">$</span><span class="va">qlam</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]  0.7  0.0  0.0</span>
<span class="co">##  [2,]  0.7  0.0  0.0</span>
<span class="co">##  [3,]  0.7  0.0  0.0</span>
<span class="co">##  [4,]  0.7  0.0  0.0</span>
<span class="co">##  [5,]  0.7  0.3  0.0</span>
<span class="co">##  [6,]  0.7  0.3  0.0</span>
<span class="co">##  [7,]  0.0  0.7  0.0</span>
<span class="co">##  [8,]  0.0  0.7  0.0</span>
<span class="co">##  [9,]  0.0  0.7  0.0</span>
<span class="co">## [10,]  0.0  0.7  0.0</span>
<span class="co">## [11,]  0.0  0.7  0.3</span>
<span class="co">## [12,]  0.0  0.7  0.3</span>
<span class="co">## [13,]  0.0  0.0  0.7</span>
<span class="co">## [14,]  0.0  0.0  0.7</span>
<span class="co">## [15,]  0.0  0.0  0.7</span>
<span class="co">## [16,]  0.0  0.0  0.7</span>
<span class="co">## [17,]  0.3  0.0  0.7</span>
<span class="co">## [18,]  0.3  0.0  0.7</span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim18mcfa41</span><span class="op">$</span><span class="va">LD</span> <span class="co"># effect size = .3</span></code></pre></div>
<pre><code><span class="co">##      row col</span>
<span class="co">## [1,]  14   1</span>
<span class="co">## [2,]   7   2</span>
<span class="co">## [3,]   4   3</span>
<span class="co">## [4,]  13   8</span>
<span class="co">## [5,]  10   9</span>
<span class="co">## [6,]  16  15</span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>E-step:</strong> Estimate with the GPCFA-LI model (E-step) by setting <em>LD=FALSE</em> and the design matrix Q. Only a few loadings need to be specified in Q (e.g., 2 per factor). The first 6 items are categorical and need to be specified with <em>cati</em>.</li>
</ol>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>; <span class="co"># -1 for unspecified items</span>
<span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">Q</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># 1 for specified items</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]   -1   -1   -1</span>
<span class="co">##  [4,]   -1   -1   -1</span>
<span class="co">##  [5,]   -1   -1   -1</span>
<span class="co">##  [6,]   -1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1   -1   -1</span>
<span class="co">## [10,]   -1   -1   -1</span>
<span class="co">## [11,]   -1   -1   -1</span>
<span class="co">## [12,]   -1   -1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1   -1</span>
<span class="co">## [16,]   -1   -1   -1</span>
<span class="co">## [17,]   -1   -1   -1</span>
<span class="co">## [18,]   -1   -1   -1</span></code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>,LD <span class="op">=</span> <span class="cn">FALSE</span>, cati <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 10.15556</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.1481     1.4378</span>
<span class="co">## [2,]     1.0588     1.2261</span>
<span class="co">## [3,]     1.0571     1.1682</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">## [1] 1 2 3 4 5 6</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3875.109 2565.383 2197.301</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  129.00   33.13  162.34</span></code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6876 0.0000 0.0000</span>
<span class="co">## I2  0.7572 0.0000 0.0000</span>
<span class="co">## I3  0.8128 0.0000 0.0000</span>
<span class="co">## I4  0.8082 0.0000 0.0000</span>
<span class="co">## I5  0.6787 0.2801 0.0000</span>
<span class="co">## I6  0.6383 0.2853 0.0000</span>
<span class="co">## I7  0.0000 0.6618 0.0000</span>
<span class="co">## I8  0.0000 0.6822 0.0000</span>
<span class="co">## I9  0.0000 0.8713 0.0000</span>
<span class="co">## I10 0.0000 0.8685 0.0000</span>
<span class="co">## I11 0.0000 0.6839 0.2978</span>
<span class="co">## I12 0.0000 0.6821 0.2826</span>
<span class="co">## I13 0.0000 0.0000 0.6637</span>
<span class="co">## I14 0.0000 0.0000 0.6640</span>
<span class="co">## I15 0.0000 0.0000 0.8562</span>
<span class="co">## I16 0.0000 0.0000 0.8737</span>
<span class="co">## I17 0.2816 0.0000 0.6517</span>
<span class="co">## I18 0.2267 0.0000 0.6745</span></code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.5173 0.5809 2.6630 4.6969   1</span>
<span class="co">## F2 3.6563 0.5120 2.7873 4.7220   1</span>
<span class="co">## F3 3.5761 0.4549 2.7268 4.4855   1</span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span> <span class="co"># only for 12 items </span></code></pre></div>
<pre><code><span class="co">##         [,1]    [,2]   [,3]</span>
<span class="co">## [1,] -1.5116 -0.0136 1.5195</span>
<span class="co">## [2,] -1.4373 -0.0177 1.5803</span>
<span class="co">## [3,] -1.5156  0.0281 1.5275</span>
<span class="co">## [4,] -1.6250  0.0245 1.5176</span>
<span class="co">## [5,] -1.5312 -0.0392 1.4713</span>
<span class="co">## [6,] -1.5594 -0.0179 1.5400</span></code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span> <span class="co"># trace</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'density'</span><span class="op">)</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/plot_lawbl.html">plot_lawbl</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">'EPSR'</span><span class="op">)</span> <span class="co">#EPSR</span></code></pre></div>
<p><img src="gpcfa-examples_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>C-step:</strong> Reconfigure the Q matrix for the C-step with one specified loading per item based on results from the E-step. Estimate with the GPCFA model by setting <em>LD=TRUE</em> (by default). The estimates are more accurate, and the LD terms can be largely recovered.</li>
</ol>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span>;
<span class="va">tmp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m0</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">cind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="fl">1</span>,<span class="va">which.max</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span>,<span class="va">cind</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##       [,1] [,2] [,3]</span>
<span class="co">##  [1,]    1   -1   -1</span>
<span class="co">##  [2,]    1   -1   -1</span>
<span class="co">##  [3,]    1   -1   -1</span>
<span class="co">##  [4,]    1   -1   -1</span>
<span class="co">##  [5,]    1   -1   -1</span>
<span class="co">##  [6,]    1   -1   -1</span>
<span class="co">##  [7,]   -1    1   -1</span>
<span class="co">##  [8,]   -1    1   -1</span>
<span class="co">##  [9,]   -1    1   -1</span>
<span class="co">## [10,]   -1    1   -1</span>
<span class="co">## [11,]   -1    1   -1</span>
<span class="co">## [12,]   -1    1   -1</span>
<span class="co">## [13,]   -1   -1    1</span>
<span class="co">## [14,]   -1   -1    1</span>
<span class="co">## [15,]   -1   -1    1</span>
<span class="co">## [16,]   -1   -1    1</span>
<span class="co">## [17,]   -1   -1    1</span>
<span class="co">## [18,]   -1   -1    1</span></code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 10.15556</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0014     1.0018</span>
<span class="co">## [2,]     1.0160     1.0737</span>
<span class="co">## [3,]     1.0069     1.0344</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 6</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">## [1] 1 2 3 4 5 6</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3598.992 3455.159 2336.191</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  185.97   26.87  213.67</span></code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.7066 0.0000 0.0000</span>
<span class="co">## I2  0.7088 0.0000 0.0000</span>
<span class="co">## I3  0.7555 0.0000 0.0000</span>
<span class="co">## I4  0.7599 0.0000 0.0000</span>
<span class="co">## I5  0.7038 0.2372 0.0000</span>
<span class="co">## I6  0.6854 0.2493 0.0000</span>
<span class="co">## I7  0.0000 0.6944 0.0000</span>
<span class="co">## I8  0.0000 0.6916 0.0000</span>
<span class="co">## I9  0.0000 0.7420 0.0000</span>
<span class="co">## I10 0.0000 0.7357 0.0000</span>
<span class="co">## I11 0.0000 0.6813 0.3079</span>
<span class="co">## I12 0.0000 0.7045 0.2768</span>
<span class="co">## I13 0.0000 0.0000 0.7112</span>
<span class="co">## I14 0.0000 0.0000 0.6745</span>
<span class="co">## I15 0.0000 0.0000 0.7393</span>
<span class="co">## I16 0.0000 0.0000 0.7509</span>
<span class="co">## I17 0.2593 0.0000 0.6897</span>
<span class="co">## I18 0.2022 0.0000 0.7185</span></code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.3038 0.2860 2.7999 3.8838   1</span>
<span class="co">## F2 3.2225 0.2984 2.6530 3.8015   1</span>
<span class="co">## F3 3.3168 0.3385 2.6656 3.9809   1</span></code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col    est     sd  lower  upper sig</span>
<span class="co">## [1,]  14   1 0.2651 0.0455 0.1782 0.3575   1</span>
<span class="co">## [2,]   7   2 0.2406 0.0501 0.1383 0.3371   1</span>
<span class="co">## [3,]   4   3 0.1705 0.0655 0.0378 0.2954   1</span>
<span class="co">## [4,]  13   8 0.2391 0.0419 0.1626 0.3244   1</span>
<span class="co">## [5,]  10   9 0.2517 0.0612 0.1305 0.3687   1</span>
<span class="co">## [6,]  16  15 0.2387 0.0568 0.1218 0.3378   1</span></code></pre>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         [,1]    [,2]   [,3]</span>
<span class="co">## [1,] -1.5341 -0.0186 1.5166</span>
<span class="co">## [2,] -1.4704 -0.0244 1.5781</span>
<span class="co">## [3,] -1.5264  0.0223 1.5391</span>
<span class="co">## [4,] -1.6330  0.0191 1.5240</span>
<span class="co">## [5,] -1.5267 -0.0365 1.4651</span>
<span class="co">## [6,] -1.5480 -0.0243 1.5299</span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>CFA-LD:</strong> Configure the Q matrix for a mix of CFA and CCFA model with local dependence (i.e. without any unspecified loading) based on results from the C-step. Results are better than, but similar to the C-step.</li>
</ol>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, what<span class="op">=</span><span class="st">"qlambda"</span><span class="op">)</span>
<span class="va">Q</span><span class="op">[</span><span class="va">Q</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">Q</span></code></pre></div>
<pre><code><span class="co">##     1 2 3</span>
<span class="co">## I1  1 0 0</span>
<span class="co">## I2  1 0 0</span>
<span class="co">## I3  1 0 0</span>
<span class="co">## I4  1 0 0</span>
<span class="co">## I5  1 1 0</span>
<span class="co">## I6  1 1 0</span>
<span class="co">## I7  0 1 0</span>
<span class="co">## I8  0 1 0</span>
<span class="co">## I9  0 1 0</span>
<span class="co">## I10 0 1 0</span>
<span class="co">## I11 0 1 1</span>
<span class="co">## I12 0 1 1</span>
<span class="co">## I13 0 0 1</span>
<span class="co">## I14 0 0 1</span>
<span class="co">## I15 0 0 1</span>
<span class="co">## I16 0 0 1</span>
<span class="co">## I17 1 0 1</span>
<span class="co">## I18 1 0 1</span></code></pre>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/pcfa.html">pcfa</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, cati <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,burn <span class="op">=</span> <span class="fl">5000</span>, iter <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $NJK</span>
<span class="co">## [1] 1000   18    3</span>
<span class="co">## </span>
<span class="co">## $`Miss%`</span>
<span class="co">## [1] 10.15556</span>
<span class="co">## </span>
<span class="co">## $`LD Allowed`</span>
<span class="co">## [1] TRUE</span>
<span class="co">## </span>
<span class="co">## $`Burn in`</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $Iteration</span>
<span class="co">## [1] 5000</span>
<span class="co">## </span>
<span class="co">## $`No. of sig lambda`</span>
<span class="co">## [1] 24</span>
<span class="co">## </span>
<span class="co">## $Selected</span>
<span class="co">## [1] TRUE TRUE TRUE</span>
<span class="co">## </span>
<span class="co">## $`Auto, NCONV, MCONV`</span>
<span class="co">## [1]  0  0 10</span>
<span class="co">## </span>
<span class="co">## $EPSR</span>
<span class="co">##      Point est. Upper C.I.</span>
<span class="co">## [1,]     1.0129     1.0174</span>
<span class="co">## [2,]     1.0100     1.0438</span>
<span class="co">## [3,]     1.0181     1.0578</span>
<span class="co">## </span>
<span class="co">## $`No. of sig LD terms`</span>
<span class="co">## [1] 6</span>
<span class="co">## </span>
<span class="co">## $`Cat Items`</span>
<span class="co">## [1] 1 2 3 4 5 6</span>
<span class="co">## </span>
<span class="co">## $`max No. of categories`</span>
<span class="co">## [1] 4</span>
<span class="co">## </span>
<span class="co">## $`DIC, BIC, AIC`</span>
<span class="co">## [1] 3316.863 2617.938 1646.202</span>
<span class="co">## </span>
<span class="co">## $Time</span>
<span class="co">##    user  system elapsed </span>
<span class="co">##  153.85   14.26  168.48</span></code></pre>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'qlambda'</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">##          1      2      3</span>
<span class="co">## I1  0.6837 0.0000 0.0000</span>
<span class="co">## I2  0.7024 0.0000 0.0000</span>
<span class="co">## I3  0.7379 0.0000 0.0000</span>
<span class="co">## I4  0.7342 0.0000 0.0000</span>
<span class="co">## I5  0.6921 0.2838 0.0000</span>
<span class="co">## I6  0.6792 0.2919 0.0000</span>
<span class="co">## I7  0.0000 0.6970 0.0000</span>
<span class="co">## I8  0.0000 0.7018 0.0000</span>
<span class="co">## I9  0.0000 0.7336 0.0000</span>
<span class="co">## I10 0.0000 0.7529 0.0000</span>
<span class="co">## I11 0.0000 0.6666 0.3383</span>
<span class="co">## I12 0.0000 0.6929 0.3096</span>
<span class="co">## I13 0.0000 0.0000 0.7030</span>
<span class="co">## I14 0.0000 0.0000 0.6693</span>
<span class="co">## I15 0.0000 0.0000 0.7628</span>
<span class="co">## I16 0.0000 0.0000 0.7660</span>
<span class="co">## I17 0.3063 0.0000 0.6879</span>
<span class="co">## I18 0.2502 0.0000 0.7082</span></code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'eigen'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       est     sd  lower  upper sig</span>
<span class="co">## F1 3.1570 0.1883 2.7964 3.5213   1</span>
<span class="co">## F2 3.1866 0.1807 2.8363 3.5337   1</span>
<span class="co">## F3 3.3083 0.1863 2.9527 3.6702   1</span></code></pre>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>, what <span class="op">=</span> <span class="st">'offpsx'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      row col    est     sd  lower  upper sig</span>
<span class="co">## [1,]  14   1 0.2931 0.0347 0.2264 0.3607   1</span>
<span class="co">## [2,]   7   2 0.2774 0.0321 0.2166 0.3424   1</span>
<span class="co">## [3,]   4   3 0.1791 0.0543 0.0649 0.2770   1</span>
<span class="co">## [4,]  13   8 0.2508 0.0307 0.1943 0.3160   1</span>
<span class="co">## [5,]  10   9 0.2330 0.0505 0.1378 0.3277   1</span>
<span class="co">## [6,]  16  15 0.2114 0.0488 0.1181 0.3022   1</span></code></pre>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span>,what<span class="op">=</span><span class="st">'thd'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         [,1]    [,2]   [,3]</span>
<span class="co">## [1,] -1.5324 -0.0136 1.5230</span>
<span class="co">## [2,] -1.4692 -0.0213 1.5880</span>
<span class="co">## [3,] -1.5265  0.0306 1.5477</span>
<span class="co">## [4,] -1.6268  0.0222 1.5286</span>
<span class="co">## [5,] -1.5233 -0.0347 1.4636</span>
<span class="co">## [6,] -1.5557 -0.0227 1.5423</span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jinsong Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

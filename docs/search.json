[{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jinsong Chen. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chen J (2022). LAWBL: Latent (Variable) Analysis Bayesian Learning. https://github.com/Jinsong-Chen/LAWBL, https://jinsong-chen.github.io/LAWBL/.","code":"@Manual{,   title = {LAWBL: Latent (Variable) Analysis with Bayesian Learning},   author = {Jinsong Chen},   year = {2022},   note = {https://github.com/Jinsong-Chen/LAWBL, https://jinsong-chen.github.io/LAWBL/}, }"},{"path":[]},{"path":"/index.html","id":"how-to-cite-the-package","dir":"","previous_headings":"","what":"How to cite the package","title":"Latent (Variable) Analysis with Bayesian Learning","text":"Chen, J. (2022). LAWBL: Latent (variable) analysis Bayesian learning (R package version 1.5.0). Retrieved https://CRAN.R-project.org/package=LAWBL","code":""},{"path":"/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Latent (Variable) Analysis with Bayesian Learning","text":"LAWBL represents partially exploratory-confirmatory approach model latent variables based Bayesian learning. Built power statistical learning, can address psychometric challenges parameter specification, local dependence, factor extraction. Built scalability flexibility Bayesian inference resampling techniques, can accommodate modeling frameworks factor analysis, item response theory, cognitive diagnosis modeling causal explanatory modeling. package can also handle different response formats mix , without missingness.","code":""},{"path":"/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Latent (Variable) Analysis with Bayesian Learning","text":"Partially CFA (PCFA) continuous data: regularization loading specification local dependence; PCFA local independence (PCFA-LI); CFA local dependence (CFA-LD) Generalized PCFA (GPCFA) continuous, categorical, mixed-type data, without missingness; GPCFA local independence (GPCFA-LI); Generalized CFA local dependence (GCFA-LD) Partially confirmatory item response model (PCIRM) continuous dichotomous data intercept terms; PCIRM-LI; CIRM-LD Bayesian regularized EFA (BREFA): factor extraction parameter estimation one step; Fully partially EFA: unknown number factors without partial knowledge Estimation using different Bayesian learning methods MCMC algorithms Simulating data based aforementioned models Plotting trace, density Gelman-Rubin diagnostics based eigenvalue Summary parameters point interval estimates Please refer online tutorials details.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Latent (Variable) Analysis with Bayesian Learning","text":"Install stable version CRAN : Install devtools package (necessary), install development version Github.","code":"install.packages(\"LAWBL\") # install.packages(\"devtools\") devtools::install_github(\"Jinsong-Chen/LAWBL\")"},{"path":"/articles/LAWBL.html","id":"how-to-use-this-package-in-brief","dir":"Articles","previous_headings":"","what":"How to use this package in brief","title":"Quick Start","text":"design matrix Q needed PCFA, GPCFA, PCIRM, necessary PEFA Default setting can used minimize input (e.g., burn-, formal iteration, maximum number factors) estimate PCFA-LI (loadings can specified, e.g., 2 per factor), use m <- pcfa(dat=dat,Q=Q,LD=F) estimate PCFA (one specified loading per item), use m <- pcfa(dat=dat,Q=Q,LD=T) estimate BREFA FEFA (.e., PFEA without partial information), use m <- pefa(dat=dat) summarize basic information estimation, use summary(m) summarize significant loadings pattern/Q-matrix format, use summary(m,=‘qlambda’) summarize factorial eigenvalues, use summary(m,=‘eigen’) summarize significant LD terms, use summary(m,=‘offpsx’) plot eigenvalues’ trace, use plot_lawbl(m) plot eigenvalues’ density, use plot_lawbl(m, =‘density’) plot eigenvalues’ adjusted PSRF, use plot_lawbl(m, =‘APSR’) also encouraged visit online reference functions. examples use package, see PCFA continuous data: GPCFA categorical mixed-type data: PCIRM dichotomous data intercept terms: like contribute example website, please send .Rmd file jinsong.chen@live.com.","code":""},{"path":"/articles/Examples/gpcfa-examples.html","id":"categorical-data-with-missingness-but-no-local-dependence","dir":"Articles > Examples","previous_headings":"","what":"Categorical Data with Missingness but no Local Dependence:","title":"gpcfa-examples","text":"Load package, obtain data, check true loading pattern (qlam) local dependence. E-step: Estimate GPCFA-LI model (E-step) setting LD=F design matrix Q. loadings need specified Q (e.g., 2 per factor). Longer chain suggested accurate stable estimation.    C-step: Reconfigure Q matrix C-step one specified loading per item based results E-step. Estimate GPCFA model setting LD=TRUE (default). Longer chain suggested accurate stable estimation.    CFA-LD: One can also configure Q matrix CCFA model local dependence (.e. without unspecified loading) based results C-step.","code":"library(LAWBL) ## LAWBL Package (version 1.5.0; 2022-05-13) ## For tutorials, see https://jinsong-chen.github.io/LAWBL/ dat <- sim18ccfa40$dat dim(dat) ## [1] 1000   18 summary(dat) #10% missingness at random ##        V1              V2             V3              V4              V5        ##  Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   ##  Median :2.000   Median :2.00   Median :2.000   Median :2.000   Median :2.000   ##  Mean   :2.446   Mean   :2.47   Mean   :2.471   Mean   :2.454   Mean   :2.479   ##  3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.00   Max.   :4.000   Max.   :4.000   Max.   :4.000   ##  NA's   :86      NA's   :103    NA's   :98      NA's   :101     NA's   :102     ##        V6              V7              V8              V9        ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   ##  Median :2.000   Median :2.000   Median :3.000   Median :3.000   ##  Mean   :2.459   Mean   :2.472   Mean   :2.538   Mean   :2.499   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   ##  NA's   :105     NA's   :99      NA's   :94      NA's   :99      ##       V10             V11             V12             V13        ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   ##  Median :2.000   Median :2.000   Median :2.000   Median :3.000   ##  Mean   :2.486   Mean   :2.477   Mean   :2.481   Mean   :2.553   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   ##  NA's   :99      NA's   :100     NA's   :98      NA's   :90      ##       V14             V15             V16             V17        ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   ##  Median :2.000   Median :3.000   Median :2.500   Median :2.000   ##  Mean   :2.478   Mean   :2.529   Mean   :2.511   Mean   :2.475   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   ##  NA's   :84      NA's   :107     NA's   :100     NA's   :107     ##       V18        ##  Min.   :1.000   ##  1st Qu.:2.000   ##  Median :2.000   ##  Mean   :2.478   ##  3rd Qu.:3.000   ##  Max.   :4.000   ##  NA's   :108 J <- ncol(dat) # no. of items K <- 3 # no. of factors sim18ccfa40$qlam ##       [,1] [,2] [,3] ##  [1,]  0.7  0.0  0.0 ##  [2,]  0.7  0.0  0.0 ##  [3,]  0.7  0.0  0.0 ##  [4,]  0.7  0.0  0.0 ##  [5,]  0.7  0.3  0.0 ##  [6,]  0.7  0.3  0.0 ##  [7,]  0.0  0.7  0.0 ##  [8,]  0.0  0.7  0.0 ##  [9,]  0.0  0.7  0.0 ## [10,]  0.0  0.7  0.0 ## [11,]  0.0  0.7  0.3 ## [12,]  0.0  0.7  0.3 ## [13,]  0.0  0.0  0.7 ## [14,]  0.0  0.0  0.7 ## [15,]  0.0  0.0  0.7 ## [16,]  0.0  0.0  0.7 ## [17,]  0.3  0.0  0.7 ## [18,]  0.3  0.0  0.7 sim18ccfa40$LD ##      row col Q<-matrix(-1,J,K); # -1 for unspecified items Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1 # 1 for specified items Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]   -1   -1   -1 ##  [4,]   -1   -1   -1 ##  [5,]   -1   -1   -1 ##  [6,]   -1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1   -1   -1 ## [10,]   -1   -1   -1 ## [11,]   -1   -1   -1 ## [12,]   -1   -1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1   -1 ## [16,]   -1   -1   -1 ## [17,]   -1   -1   -1 ## [18,]   -1   -1   -1 m0 <- pcfa(dat = dat, Q = Q,LD = FALSE, cati = -1,burn = 5000, iter = 5000)  # summarize basic information summary(m0) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 9.888889 ##  ## $`LD Allowed` ## [1] FALSE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0542     1.2080 ## [2,]     1.3675     2.1326 ## [3,]     1.7886     3.4113 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 4092.631 3636.207 3268.126 ##  ## $Time ##    user  system elapsed  ##  206.41   36.11  243.20 #summarize significant loadings in pattern/Q-matrix format summary(m0, what = 'qlambda') ##          1      2      3 ## I1  0.7494 0.0000 0.0000 ## I2  0.7502 0.0000 0.0000 ## I3  0.7564 0.0000 0.0000 ## I4  0.7714 0.0000 0.0000 ## I5  0.7668 0.2186 0.0000 ## I6  0.7243 0.2176 0.0000 ## I7  0.0000 0.7452 0.0000 ## I8  0.0000 0.7423 0.0000 ## I9  0.0000 0.7394 0.0000 ## I10 0.0000 0.7101 0.0000 ## I11 0.0000 0.7108 0.2506 ## I12 0.0000 0.7043 0.2496 ## I13 0.0000 0.0000 0.7405 ## I14 0.0000 0.0000 0.7169 ## I15 0.0000 0.0000 0.7262 ## I16 0.0000 0.0000 0.7056 ## I17 0.2992 0.0000 0.7270 ## I18 0.3182 0.0000 0.6622 #factorial eigenvalue summary(m0,what='eigen') ##       est     sd  lower  upper sig ## F1 3.7133 0.5313 2.6856 4.7797   1 ## F2 3.4365 0.4868 2.5644 4.4104   1 ## F3 3.3232 0.4754 2.4596 4.2694   1 #thresholds for categorical items summary(m0,what='thd') ##          [,1]    [,2]   [,3] ##  [1,] -1.3548  0.0686 1.6157 ##  [2,] -1.4361  0.0550 1.4945 ##  [3,] -1.4567  0.0561 1.5076 ##  [4,] -1.3796  0.0598 1.6020 ##  [5,] -1.4236  0.0158 1.4669 ##  [6,] -1.4962  0.0788 1.5805 ##  [7,] -1.4978  0.0360 1.6452 ##  [8,] -1.5220 -0.0578 1.4083 ##  [9,] -1.4744 -0.0130 1.5056 ## [10,] -1.4871  0.0100 1.6224 ## [11,] -1.4518  0.0191 1.5725 ## [12,] -1.5360  0.0168 1.6319 ## [13,] -1.5612 -0.0596 1.3936 ## [14,] -1.4252  0.0421 1.5051 ## [15,] -1.5544 -0.0322 1.4690 ## [16,] -1.4710 -0.0154 1.3745 ## [17,] -1.4405  0.0543 1.4854 ## [18,] -1.5317  0.0301 1.5441 #plotting factorial eigenvalue plot_lawbl(m0) # trace plot_lawbl(m0, what='density') #density plot_lawbl(m0, what='EPSR') #EPSR Q<-matrix(-1,J,K); tmp<-summary(m0, what=\"qlambda\") cind<-apply(tmp,1,which.max) Q[cbind(c(1:J),cind)]<-1 #alternatively #Q[1:6,1]<-Q[7:12,2]<-Q[13:18,3]<-1 # 1 for specified items  m1 <- pcfa(dat = dat, Q = Q, cati = -1) summary(m1) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 9.888889 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0368     1.1365 ## [2,]     1.1515     1.5341 ## [3,]     1.0408     1.1749 ##  ## $`No. of sig LD terms` ## [1] 0 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 4440.175 5223.739 4104.771 ##  ## $Time ##    user  system elapsed  ##  265.05   33.73  300.14 summary(m1, what = 'qlambda') ##          1      2      3 ## I1  0.7267 0.0000 0.0000 ## I2  0.7174 0.0000 0.0000 ## I3  0.7347 0.0000 0.0000 ## I4  0.7412 0.0000 0.0000 ## I5  0.7332 0.2608 0.0000 ## I6  0.7001 0.2541 0.0000 ## I7  0.0000 0.7281 0.0000 ## I8  0.0000 0.7390 0.0000 ## I9  0.0000 0.7309 0.0000 ## I10 0.0000 0.7084 0.0000 ## I11 0.0000 0.7163 0.2296 ## I12 0.0000 0.7058 0.2424 ## I13 0.0000 0.0000 0.7384 ## I14 0.0000 0.0000 0.7249 ## I15 0.0000 0.0000 0.7290 ## I16 0.0000 0.0000 0.7118 ## I17 0.2468 0.0000 0.7328 ## I18 0.2735 0.0000 0.6678 summary(m1, what = 'offpsx') #summarize significant LD terms ##      row col est sd lower upper sig summary(m1,what='eigen') ##       est     sd  lower  upper sig ## F1 3.4084 0.4528 2.5969 4.3290   1 ## F2 3.3473 0.3250 2.7404 4.0345   1 ## F3 3.3178 0.4089 2.5469 4.1735   1 summary(m1,what='thd') ##          [,1]    [,2]   [,3] ##  [1,] -1.3459  0.0683 1.6090 ##  [2,] -1.4491  0.0559 1.4960 ##  [3,] -1.4544  0.0525 1.4999 ##  [4,] -1.3818  0.0531 1.5951 ##  [5,] -1.4195  0.0143 1.4589 ##  [6,] -1.4877  0.0794 1.5676 ##  [7,] -1.4933  0.0406 1.6500 ##  [8,] -1.5286 -0.0571 1.4116 ##  [9,] -1.4567 -0.0098 1.4929 ## [10,] -1.4996  0.0126 1.6338 ## [11,] -1.4561  0.0223 1.5706 ## [12,] -1.5264  0.0201 1.6214 ## [13,] -1.5780 -0.0639 1.3885 ## [14,] -1.4250  0.0390 1.4975 ## [15,] -1.5565 -0.0362 1.4656 ## [16,] -1.4636 -0.0190 1.3684 ## [17,] -1.4411  0.0505 1.4726 ## [18,] -1.5269  0.0258 1.5274 #plotting factorial eigenvalue plot_lawbl(m1) # trace plot_lawbl(m1, what='density') #density plot_lawbl(m1, what='EPSR') #EPSR Q<-summary(m1, what=\"qlambda\") Q[Q!=0]<-1 Q ##     1 2 3 ## I1  1 0 0 ## I2  1 0 0 ## I3  1 0 0 ## I4  1 0 0 ## I5  1 1 0 ## I6  1 1 0 ## I7  0 1 0 ## I8  0 1 0 ## I9  0 1 0 ## I10 0 1 0 ## I11 0 1 1 ## I12 0 1 1 ## I13 0 0 1 ## I14 0 0 1 ## I15 0 0 1 ## I16 0 0 1 ## I17 1 0 1 ## I18 1 0 1 m2 <- pcfa(dat = dat, Q = Q, cati = -1,burn = 5000, iter = 5000) summary(m2) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 9.888889 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0076     1.0164 ## [2,]     1.0308     1.1020 ## [3,]     1.0186     1.0865 ##  ## $`No. of sig LD terms` ## [1] 0 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 4247.119 4696.680 3724.944 ##  ## $Time ##    user  system elapsed  ##  247.27   16.60  264.81 summary(m2, what = 'qlambda') ##          1      2      3 ## I1  0.7056 0.0000 0.0000 ## I2  0.7227 0.0000 0.0000 ## I3  0.6963 0.0000 0.0000 ## I4  0.7289 0.0000 0.0000 ## I5  0.7036 0.3015 0.0000 ## I6  0.6923 0.3032 0.0000 ## I7  0.0000 0.6828 0.0000 ## I8  0.0000 0.7527 0.0000 ## I9  0.0000 0.6927 0.0000 ## I10 0.0000 0.6862 0.0000 ## I11 0.0000 0.6785 0.3011 ## I12 0.0000 0.6968 0.3375 ## I13 0.0000 0.0000 0.7063 ## I14 0.0000 0.0000 0.7253 ## I15 0.0000 0.0000 0.6930 ## I16 0.0000 0.0000 0.7205 ## I17 0.2925 0.0000 0.6826 ## I18 0.3184 0.0000 0.6644 summary(m2, what = 'offpsx') ##      row col est sd lower upper sig summary(m2,what='eigen') ##       est     sd  lower  upper sig ## F1 3.2121 0.1904 2.8286 3.5794   1 ## F2 3.1286 0.1873 2.7798 3.5067   1 ## F3 3.1529 0.1942 2.7775 3.5456   1 summary(m2,what='thd') ##          [,1]    [,2]   [,3] ##  [1,] -1.3475  0.0734 1.6202 ##  [2,] -1.4352  0.0640 1.5033 ##  [3,] -1.4400  0.0575 1.5008 ##  [4,] -1.3773  0.0622 1.6034 ##  [5,] -1.4175  0.0229 1.4704 ##  [6,] -1.4756  0.0891 1.5653 ##  [7,] -1.4872  0.0434 1.6372 ##  [8,] -1.5166 -0.0560 1.4114 ##  [9,] -1.4524 -0.0072 1.4929 ## [10,] -1.4758  0.0154 1.6270 ## [11,] -1.4475  0.0272 1.5720 ## [12,] -1.5205  0.0250 1.6386 ## [13,] -1.5645 -0.0583 1.3987 ## [14,] -1.4151  0.0478 1.5086 ## [15,] -1.5323 -0.0250 1.4645 ## [16,] -1.4516 -0.0098 1.3737 ## [17,] -1.4297  0.0592 1.4922 ## [18,] -1.5078  0.0364 1.5444 plot_lawbl(m2) # Eigens' traces are excellent without regularization of the loadings"},{"path":"/articles/Examples/gpcfa-examples.html","id":"categorical-data-with-missingness-and-local-dependence","dir":"Articles > Examples","previous_headings":"","what":"Categorical Data with Missingness and Local Dependence:","title":"gpcfa-examples","text":"Obtain data check true loading pattern (qlam) local dependence. E-step: Estimate GPCFA-LI model (E-step) setting LD=FALSE design matrix Q. loadings need specified Q (e.g., 2 per factor). loading estimates biased due ignoring LD. eigenvalues.   C-step: Reconfigure Q matrix C-step one specified loading per item based results E-step. Estimate GPCFA model setting LD=TRUE (default). estimates accurate, LD terms can largely recovered. CFA-LD: Configure Q matrix CCFA model local dependence (.e. without unspecified loading) based results C-step. Results better , similar C-step.","code":"dat <- sim18ccfa41$dat summary(dat) #10% missingness at random ##        V1              V2              V3              V4        ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   ##  Median :3.000   Median :3.000   Median :2.000   Median :2.000   ##  Mean   :2.505   Mean   :2.497   Mean   :2.496   Mean   :2.506   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   ##  NA's   :84      NA's   :101     NA's   :104     NA's   :95      ##        V5              V6              V7             V8              V9        ##  Min.   :1.000   Min.   :1.000   Min.   :1.00   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.000   1st Qu.:2.000   ##  Median :3.000   Median :3.000   Median :2.00   Median :3.000   Median :2.000   ##  Mean   :2.524   Mean   :2.515   Mean   :2.49   Mean   :2.532   Mean   :2.499   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.00   Max.   :4.000   Max.   :4.000   ##  NA's   :84      NA's   :104     NA's   :85     NA's   :94      NA's   :112     ##       V10             V11             V12             V13           V14        ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.0   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.0   1st Qu.:2.000   ##  Median :3.000   Median :3.000   Median :3.000   Median :3.0   Median :3.000   ##  Mean   :2.514   Mean   :2.503   Mean   :2.502   Mean   :2.5   Mean   :2.503   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.0   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.0   Max.   :4.000   ##  NA's   :125     NA's   :105     NA's   :96      NA's   :118   NA's   :86      ##       V15             V16             V17             V18       ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.00   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.00   ##  Median :3.000   Median :3.000   Median :3.000   Median :3.00   ##  Mean   :2.528   Mean   :2.515   Mean   :2.503   Mean   :2.53   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.00   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.00   ##  NA's   :116     NA's   :89      NA's   :120     NA's   :110 J <- ncol(dat) # no. of items K <- 3 # no. of factors sim18ccfa41$qlam ##       [,1] [,2] [,3] ##  [1,]  0.7  0.0  0.0 ##  [2,]  0.7  0.0  0.0 ##  [3,]  0.7  0.0  0.0 ##  [4,]  0.7  0.0  0.0 ##  [5,]  0.7  0.3  0.0 ##  [6,]  0.7  0.3  0.0 ##  [7,]  0.0  0.7  0.0 ##  [8,]  0.0  0.7  0.0 ##  [9,]  0.0  0.7  0.0 ## [10,]  0.0  0.7  0.0 ## [11,]  0.0  0.7  0.3 ## [12,]  0.0  0.7  0.3 ## [13,]  0.0  0.0  0.7 ## [14,]  0.0  0.0  0.7 ## [15,]  0.0  0.0  0.7 ## [16,]  0.0  0.0  0.7 ## [17,]  0.3  0.0  0.7 ## [18,]  0.3  0.0  0.7 sim18ccfa41$LD # effect size = .3 ##      row col ## [1,]  14   1 ## [2,]   7   2 ## [3,]   4   3 ## [4,]  13   8 ## [5,]  10   9 ## [6,]  16  15 Q<-matrix(-1,J,K); # -1 for unspecified items Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1 # 1 for specified items Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]   -1   -1   -1 ##  [4,]   -1   -1   -1 ##  [5,]   -1   -1   -1 ##  [6,]   -1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1   -1   -1 ## [10,]   -1   -1   -1 ## [11,]   -1   -1   -1 ## [12,]   -1   -1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1   -1 ## [16,]   -1   -1   -1 ## [17,]   -1   -1   -1 ## [18,]   -1   -1   -1 m0 <- pcfa(dat = dat, Q = Q,LD = FALSE, cati = -1,burn = 5000, iter = 5000) summary(m0) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 10.15556 ##  ## $`LD Allowed` ## [1] FALSE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 23 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.4580     2.3875 ## [2,]     1.9994     4.0405 ## [3,]     1.1967     1.6815 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 3738.775 3687.415 3319.333 ##  ## $Time ##    user  system elapsed  ##  269.29   63.81  336.04 summary(m0, what = 'qlambda') ##          1      2      3 ## I1  0.6543 0.0000 0.0000 ## I2  0.7263 0.0000 0.0000 ## I3  0.8019 0.0000 0.0000 ## I4  0.7970 0.0000 0.0000 ## I5  0.6798 0.2779 0.0000 ## I6  0.6462 0.2727 0.0000 ## I7  0.0000 0.6286 0.0000 ## I8  0.0000 0.6336 0.0000 ## I9  0.0000 0.8457 0.0000 ## I10 0.0000 0.8292 0.0000 ## I11 0.0000 0.6029 0.4254 ## I12 0.0000 0.6159 0.3702 ## I13 0.0000 0.0000 0.7052 ## I14 0.0000 0.0000 0.7438 ## I15 0.0000 0.0000 0.8766 ## I16 0.0000 0.0000 0.8670 ## I17 0.2373 0.0000 0.6922 ## I18 0.0000 0.0000 0.7353 summary(m0,what='eigen') ##       est     sd  lower  upper sig ## F1 3.3932 0.4361 2.5928 4.2149   1 ## F2 3.3538 0.5630 2.3584 4.4203   1 ## F3 4.0893 0.8231 2.8673 5.9234   1 summary(m0,what='thd') ##          [,1]    [,2]   [,3] ##  [1,] -1.5197 -0.0118 1.5217 ##  [2,] -1.4287 -0.0156 1.5713 ##  [3,] -1.5167  0.0334 1.5375 ##  [4,] -1.6291  0.0278 1.5202 ##  [5,] -1.5382 -0.0372 1.4742 ##  [6,] -1.5829 -0.0201 1.5531 ##  [7,] -1.4971 -0.0116 1.5614 ##  [8,] -1.5561 -0.0513 1.4267 ##  [9,] -1.5959 -0.0135 1.5820 ## [10,] -1.6099 -0.0289 1.5185 ## [11,] -1.4588 -0.0442 1.4681 ## [12,] -1.4584 -0.0653 1.5872 ## [13,] -1.4944 -0.0075 1.5651 ## [14,] -1.3893 -0.0212 1.4638 ## [15,] -1.4857 -0.0390 1.4791 ## [16,] -1.5244 -0.0167 1.4658 ## [17,] -1.5263 -0.0132 1.5450 ## [18,] -1.4941 -0.0327 1.4575 plot_lawbl(m0) # trace plot_lawbl(m0, what='EPSR') #EPSR Q<-matrix(-1,J,K); tmp<-summary(m0, what=\"qlambda\") cind<-apply(tmp,1,which.max) Q[cbind(c(1:J),cind)]<-1 Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]    1   -1   -1 ##  [4,]    1   -1   -1 ##  [5,]    1   -1   -1 ##  [6,]    1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1    1   -1 ## [10,]   -1    1   -1 ## [11,]   -1    1   -1 ## [12,]   -1    1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1    1 ## [16,]   -1   -1    1 ## [17,]   -1   -1    1 ## [18,]   -1   -1    1 m1 <- pcfa(dat = dat, Q = Q, cati = -1,burn = 5000, iter = 5000) summary(m1) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 10.15556 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0606     1.2375 ## [2,]     1.1442     1.5127 ## [3,]     1.0213     1.0360 ##  ## $`No. of sig LD terms` ## [1] 6 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 4056.808 4814.414 3695.445 ##  ## $Time ##    user  system elapsed  ##  288.63   45.86  337.26 summary(m1, what = 'qlambda') ##          1      2      3 ## I1  0.7013 0.0000 0.0000 ## I2  0.7248 0.0000 0.0000 ## I3  0.7387 0.0000 0.0000 ## I4  0.7439 0.0000 0.0000 ## I5  0.7146 0.2324 0.0000 ## I6  0.6920 0.2382 0.0000 ## I7  0.0000 0.6955 0.0000 ## I8  0.0000 0.6794 0.0000 ## I9  0.0000 0.7872 0.0000 ## I10 0.0000 0.7624 0.0000 ## I11 0.0000 0.6771 0.3361 ## I12 0.0000 0.7016 0.2786 ## I13 0.0000 0.0000 0.6898 ## I14 0.0000 0.0000 0.7249 ## I15 0.0000 0.0000 0.7834 ## I16 0.0000 0.0000 0.7671 ## I17 0.2378 0.0000 0.6904 ## I18 0.1815 0.0000 0.7180 summary(m1,what='eigen') ##       est     sd  lower  upper sig ## F1 3.2874 0.3379 2.7130 4.0566   1 ## F2 3.3166 0.3758 2.5306 4.0954   1 ## F3 3.5054 0.3906 2.7670 4.2822   1 summary(m1, what = 'offpsx') ##      row col    est     sd  lower  upper sig ## [1,]  14   1 0.2298 0.0485 0.1373 0.3297   1 ## [2,]   7   2 0.1967 0.0461 0.1072 0.2883   1 ## [3,]   4   3 0.1916 0.0649 0.0840 0.3414   1 ## [4,]  13   8 0.2002 0.0417 0.1191 0.2837   1 ## [5,]  10   9 0.1939 0.0705 0.0583 0.3293   1 ## [6,]  16  15 0.1890 0.0743 0.0462 0.3248   1 summary(m1,what='thd') ##          [,1]    [,2]   [,3] ##  [1,] -1.5481 -0.0169 1.5362 ##  [2,] -1.4707 -0.0202 1.5870 ##  [3,] -1.5306  0.0274 1.5410 ##  [4,] -1.6467  0.0209 1.5355 ##  [5,] -1.5333 -0.0363 1.4573 ##  [6,] -1.5638 -0.0219 1.5392 ##  [7,] -1.5129 -0.0077 1.5872 ##  [8,] -1.5810 -0.0442 1.4556 ##  [9,] -1.6115 -0.0061 1.6081 ## [10,] -1.6479 -0.0212 1.5501 ## [11,] -1.4545 -0.0385 1.4659 ## [12,] -1.4504 -0.0612 1.5905 ## [13,] -1.5193 -0.0064 1.5701 ## [14,] -1.4234 -0.0249 1.4884 ## [15,] -1.5135 -0.0521 1.4970 ## [16,] -1.5519 -0.0201 1.4865 ## [17,] -1.5281 -0.0204 1.5393 ## [18,] -1.4973 -0.0386 1.4489 Q<-summary(m1, what=\"qlambda\") Q[Q!=0]<-1 Q ##     1 2 3 ## I1  1 0 0 ## I2  1 0 0 ## I3  1 0 0 ## I4  1 0 0 ## I5  1 1 0 ## I6  1 1 0 ## I7  0 1 0 ## I8  0 1 0 ## I9  0 1 0 ## I10 0 1 0 ## I11 0 1 1 ## I12 0 1 1 ## I13 0 0 1 ## I14 0 0 1 ## I15 0 0 1 ## I16 0 0 1 ## I17 1 0 1 ## I18 1 0 1 m2 <- pcfa(dat = dat, Q = Q, cati = -1,burn = 5000, iter = 5000) summary(m2) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 10.15556 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     0.9999     1.0004 ## [2,]     1.0226     1.0925 ## [3,]     1.0118     1.0118 ##  ## $`No. of sig LD terms` ## [1] 6 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 3837.865 4053.762 3082.027 ##  ## $Time ##    user  system elapsed  ##  260.36   48.14  310.08 summary(m2, what = 'qlambda') ##          1      2      3 ## I1  0.6868 0.0000 0.0000 ## I2  0.7149 0.0000 0.0000 ## I3  0.7259 0.0000 0.0000 ## I4  0.7261 0.0000 0.0000 ## I5  0.7030 0.2744 0.0000 ## I6  0.6775 0.2868 0.0000 ## I7  0.0000 0.6958 0.0000 ## I8  0.0000 0.7012 0.0000 ## I9  0.0000 0.7566 0.0000 ## I10 0.0000 0.7550 0.0000 ## I11 0.0000 0.6467 0.3948 ## I12 0.0000 0.6724 0.3567 ## I13 0.0000 0.0000 0.6934 ## I14 0.0000 0.0000 0.6984 ## I15 0.0000 0.0000 0.7650 ## I16 0.0000 0.0000 0.7498 ## I17 0.3187 0.0000 0.6888 ## I18 0.2408 0.0000 0.7205 summary(m2,what='eigen') ##       est     sd  lower  upper sig ## F1 3.1686 0.2157 2.7597 3.6062   1 ## F2 3.1622 0.1865 2.8028 3.5308   1 ## F3 3.4081 0.2017 3.0128 3.8007   1 summary(m2, what = 'offpsx') ##      row col    est     sd  lower  upper sig ## [1,]  14   1 0.2662 0.0362 0.1935 0.3354   1 ## [2,]   7   2 0.2279 0.0368 0.1591 0.3017   1 ## [3,]   4   3 0.1939 0.0606 0.0811 0.3107   1 ## [4,]  13   8 0.2173 0.0359 0.1471 0.2862   1 ## [5,]  10   9 0.1768 0.0493 0.0838 0.2780   1 ## [6,]  16  15 0.1958 0.0500 0.0965 0.2906   1 summary(m2,what='thd') ##          [,1]    [,2]   [,3] ##  [1,] -1.5487 -0.0057 1.5504 ##  [2,] -1.4580 -0.0111 1.6059 ##  [3,] -1.5197  0.0359 1.5563 ##  [4,] -1.6426  0.0321 1.5525 ##  [5,] -1.5292 -0.0240 1.4794 ##  [6,] -1.5455 -0.0083 1.5423 ##  [7,] -1.5052 -0.0044 1.5769 ##  [8,] -1.5690 -0.0423 1.4425 ##  [9,] -1.6117 -0.0013 1.6046 ## [10,] -1.6249 -0.0165 1.5503 ## [11,] -1.4469 -0.0312 1.4732 ## [12,] -1.4453 -0.0542 1.6037 ## [13,] -1.5088 -0.0040 1.5699 ## [14,] -1.4217 -0.0207 1.5002 ## [15,] -1.4990 -0.0420 1.5054 ## [16,] -1.5506 -0.0140 1.4988 ## [17,] -1.5112 -0.0103 1.5572 ## [18,] -1.4811 -0.0254 1.4605"},{"path":"/articles/Examples/gpcfa-examples.html","id":"mixed-type-data-with-missingness-and-local-dependence","dir":"Articles > Examples","previous_headings":"","what":"Mixed-type Data with Missingness and Local Dependence:","title":"gpcfa-examples","text":"Obtain data check true loading pattern (qlam) local dependence. E-step: Estimate GPCFA-LI model (E-step) setting LD=FALSE design matrix Q. loadings need specified Q (e.g., 2 per factor). first 6 items categorical need specified cati.    C-step: Reconfigure Q matrix C-step one specified loading per item based results E-step. Estimate GPCFA model setting LD=TRUE (default). estimates accurate, LD terms can largely recovered. CFA-LD: Configure Q matrix mix CFA CCFA model local dependence (.e. without unspecified loading) based results C-step. Results better , similar C-step.","code":"dat <- sim18mcfa41$dat summary(dat) #10% missingness at random ##        V1              V2              V3              V4        ##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   1st Qu.:2.000   ##  Median :3.000   Median :3.000   Median :2.000   Median :2.000   ##  Mean   :2.505   Mean   :2.497   Mean   :2.496   Mean   :2.506   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.:3.000   ##  Max.   :4.000   Max.   :4.000   Max.   :4.000   Max.   :4.000   ##  NA's   :84      NA's   :101     NA's   :104     NA's   :95      ##        V5              V6              V7                 V8           ##  Min.   :1.000   Min.   :1.000   Min.   :-2.81026   Min.   :-3.23753   ##  1st Qu.:2.000   1st Qu.:2.000   1st Qu.:-0.71029   1st Qu.:-0.62884   ##  Median :3.000   Median :3.000   Median :-0.00391   Median : 0.04407   ##  Mean   :2.524   Mean   :2.515   Mean   :-0.01609   Mean   : 0.05464   ##  3rd Qu.:3.000   3rd Qu.:3.000   3rd Qu.: 0.64606   3rd Qu.: 0.76442   ##  Max.   :4.000   Max.   :4.000   Max.   : 2.70247   Max.   : 2.89557   ##  NA's   :84      NA's   :104     NA's   :85         NA's   :94         ##        V9                V10                V11                V12           ##  Min.   :-3.30561   Min.   :-3.02592   Min.   :-3.41374   Min.   :-2.82342   ##  1st Qu.:-0.66089   1st Qu.:-0.61385   1st Qu.:-0.63676   1st Qu.:-0.67127   ##  Median :-0.00165   Median : 0.01598   Median : 0.01521   Median : 0.04094   ##  Mean   : 0.00834   Mean   : 0.02074   Mean   : 0.00846   Mean   : 0.01327   ##  3rd Qu.: 0.68991   3rd Qu.: 0.69146   3rd Qu.: 0.70011   3rd Qu.: 0.69313   ##  Max.   : 3.29942   Max.   : 3.03966   Max.   : 3.24879   Max.   : 3.37976   ##  NA's   :112        NA's   :125        NA's   :105        NA's   :96         ##       V13                V14                V15                V16           ##  Min.   :-2.91486   Min.   :-3.35077   Min.   :-3.79077   Min.   :-2.98539   ##  1st Qu.:-0.63790   1st Qu.:-0.68802   1st Qu.:-0.59432   1st Qu.:-0.65737   ##  Median : 0.01362   Median : 0.04734   Median : 0.07327   Median : 0.03254   ##  Mean   : 0.01722   Mean   : 0.00211   Mean   : 0.04284   Mean   : 0.01089   ##  3rd Qu.: 0.69528   3rd Qu.: 0.67515   3rd Qu.: 0.73561   3rd Qu.: 0.69205   ##  Max.   : 3.44561   Max.   : 2.93371   Max.   : 3.35474   Max.   : 3.16500   ##  NA's   :118        NA's   :86         NA's   :116        NA's   :89         ##       V17                V18           ##  Min.   :-2.72783   Min.   :-2.98409   ##  1st Qu.:-0.64767   1st Qu.:-0.68150   ##  Median : 0.02905   Median : 0.06052   ##  Mean   : 0.00466   Mean   : 0.03421   ##  3rd Qu.: 0.63216   3rd Qu.: 0.71505   ##  Max.   : 3.28462   Max.   : 3.06039   ##  NA's   :120        NA's   :110 J <- ncol(dat) # no. of items K <- 3 # no. of factors sim18mcfa41$qlam ##       [,1] [,2] [,3] ##  [1,]  0.7  0.0  0.0 ##  [2,]  0.7  0.0  0.0 ##  [3,]  0.7  0.0  0.0 ##  [4,]  0.7  0.0  0.0 ##  [5,]  0.7  0.3  0.0 ##  [6,]  0.7  0.3  0.0 ##  [7,]  0.0  0.7  0.0 ##  [8,]  0.0  0.7  0.0 ##  [9,]  0.0  0.7  0.0 ## [10,]  0.0  0.7  0.0 ## [11,]  0.0  0.7  0.3 ## [12,]  0.0  0.7  0.3 ## [13,]  0.0  0.0  0.7 ## [14,]  0.0  0.0  0.7 ## [15,]  0.0  0.0  0.7 ## [16,]  0.0  0.0  0.7 ## [17,]  0.3  0.0  0.7 ## [18,]  0.3  0.0  0.7 sim18mcfa41$LD # effect size = .3 ##      row col ## [1,]  14   1 ## [2,]   7   2 ## [3,]   4   3 ## [4,]  13   8 ## [5,]  10   9 ## [6,]  16  15 Q<-matrix(-1,J,K); # -1 for unspecified items Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1 # 1 for specified items Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]   -1   -1   -1 ##  [4,]   -1   -1   -1 ##  [5,]   -1   -1   -1 ##  [6,]   -1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1   -1   -1 ## [10,]   -1   -1   -1 ## [11,]   -1   -1   -1 ## [12,]   -1   -1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1   -1 ## [16,]   -1   -1   -1 ## [17,]   -1   -1   -1 ## [18,]   -1   -1   -1 m0 <- pcfa(dat = dat, Q = Q,LD = FALSE, cati = c(1:6),burn = 5000, iter = 5000) summary(m0) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 10.15556 ##  ## $`LD Allowed` ## [1] FALSE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.1481     1.4378 ## [2,]     1.0588     1.2261 ## [3,]     1.0571     1.1682 ##  ## $`Cat Items` ## [1] 1 2 3 4 5 6 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 3875.109 2565.383 2197.301 ##  ## $Time ##    user  system elapsed  ##  129.00   33.13  162.34 summary(m0, what = 'qlambda') ##          1      2      3 ## I1  0.6876 0.0000 0.0000 ## I2  0.7572 0.0000 0.0000 ## I3  0.8128 0.0000 0.0000 ## I4  0.8082 0.0000 0.0000 ## I5  0.6787 0.2801 0.0000 ## I6  0.6383 0.2853 0.0000 ## I7  0.0000 0.6618 0.0000 ## I8  0.0000 0.6822 0.0000 ## I9  0.0000 0.8713 0.0000 ## I10 0.0000 0.8685 0.0000 ## I11 0.0000 0.6839 0.2978 ## I12 0.0000 0.6821 0.2826 ## I13 0.0000 0.0000 0.6637 ## I14 0.0000 0.0000 0.6640 ## I15 0.0000 0.0000 0.8562 ## I16 0.0000 0.0000 0.8737 ## I17 0.2816 0.0000 0.6517 ## I18 0.2267 0.0000 0.6745 summary(m0,what='eigen') ##       est     sd  lower  upper sig ## F1 3.5173 0.5809 2.6630 4.6969   1 ## F2 3.6563 0.5120 2.7873 4.7220   1 ## F3 3.5761 0.4549 2.7268 4.4855   1 summary(m0,what='thd') # only for 12 items ##         [,1]    [,2]   [,3] ## [1,] -1.5116 -0.0136 1.5195 ## [2,] -1.4373 -0.0177 1.5803 ## [3,] -1.5156  0.0281 1.5275 ## [4,] -1.6250  0.0245 1.5176 ## [5,] -1.5312 -0.0392 1.4713 ## [6,] -1.5594 -0.0179 1.5400 plot_lawbl(m0) # trace plot_lawbl(m0, what='density') plot_lawbl(m0, what='EPSR') #EPSR Q<-matrix(-1,J,K); tmp<-summary(m0, what=\"qlambda\") cind<-apply(tmp,1,which.max) Q[cbind(c(1:J),cind)]<-1 Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]    1   -1   -1 ##  [4,]    1   -1   -1 ##  [5,]    1   -1   -1 ##  [6,]    1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1    1   -1 ## [10,]   -1    1   -1 ## [11,]   -1    1   -1 ## [12,]   -1    1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1    1 ## [16,]   -1   -1    1 ## [17,]   -1   -1    1 ## [18,]   -1   -1    1 m1 <- pcfa(dat = dat, Q = Q, cati = c(1:6),burn = 5000, iter = 5000) summary(m1) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 10.15556 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0014     1.0018 ## [2,]     1.0160     1.0737 ## [3,]     1.0069     1.0344 ##  ## $`No. of sig LD terms` ## [1] 6 ##  ## $`Cat Items` ## [1] 1 2 3 4 5 6 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 3598.992 3455.159 2336.191 ##  ## $Time ##    user  system elapsed  ##  185.97   26.87  213.67 summary(m1, what = 'qlambda') ##          1      2      3 ## I1  0.7066 0.0000 0.0000 ## I2  0.7088 0.0000 0.0000 ## I3  0.7555 0.0000 0.0000 ## I4  0.7599 0.0000 0.0000 ## I5  0.7038 0.2372 0.0000 ## I6  0.6854 0.2493 0.0000 ## I7  0.0000 0.6944 0.0000 ## I8  0.0000 0.6916 0.0000 ## I9  0.0000 0.7420 0.0000 ## I10 0.0000 0.7357 0.0000 ## I11 0.0000 0.6813 0.3079 ## I12 0.0000 0.7045 0.2768 ## I13 0.0000 0.0000 0.7112 ## I14 0.0000 0.0000 0.6745 ## I15 0.0000 0.0000 0.7393 ## I16 0.0000 0.0000 0.7509 ## I17 0.2593 0.0000 0.6897 ## I18 0.2022 0.0000 0.7185 summary(m1,what='eigen') ##       est     sd  lower  upper sig ## F1 3.3038 0.2860 2.7999 3.8838   1 ## F2 3.2225 0.2984 2.6530 3.8015   1 ## F3 3.3168 0.3385 2.6656 3.9809   1 summary(m1, what = 'offpsx') ##      row col    est     sd  lower  upper sig ## [1,]  14   1 0.2651 0.0455 0.1782 0.3575   1 ## [2,]   7   2 0.2406 0.0501 0.1383 0.3371   1 ## [3,]   4   3 0.1705 0.0655 0.0378 0.2954   1 ## [4,]  13   8 0.2391 0.0419 0.1626 0.3244   1 ## [5,]  10   9 0.2517 0.0612 0.1305 0.3687   1 ## [6,]  16  15 0.2387 0.0568 0.1218 0.3378   1 summary(m1,what='thd') ##         [,1]    [,2]   [,3] ## [1,] -1.5341 -0.0186 1.5166 ## [2,] -1.4704 -0.0244 1.5781 ## [3,] -1.5264  0.0223 1.5391 ## [4,] -1.6330  0.0191 1.5240 ## [5,] -1.5267 -0.0365 1.4651 ## [6,] -1.5480 -0.0243 1.5299 Q<-summary(m1, what=\"qlambda\") Q[Q!=0]<-1 Q ##     1 2 3 ## I1  1 0 0 ## I2  1 0 0 ## I3  1 0 0 ## I4  1 0 0 ## I5  1 1 0 ## I6  1 1 0 ## I7  0 1 0 ## I8  0 1 0 ## I9  0 1 0 ## I10 0 1 0 ## I11 0 1 1 ## I12 0 1 1 ## I13 0 0 1 ## I14 0 0 1 ## I15 0 0 1 ## I16 0 0 1 ## I17 1 0 1 ## I18 1 0 1 m2 <- pcfa(dat = dat, Q = Q, cati = c(1:6),burn = 5000, iter = 5000) summary(m2) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 10.15556 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0129     1.0174 ## [2,]     1.0100     1.0438 ## [3,]     1.0181     1.0578 ##  ## $`No. of sig LD terms` ## [1] 6 ##  ## $`Cat Items` ## [1] 1 2 3 4 5 6 ##  ## $`max No. of categories` ## [1] 4 ##  ## $`DIC, BIC, AIC` ## [1] 3316.863 2617.938 1646.202 ##  ## $Time ##    user  system elapsed  ##  153.85   14.26  168.48 summary(m2, what = 'qlambda') ##          1      2      3 ## I1  0.6837 0.0000 0.0000 ## I2  0.7024 0.0000 0.0000 ## I3  0.7379 0.0000 0.0000 ## I4  0.7342 0.0000 0.0000 ## I5  0.6921 0.2838 0.0000 ## I6  0.6792 0.2919 0.0000 ## I7  0.0000 0.6970 0.0000 ## I8  0.0000 0.7018 0.0000 ## I9  0.0000 0.7336 0.0000 ## I10 0.0000 0.7529 0.0000 ## I11 0.0000 0.6666 0.3383 ## I12 0.0000 0.6929 0.3096 ## I13 0.0000 0.0000 0.7030 ## I14 0.0000 0.0000 0.6693 ## I15 0.0000 0.0000 0.7628 ## I16 0.0000 0.0000 0.7660 ## I17 0.3063 0.0000 0.6879 ## I18 0.2502 0.0000 0.7082 summary(m2,what='eigen') ##       est     sd  lower  upper sig ## F1 3.1570 0.1883 2.7964 3.5213   1 ## F2 3.1866 0.1807 2.8363 3.5337   1 ## F3 3.3083 0.1863 2.9527 3.6702   1 summary(m2, what = 'offpsx') ##      row col    est     sd  lower  upper sig ## [1,]  14   1 0.2931 0.0347 0.2264 0.3607   1 ## [2,]   7   2 0.2774 0.0321 0.2166 0.3424   1 ## [3,]   4   3 0.1791 0.0543 0.0649 0.2770   1 ## [4,]  13   8 0.2508 0.0307 0.1943 0.3160   1 ## [5,]  10   9 0.2330 0.0505 0.1378 0.3277   1 ## [6,]  16  15 0.2114 0.0488 0.1181 0.3022   1 summary(m2,what='thd') ##         [,1]    [,2]   [,3] ## [1,] -1.5324 -0.0136 1.5230 ## [2,] -1.4692 -0.0213 1.5880 ## [3,] -1.5265  0.0306 1.5477 ## [4,] -1.6268  0.0222 1.5286 ## [5,] -1.5233 -0.0347 1.4636 ## [6,] -1.5557 -0.0227 1.5423"},{"path":"/articles/Examples/pcfa-examples.html","id":"continuous-data-wo-local-dependence","dir":"Articles > Examples","previous_headings":"","what":"Continuous Data w/o Local Dependence:","title":"pcfa-examples","text":"Load package, obtain data, check true loading pattern (qlam) local dependence. E-step: Estimate PCFA-LI model (E-step) setting LD=F design matrix Q. loadings need specified Q (e.g., 2 per factor). Longer chain suggested stabler performance (burn=iter=5,000 default).    C-step: Reconfigure Q matrix C-step one specified loading per item based results E-step. Estimate PCFA model setting LD=TRUE (default). Longer chain suggested stabler performance. Results close E-step, since ’s LD data.    CFA-LD: One can also configure Q matrix CFA model local dependence (.e. without unspecified loading) based results C-step. Results also close.","code":"library(LAWBL) ## LAWBL Package (version 1.5.0; 2022-05-13) ## For tutorials, see https://jinsong-chen.github.io/LAWBL/ dat <- sim18cfa0$dat J <- ncol(dat) # no. of items K <- 3 # no. of factors sim18cfa0$qlam ##       [,1] [,2] [,3] ##  [1,]  0.7  0.0  0.0 ##  [2,]  0.7  0.0  0.0 ##  [3,]  0.7  0.0  0.0 ##  [4,]  0.7  0.0  0.0 ##  [5,]  0.7  0.3  0.0 ##  [6,]  0.7  0.3  0.0 ##  [7,]  0.0  0.7  0.0 ##  [8,]  0.0  0.7  0.0 ##  [9,]  0.0  0.7  0.0 ## [10,]  0.0  0.7  0.0 ## [11,]  0.0  0.7  0.3 ## [12,]  0.0  0.7  0.3 ## [13,]  0.0  0.0  0.7 ## [14,]  0.0  0.0  0.7 ## [15,]  0.0  0.0  0.7 ## [16,]  0.0  0.0  0.7 ## [17,]  0.3  0.0  0.7 ## [18,]  0.3  0.0  0.7 sim18cfa0$LD ##      row col Q<-matrix(-1,J,K); # -1 for unspecified items Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1 # 1 for specified items Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]   -1   -1   -1 ##  [4,]   -1   -1   -1 ##  [5,]   -1   -1   -1 ##  [6,]   -1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1   -1   -1 ## [10,]   -1   -1   -1 ## [11,]   -1   -1   -1 ## [12,]   -1   -1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1   -1 ## [16,]   -1   -1   -1 ## [17,]   -1   -1   -1 ## [18,]   -1   -1   -1 m0 <- pcfa(dat = dat, Q = Q,LD = FALSE)  # summarize basic information summary(m0) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] FALSE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0624     1.0667 ## [2,]     1.0780     1.0824 ## [3,]     1.0324     1.1183 ##  ## $`DIC, BIC, AIC` ## [1] 4855.375 2701.101 2333.019 ##  ## $Time ##    user  system elapsed  ##   47.59    3.60   51.25 #summarize significant loadings in pattern/Q-matrix format summary(m0, what = 'qlambda') ##          1      2      3 ## I1  0.7134 0.0000 0.0000 ## I2  0.7274 0.0000 0.0000 ## I3  0.7343 0.0000 0.0000 ## I4  0.7523 0.0000 0.0000 ## I5  0.7324 0.2731 0.0000 ## I6  0.7060 0.2893 0.0000 ## I7  0.0000 0.7340 0.0000 ## I8  0.0000 0.7310 0.0000 ## I9  0.0000 0.7421 0.0000 ## I10 0.0000 0.7262 0.0000 ## I11 0.0000 0.7115 0.2661 ## I12 0.0000 0.7021 0.2487 ## I13 0.0000 0.0000 0.7028 ## I14 0.0000 0.0000 0.6825 ## I15 0.0000 0.0000 0.7151 ## I16 0.0000 0.0000 0.7147 ## I17 0.2909 0.0000 0.6870 ## I18 0.2787 0.0000 0.6920 #factorial eigenvalue summary(m0,what='eigen') ##       est     sd  lower  upper sig ## F1 3.4409 0.5717 2.5379 4.7755   1 ## F2 3.4564 0.4431 2.7413 4.4195   1 ## F3 3.1777 0.4515 2.3685 4.0800   1 #plotting factorial eigenvalue plot_lawbl(m0) # trace plot_lawbl(m0, what='density') #density plot_lawbl(m0, what='EPSR') #EPSR Q<-matrix(-1,J,K); tmp<-summary(m0, what=\"qlambda\") cind<-apply(tmp,1,which.max) Q[cbind(c(1:J),cind)]<-1 #alternatively #Q[1:6,1]<-Q[7:12,2]<-Q[13:18,3]<-1 # 1 for specified items  m1 <- pcfa(dat = dat, Q = Q) summary(m1) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0180     1.0589 ## [2,]     1.0253     1.0897 ## [3,]     1.0008     1.0009 ##  ## $`No. of sig LD terms` ## [1] 0 ##  ## $`DIC, BIC, AIC` ## [1] 5323.362 4298.661 3179.693 ##  ## $Time ##    user  system elapsed  ##  123.67    8.46  132.22 summary(m1, what = 'qlambda') ##          1      2      3 ## I1  0.6787 0.0000 0.0000 ## I2  0.7055 0.0000 0.0000 ## I3  0.7096 0.0000 0.0000 ## I4  0.7309 0.0000 0.0000 ## I5  0.7080 0.2743 0.0000 ## I6  0.6785 0.2920 0.0000 ## I7  0.0000 0.7332 0.0000 ## I8  0.0000 0.7218 0.0000 ## I9  0.0000 0.7379 0.0000 ## I10 0.0000 0.7240 0.0000 ## I11 0.0000 0.7099 0.2376 ## I12 0.0000 0.7052 0.2253 ## I13 0.0000 0.0000 0.6985 ## I14 0.0000 0.0000 0.6740 ## I15 0.0000 0.0000 0.7154 ## I16 0.0000 0.0000 0.7082 ## I17 0.2479 0.0000 0.6910 ## I18 0.2345 0.0000 0.6977 summary(m1, what = 'offpsx') #summarize significant LD terms ##      row col est sd lower upper sig summary(m1,what='eigen') ##       est     sd  lower  upper sig ## F1 3.1446 0.2822 2.6145 3.7453   1 ## F2 3.3541 0.2975 2.8197 3.9469   1 ## F3 3.1052 0.2789 2.6008 3.6856   1 #plotting factorial eigenvalue # par(mar = rep(2, 4)) plot_lawbl(m1) # trace plot_lawbl(m1, what='density') #density plot_lawbl(m1, what='EPSR') #EPSR Q<-summary(m1, what=\"qlambda\") Q[Q!=0]<-1 Q ##     1 2 3 ## I1  1 0 0 ## I2  1 0 0 ## I3  1 0 0 ## I4  1 0 0 ## I5  1 1 0 ## I6  1 1 0 ## I7  0 1 0 ## I8  0 1 0 ## I9  0 1 0 ## I10 0 1 0 ## I11 0 1 1 ## I12 0 1 1 ## I13 0 0 1 ## I14 0 0 1 ## I15 0 0 1 ## I16 0 0 1 ## I17 1 0 1 ## I18 1 0 1 m2 <- pcfa(dat = dat, Q = Q) summary(m2) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0081     1.0153 ## [2,]     1.0122     1.0583 ## [3,]     1.0057     1.0203 ##  ## $`No. of sig LD terms` ## [1] 0 ##  ## $`DIC, BIC, AIC` ## [1] 5122.965 3670.614 2698.878 ##  ## $Time ##    user  system elapsed  ##   93.88    7.67  101.93 summary(m2, what = 'qlambda') ##          1      2      3 ## I1  0.6829 0.0000 0.0000 ## I2  0.6974 0.0000 0.0000 ## I3  0.7117 0.0000 0.0000 ## I4  0.7103 0.0000 0.0000 ## I5  0.6830 0.3292 0.0000 ## I6  0.6707 0.3427 0.0000 ## I7  0.0000 0.7294 0.0000 ## I8  0.0000 0.7251 0.0000 ## I9  0.0000 0.7245 0.0000 ## I10 0.0000 0.6925 0.0000 ## I11 0.0000 0.6935 0.2903 ## I12 0.0000 0.6907 0.2914 ## I13 0.0000 0.0000 0.6747 ## I14 0.0000 0.0000 0.6791 ## I15 0.0000 0.0000 0.7174 ## I16 0.0000 0.0000 0.6660 ## I17 0.3112 0.0000 0.6787 ## I18 0.2866 0.0000 0.6812 summary(m2, what = 'offpsx') ##      row col est sd lower upper sig summary(m2,what='eigen') ##       est     sd  lower  upper sig ## F1 3.0682 0.1615 2.7644 3.3982   1 ## F2 3.2549 0.1830 2.9039 3.6055   1 ## F3 2.9784 0.1751 2.6335 3.3177   1 plot_lawbl(m2) # Eigens' traces are excellent without regularization of the loadings"},{"path":"/articles/Examples/pcfa-examples.html","id":"continuous-data-with-local-dependence","dir":"Articles > Examples","previous_headings":"","what":"Continuous Data with Local Dependence:","title":"pcfa-examples","text":"Obtain data check true loading pattern (qlam) local dependence. E-step: Estimate PCFA-LI model (E-step) setting LD=FALSE design matrix Q. loadings need specified Q (e.g., 2 per factor). loading estimates biased due ignoring LD. eigenvalues.   C-step: Reconfigure Q matrix C-step one specified loading per item based results E-step. Estimate PCFA model setting LD=TRUE (default). estimates accurate, LD terms can largely recovered. CFA-LD: Configure Q matrix CFA model local dependence (.e. without unspecified loading) based results C-step. Results better , similar C-step.","code":"dat <- sim18cfa1$dat J <- ncol(dat) # no. of items K <- 3 # no. of factors sim18cfa1$qlam ##       [,1] [,2] [,3] ##  [1,]  0.7  0.0  0.0 ##  [2,]  0.7  0.0  0.0 ##  [3,]  0.7  0.0  0.0 ##  [4,]  0.7  0.0  0.0 ##  [5,]  0.7  0.3  0.0 ##  [6,]  0.7  0.3  0.0 ##  [7,]  0.0  0.7  0.0 ##  [8,]  0.0  0.7  0.0 ##  [9,]  0.0  0.7  0.0 ## [10,]  0.0  0.7  0.0 ## [11,]  0.0  0.7  0.3 ## [12,]  0.0  0.7  0.3 ## [13,]  0.0  0.0  0.7 ## [14,]  0.0  0.0  0.7 ## [15,]  0.0  0.0  0.7 ## [16,]  0.0  0.0  0.7 ## [17,]  0.3  0.0  0.7 ## [18,]  0.3  0.0  0.7 sim18cfa1$LD # effect size = .3 ##      row col ## [1,]  14   1 ## [2,]   7   2 ## [3,]   4   3 ## [4,]  13   8 ## [5,]  10   9 ## [6,]  16  15 Q<-matrix(-1,J,K); # -1 for unspecified items Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1 # 1 for specified items Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]   -1   -1   -1 ##  [4,]   -1   -1   -1 ##  [5,]   -1   -1   -1 ##  [6,]   -1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1   -1   -1 ## [10,]   -1   -1   -1 ## [11,]   -1   -1   -1 ## [12,]   -1   -1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1   -1 ## [16,]   -1   -1   -1 ## [17,]   -1   -1   -1 ## [18,]   -1   -1   -1 m0 <- pcfa(dat = dat, Q = Q,LD = FALSE) summary(m0) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] FALSE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 22 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0268     1.1202 ## [2,]     1.3077     2.1823 ## [3,]     1.0682     1.2584 ##  ## $`DIC, BIC, AIC` ## [1] 3729.068 2180.126 1812.044 ##  ## $Time ##    user  system elapsed  ##   48.62    4.45   53.22 summary(m0, what = 'qlambda') ##          1      2      3 ## I1  0.6508 0.0000 0.0000 ## I2  0.6538 0.0000 0.0000 ## I3  0.8787 0.0000 0.0000 ## I4  0.8822 0.0000 0.0000 ## I5  0.6997 0.2283 0.0000 ## I6  0.6745 0.2398 0.0000 ## I7  0.0000 0.7103 0.0000 ## I8  0.0000 0.6613 0.0000 ## I9  0.0000 0.9186 0.0000 ## I10 0.0000 0.9091 0.0000 ## I11 0.0000 0.6889 0.0000 ## I12 0.0000 0.7078 0.0000 ## I13 0.0000 0.0000 0.6723 ## I14 0.0000 0.0000 0.6606 ## I15 0.0000 0.0000 0.7828 ## I16 0.0000 0.0000 0.7876 ## I17 0.3045 0.0000 0.6567 ## I18 0.2978 0.0000 0.6622 summary(m0,what='eigen') ##       est     sd  lower  upper sig ## F1 3.6387 0.4013 2.8974 4.4469   1 ## F2 3.7860 0.4673 2.9911 4.6466   1 ## F3 3.3188 0.4206 2.5796 4.2597   1 plot_lawbl(m0) # trace plot_lawbl(m0, what='EPSR') #EPSR Q<-matrix(-1,J,K); tmp<-summary(m0, what=\"qlambda\") cind<-apply(tmp,1,which.max) Q[cbind(c(1:J),cind)]<-1 Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]    1   -1   -1 ##  [4,]    1   -1   -1 ##  [5,]    1   -1   -1 ##  [6,]    1   -1   -1 ##  [7,]   -1    1   -1 ##  [8,]   -1    1   -1 ##  [9,]   -1    1   -1 ## [10,]   -1    1   -1 ## [11,]   -1    1   -1 ## [12,]   -1    1   -1 ## [13,]   -1   -1    1 ## [14,]   -1   -1    1 ## [15,]   -1   -1    1 ## [16,]   -1   -1    1 ## [17,]   -1   -1    1 ## [18,]   -1   -1    1 m1 <- pcfa(dat = dat, Q = Q) summary(m1) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 22 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0230     1.0636 ## [2,]     1.0309     1.1124 ## [3,]     1.2228     1.7416 ##  ## $`No. of sig LD terms` ## [1] 6 ##  ## $`DIC, BIC, AIC` ## [1] 3670.479 2706.037 1587.069 ##  ## $Time ##    user  system elapsed  ##  120.57   11.51  132.48 summary(m1, what = 'qlambda') ##          1      2      3 ## I1  0.6915 0.0000 0.0000 ## I2  0.6730 0.0000 0.0000 ## I3  0.7588 0.0000 0.0000 ## I4  0.7633 0.0000 0.0000 ## I5  0.7623 0.0000 0.0000 ## I6  0.7309 0.0000 0.0000 ## I7  0.0000 0.7467 0.0000 ## I8  0.0000 0.6745 0.0000 ## I9  0.0000 0.7462 0.0000 ## I10 0.0000 0.7270 0.0000 ## I11 0.0000 0.7184 0.2125 ## I12 0.0000 0.7324 0.2005 ## I13 0.0000 0.0000 0.7128 ## I14 0.0000 0.0000 0.6762 ## I15 0.0000 0.0000 0.7225 ## I16 0.0000 0.0000 0.7213 ## I17 0.2542 0.0000 0.7095 ## I18 0.2385 0.0000 0.7155 summary(m1,what='eigen') ##       est     sd  lower  upper sig ## F1 3.4266 0.3704 2.7396 4.2256   1 ## F2 3.3057 0.3302 2.6959 3.9784   1 ## F3 3.2109 0.3410 2.6139 3.9488   1 summary(m1, what = 'offpsx') ##      row col    est     sd  lower  upper sig ## [1,]  14   1 0.2918 0.0479 0.1996 0.3825   1 ## [2,]   7   2 0.2569 0.0480 0.1648 0.3496   1 ## [3,]   4   3 0.2661 0.0683 0.1246 0.3898   1 ## [4,]  13   8 0.2799 0.0451 0.1976 0.3783   1 ## [5,]  10   9 0.2971 0.0665 0.1525 0.4270   1 ## [6,]  16  15 0.2688 0.0704 0.1258 0.3978   1 Q<-summary(m1, what=\"qlambda\") Q[Q!=0]<-1 Q ##     1 2 3 ## I1  1 0 0 ## I2  1 0 0 ## I3  1 0 0 ## I4  1 0 0 ## I5  1 0 0 ## I6  1 0 0 ## I7  0 1 0 ## I8  0 1 0 ## I9  0 1 0 ## I10 0 1 0 ## I11 0 1 1 ## I12 0 1 1 ## I13 0 0 1 ## I14 0 0 1 ## I15 0 0 1 ## I16 0 0 1 ## I17 1 0 1 ## I18 1 0 1 m2 <- pcfa(dat = dat, Q = Q) summary(m2) ## $NJK ## [1] 1000   18    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 22 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0222     1.1003 ## [2,]     1.2677     1.9349 ## [3,]     1.0009     1.0028 ##  ## $`No. of sig LD terms` ## [1] 26 ##  ## $`DIC, BIC, AIC` ## [1] 4851.891 3231.894 2269.974 ##  ## $Time ##    user  system elapsed  ##   94.25    8.77  103.23 summary(m2, what = 'qlambda') ##          1      2      3 ## I1  0.6514 0.0000 0.0000 ## I2  0.6837 0.0000 0.0000 ## I3  0.7026 0.0000 0.0000 ## I4  0.6882 0.0000 0.0000 ## I5  0.8461 0.0000 0.0000 ## I6  0.8415 0.0000 0.0000 ## I7  0.0000 0.6948 0.0000 ## I8  0.0000 0.6235 0.0000 ## I9  0.0000 0.6198 0.0000 ## I10 0.0000 0.5916 0.0000 ## I11 0.0000 0.6317 0.2934 ## I12 0.0000 0.6082 0.2875 ## I13 0.0000 0.0000 0.6595 ## I14 0.0000 0.0000 0.6769 ## I15 0.0000 0.0000 0.7223 ## I16 0.0000 0.0000 0.7395 ## I17 0.3054 0.0000 0.6916 ## I18 0.2926 0.0000 0.6915 summary(m2,what='eigen') ##       est     sd  lower  upper sig ## F1 3.4757 0.2171 3.0650 3.9089   1 ## F2 2.3975 0.3131 1.7467 2.9940   1 ## F3 3.1007 0.1769 2.7689 3.4376   1 summary(m2, what = 'offpsx') ##       row col     est     sd   lower   upper sig ##  [1,]   7   1 -0.0726 0.0331 -0.1347 -0.0077   1 ##  [2,]   8   1 -0.0683 0.0333 -0.1305 -0.0017   1 ##  [3,]   9   1 -0.0845 0.0359 -0.1489 -0.0094   1 ##  [4,]  10   1 -0.0976 0.0357 -0.1624 -0.0233   1 ##  [5,]  11   1 -0.0753 0.0329 -0.1383 -0.0134   1 ##  [6,]  12   1 -0.0725 0.0333 -0.1328 -0.0027   1 ##  [7,]  14   1  0.2992 0.0305  0.2432  0.3603   1 ##  [8,]   7   2  0.2045 0.0408  0.1245  0.2854   1 ##  [9,]  11   2 -0.0881 0.0359 -0.1559 -0.0191   1 ## [10,]  12   2 -0.0766 0.0375 -0.1481 -0.0010   1 ## [11,]   4   3  0.3159 0.0581  0.1976  0.4252   1 ## [12,]   7   3 -0.0869 0.0326 -0.1504 -0.0197   1 ## [13,]  12   3 -0.0887 0.0327 -0.1529 -0.0245   1 ## [14,]   7   4 -0.0791 0.0331 -0.1415 -0.0098   1 ## [15,]  11   4 -0.0670 0.0322 -0.1345 -0.0072   1 ## [16,]  12   4 -0.0810 0.0326 -0.1447 -0.0153   1 ## [17,]  11   8  0.1067 0.0540  0.0110  0.2166   1 ## [18,]  12   8  0.1216 0.0590  0.0158  0.2426   1 ## [19,]  13   8  0.3333 0.0351  0.2669  0.4051   1 ## [20,]  10   9  0.4249 0.0822  0.2734  0.6082   1 ## [21,]  11   9  0.1080 0.0607  0.0114  0.2481   1 ## [22,]  12   9  0.1357 0.0676  0.0128  0.2824   1 ## [23,]  11  10  0.1071 0.0616  0.0057  0.2418   1 ## [24,]  12  10  0.1239 0.0670  0.0055  0.2700   1 ## [25,]  12  11  0.1200 0.0579  0.0206  0.2423   1 ## [26,]  16  15  0.2403 0.0620  0.1137  0.3750   1"},{"path":"/articles/Examples/pcirm-examples.html","id":"dichotomous-data-with-local-dependence-and-minor-trait","dir":"Articles > Examples","previous_headings":"","what":"Dichotomous Data with Local Dependence and Minor Trait:","title":"pcirm-examples","text":"Load package, obtain data, check true loading pattern (qlam) . factors/traits. PCIRM primary loadings three traits specified. Longer chain suggested stabler performance (burn=iter=5,000 default).    PCIRM-LI four traits two cross-loadings specified based results previous step. Longer chain suggested stabler performance. PCIRM four traits four cross-loadings specified based results previous step. Longer chain suggested stabler performance.","code":"library(LAWBL) ## LAWBL Package (version 1.5.0; 2022-05-13) ## For tutorials, see https://jinsong-chen.github.io/LAWBL/ dat <- sim24ccfa21$dat head(dat) ##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] ## [1,]    2    1    2    2    1    2    1    1    1     1     1     1     2     1 ## [2,]    1    1    1    1    1    1    1    1    1     2     1     1     1     1 ## [3,]    1    1    1    1    1    1    1    1    2     2     2     2     1     2 ## [4,]    2    2    2    1    2    2    2    2    2     1     1     1     1     1 ## [5,]    1    2    1    1    1    1    1    1    1     1     2     1     1     2 ## [6,]    1    2    1    1    1    1    2    1    2     1     1     1     2     2 ##      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] ## [1,]     1     1     2     2     1     2     2     2     1     2 ## [2,]     2     1     1     1     1     2     1     2     1     2 ## [3,]     2     2     2     2     2     2     2     1     1     2 ## [4,]     1     1     2     1     1     2     1     1     2     2 ## [5,]     1     1     1     2     1     1     1     1     1     1 ## [6,]     2     2     1     1     1     2     1     2     2     2 J <- ncol(dat) # no. of items qlam <- sim24ccfa21$qlam qlam ##       [,1] [,2] [,3] [,4] ##  [1,]  0.7  0.0  0.0 0.00 ##  [2,]  0.7  0.0  0.0 0.00 ##  [3,]  0.7  0.0  0.0 0.00 ##  [4,]  0.7  0.0  0.0 0.00 ##  [5,]  0.7  0.0  0.0 0.00 ##  [6,]  0.7  0.0  0.0 0.00 ##  [7,]  0.7  0.0  0.0 0.00 ##  [8,]  0.7  0.0  0.0 0.00 ##  [9,]  0.0  0.7  0.0 0.00 ## [10,]  0.0  0.7  0.0 0.00 ## [11,]  0.0  0.7  0.0 0.00 ## [12,]  0.0  0.7  0.0 0.00 ## [13,]  0.0  0.7  0.0 0.00 ## [14,]  0.0  0.7  0.0 0.00 ## [15,]  0.0  0.7  0.0 0.55 ## [16,]  0.0  0.7  0.0 0.55 ## [17,]  0.0  0.0  0.7 0.00 ## [18,]  0.0  0.0  0.7 0.00 ## [19,]  0.0  0.0  0.7 0.00 ## [20,]  0.0  0.0  0.7 0.00 ## [21,]  0.0  0.0  0.7 0.00 ## [22,]  0.0  0.0  0.7 0.00 ## [23,]  0.0  0.0  0.7 0.55 ## [24,]  0.0  0.0  0.7 0.55 K <- ncol(qlam) # no. of factors ipf <- 8 Q<-matrix(-1,J,K-1); # -1 for unspecified items Q[1:8,1]<-Q[9:16,2]<-Q[17:24,3]<-1 Q ##       [,1] [,2] [,3] ##  [1,]    1   -1   -1 ##  [2,]    1   -1   -1 ##  [3,]    1   -1   -1 ##  [4,]    1   -1   -1 ##  [5,]    1   -1   -1 ##  [6,]    1   -1   -1 ##  [7,]    1   -1   -1 ##  [8,]    1   -1   -1 ##  [9,]   -1    1   -1 ## [10,]   -1    1   -1 ## [11,]   -1    1   -1 ## [12,]   -1    1   -1 ## [13,]   -1    1   -1 ## [14,]   -1    1   -1 ## [15,]   -1    1   -1 ## [16,]   -1    1   -1 ## [17,]   -1   -1    1 ## [18,]   -1   -1    1 ## [19,]   -1   -1    1 ## [20,]   -1   -1    1 ## [21,]   -1   -1    1 ## [22,]   -1   -1    1 ## [23,]   -1   -1    1 ## [24,]   -1   -1    1 m0<-pcirm(dat = dat,Q=  Q,LD = TRUE,cati = -1,burn = 5000,iter = 5000) summary(m0) ## $NJK ## [1] 1000   24    3 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 24 ##  ## $Selected ## [1] TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0008     1.0010 ## [2,]     1.0036     1.0134 ## [3,]     1.0021     1.0035 ##  ## $`No. of sig LD terms` ## [1] 7 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ##  ## $`max No. of categories` ## [1] 2 ##  ## $Time ##    user  system elapsed  ##  228.03   22.64  251.41 summary(m0, what = 'qlambda') ##          1      2      3 ## I1  0.7401 0.0000 0.0000 ## I2  0.6990 0.0000 0.0000 ## I3  0.6408 0.0000 0.0000 ## I4  0.6949 0.0000 0.0000 ## I5  0.6664 0.0000 0.0000 ## I6  0.7253 0.0000 0.0000 ## I7  0.7471 0.0000 0.0000 ## I8  0.7614 0.0000 0.0000 ## I9  0.0000 0.7038 0.0000 ## I10 0.0000 0.7148 0.0000 ## I11 0.0000 0.6985 0.0000 ## I12 0.0000 0.6798 0.0000 ## I13 0.0000 0.6763 0.0000 ## I14 0.0000 0.6705 0.0000 ## I15 0.0000 0.7134 0.0000 ## I16 0.0000 0.6973 0.0000 ## I17 0.0000 0.0000 0.6831 ## I18 0.0000 0.0000 0.7243 ## I19 0.0000 0.0000 0.6882 ## I20 0.0000 0.0000 0.7259 ## I21 0.0000 0.0000 0.7107 ## I22 0.0000 0.0000 0.7003 ## I23 0.0000 0.0000 0.7083 ## I24 0.0000 0.0000 0.7604 summary(m0, what = 'offpsx') #summarize significant LD terms ##      row col    est     sd  lower  upper sig ## [1,]   8   7 0.1151 0.0422 0.0332 0.1962   1 ## [2,]  16  15 0.1556 0.0589 0.0206 0.2634   1 ## [3,]  23  15 0.1421 0.0539 0.0268 0.2473   1 ## [4,]  24  15 0.1256 0.0508 0.0193 0.2210   1 ## [5,]  23  16 0.1269 0.0527 0.0104 0.2201   1 ## [6,]  24  16 0.1170 0.0502 0.0107 0.2087   1 ## [7,]  24  23 0.1410 0.0517 0.0287 0.2344   1 summary(m0,what='int') ##         est     sd   lower  upper sig ## I1   0.0032 0.0274 -0.0517 0.0540   0 ## I2  -0.0132 0.0292 -0.0723 0.0424   0 ## I3   0.0034 0.0295 -0.0538 0.0611   0 ## I4   0.0031 0.0281 -0.0514 0.0580   0 ## I5   0.0094 0.0303 -0.0481 0.0715   0 ## I6  -0.0298 0.0281 -0.0835 0.0255   0 ## I7   0.0132 0.0276 -0.0409 0.0674   0 ## I8   0.0148 0.0273 -0.0390 0.0674   0 ## I9   0.0142 0.0283 -0.0400 0.0713   0 ## I10  0.0070 0.0283 -0.0469 0.0634   0 ## I11 -0.0122 0.0291 -0.0666 0.0467   0 ## I12 -0.0138 0.0292 -0.0705 0.0448   0 ## I13  0.0143 0.0295 -0.0451 0.0697   0 ## I14  0.0200 0.0290 -0.0325 0.0801   0 ## I15 -0.0155 0.0275 -0.0701 0.0383   0 ## I16 -0.0224 0.0280 -0.0764 0.0330   0 ## I17  0.0017 0.0288 -0.0549 0.0578   0 ## I18 -0.0189 0.0282 -0.0736 0.0368   0 ## I19  0.0058 0.0290 -0.0521 0.0606   0 ## I20 -0.0153 0.0273 -0.0681 0.0377   0 ## I21  0.0259 0.0290 -0.0300 0.0828   0 ## I22 -0.0126 0.0288 -0.0673 0.0471   0 ## I23 -0.0161 0.0276 -0.0710 0.0368   0 ## I24 -0.0056 0.0263 -0.0546 0.0471   0 summary(m0,what='eigen') ##       est     sd  lower  upper sig ## F1 4.1119 0.2879 3.5091 4.6479   1 ## F2 3.9630 0.2964 3.4071 4.5668   1 ## F3 4.1580 0.2918 3.6215 4.7397   1 #plotting factorial eigenvalue plot_lawbl(m0) # trace plot_lawbl(m0, what='density') #density plot_lawbl(m0, what='EPSR') #EPSR Q<-cbind(Q,-1); Q[c(15:16),K] <- 1  m1<-pcirm(dat = dat,Q=  Q,LD = FALSE, cati = -1,burn = 5000,iter = 5000) summary(m1) ## $NJK ## [1] 1000   24    4 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] FALSE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 28 ##  ## $Selected ## [1] TRUE TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0167     1.0265 ## [2,]     1.0025     1.0129 ## [3,]     1.0147     1.0696 ## [4,]     1.0050     1.0126 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ##  ## $`max No. of categories` ## [1] 2 ##  ## $Time ##    user  system elapsed  ##  115.90   11.33  127.55 summary(m1, what = 'qlambda') #close to qlam ##          1      2      3      4 ## I1  0.7341 0.0000 0.0000 0.0000 ## I2  0.7015 0.0000 0.0000 0.0000 ## I3  0.6375 0.0000 0.0000 0.0000 ## I4  0.6867 0.0000 0.0000 0.0000 ## I5  0.6591 0.0000 0.0000 0.0000 ## I6  0.7113 0.0000 0.0000 0.0000 ## I7  0.8232 0.0000 0.0000 0.0000 ## I8  0.8346 0.0000 0.0000 0.0000 ## I9  0.0000 0.7049 0.0000 0.0000 ## I10 0.0000 0.7381 0.0000 0.0000 ## I11 0.0000 0.7209 0.0000 0.0000 ## I12 0.0000 0.7141 0.0000 0.0000 ## I13 0.0000 0.6902 0.0000 0.0000 ## I14 0.0000 0.6970 0.0000 0.0000 ## I15 0.0000 0.6437 0.0000 0.6015 ## I16 0.0000 0.6327 0.0000 0.5646 ## I17 0.0000 0.0000 0.6956 0.0000 ## I18 0.0000 0.0000 0.7454 0.0000 ## I19 0.0000 0.0000 0.7061 0.0000 ## I20 0.0000 0.0000 0.7480 0.0000 ## I21 0.0000 0.0000 0.7221 0.0000 ## I22 0.0000 0.0000 0.7098 0.0000 ## I23 0.0000 0.0000 0.6911 0.4634 ## I24 0.0000 0.0000 0.7487 0.4215 tmp<-summary(m1, what=\"qlambda\") Q<-matrix(-1,J,K) Q[tmp!=0]<-1 Q ##       [,1] [,2] [,3] [,4] ##  [1,]    1   -1   -1   -1 ##  [2,]    1   -1   -1   -1 ##  [3,]    1   -1   -1   -1 ##  [4,]    1   -1   -1   -1 ##  [5,]    1   -1   -1   -1 ##  [6,]    1   -1   -1   -1 ##  [7,]    1   -1   -1   -1 ##  [8,]    1   -1   -1   -1 ##  [9,]   -1    1   -1   -1 ## [10,]   -1    1   -1   -1 ## [11,]   -1    1   -1   -1 ## [12,]   -1    1   -1   -1 ## [13,]   -1    1   -1   -1 ## [14,]   -1    1   -1   -1 ## [15,]   -1    1   -1    1 ## [16,]   -1    1   -1    1 ## [17,]   -1   -1    1   -1 ## [18,]   -1   -1    1   -1 ## [19,]   -1   -1    1   -1 ## [20,]   -1   -1    1   -1 ## [21,]   -1   -1    1   -1 ## [22,]   -1   -1    1   -1 ## [23,]   -1   -1    1    1 ## [24,]   -1   -1    1    1 m2<-pcirm(dat = dat,Q=  Q,LD = TRUE,cati = -1,burn = 5000,iter = 5000) summary(m2) ## $NJK ## [1] 1000   24    4 ##  ## $`Miss%` ## [1] 0 ##  ## $`LD Allowed` ## [1] TRUE ##  ## $`Burn in` ## [1] 5000 ##  ## $Iteration ## [1] 5000 ##  ## $`No. of sig lambda` ## [1] 28 ##  ## $Selected ## [1] TRUE TRUE TRUE TRUE ##  ## $`Auto, NCONV, MCONV` ## [1]  0  0 10 ##  ## $EPSR ##      Point est. Upper C.I. ## [1,]     1.0322     1.1421 ## [2,]     1.0632     1.2153 ## [3,]     1.0789     1.3066 ## [4,]     1.0231     1.0657 ##  ## $`No. of sig LD terms` ## [1] 1 ##  ## $`Cat Items` ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ##  ## $`max No. of categories` ## [1] 2 ##  ## $Time ##    user  system elapsed  ##  225.78   20.65  247.14 summary(m2, what = 'qlambda') ##          1      2      3      4 ## I1  0.7478 0.0000 0.0000 0.0000 ## I2  0.6998 0.0000 0.0000 0.0000 ## I3  0.6393 0.0000 0.0000 0.0000 ## I4  0.6822 0.0000 0.0000 0.0000 ## I5  0.6698 0.0000 0.0000 0.0000 ## I6  0.7111 0.0000 0.0000 0.0000 ## I7  0.7565 0.0000 0.0000 0.0000 ## I8  0.7651 0.0000 0.0000 0.0000 ## I9  0.0000 0.7038 0.0000 0.0000 ## I10 0.0000 0.7364 0.0000 0.0000 ## I11 0.0000 0.7004 0.0000 0.0000 ## I12 0.0000 0.7023 0.0000 0.0000 ## I13 0.0000 0.6942 0.0000 0.0000 ## I14 0.0000 0.6935 0.0000 0.0000 ## I15 0.0000 0.6388 0.0000 0.5598 ## I16 0.0000 0.6259 0.0000 0.5320 ## I17 0.0000 0.0000 0.6928 0.0000 ## I18 0.0000 0.0000 0.7265 0.0000 ## I19 0.0000 0.0000 0.7032 0.0000 ## I20 0.0000 0.0000 0.7420 0.0000 ## I21 0.0000 0.0000 0.7019 0.0000 ## I22 0.0000 0.0000 0.6972 0.0000 ## I23 0.0000 0.0000 0.6333 0.5218 ## I24 0.0000 0.0000 0.6926 0.4729 summary(m2, what = 'offpsx') #summarize significant LD terms ##    row    col    est     sd  lower  upper    sig  ## 8.0000 7.0000 0.1118 0.0411 0.0369 0.1923 1.0000 summary(m2,what='int') ##         est     sd   lower  upper sig ## I1   0.0028 0.0271 -0.0491 0.0562   0 ## I2  -0.0142 0.0283 -0.0714 0.0402   0 ## I3   0.0022 0.0300 -0.0559 0.0613   0 ## I4   0.0008 0.0287 -0.0562 0.0547   0 ## I5   0.0075 0.0293 -0.0499 0.0660   0 ## I6  -0.0300 0.0286 -0.0876 0.0235   0 ## I7   0.0135 0.0273 -0.0410 0.0664   0 ## I8   0.0144 0.0271 -0.0394 0.0662   0 ## I9   0.0133 0.0282 -0.0454 0.0654   0 ## I10  0.0049 0.0273 -0.0476 0.0599   0 ## I11 -0.0134 0.0283 -0.0670 0.0436   0 ## I12 -0.0163 0.0286 -0.0717 0.0413   0 ## I13  0.0132 0.0289 -0.0437 0.0700   0 ## I14  0.0166 0.0285 -0.0407 0.0704   0 ## I15 -0.0039 0.0211 -0.0461 0.0366   0 ## I16 -0.0115 0.0218 -0.0555 0.0306   0 ## I17  0.0013 0.0291 -0.0592 0.0562   0 ## I18 -0.0202 0.0277 -0.0727 0.0347   0 ## I19  0.0057 0.0284 -0.0500 0.0608   0 ## I20 -0.0163 0.0276 -0.0699 0.0372   0 ## I21  0.0257 0.0288 -0.0315 0.0799   0 ## I22 -0.0130 0.0286 -0.0701 0.0428   0 ## I23 -0.0050 0.0210 -0.0466 0.0361   0 ## I24  0.0035 0.0202 -0.0360 0.0425   0 summary(m2,what='eigen') ##       est     sd  lower  upper sig ## F1 4.1122 0.3008 3.5402 4.7300   1 ## F2 3.8726 0.3338 3.2357 4.5355   1 ## F3 3.9930 0.3381 3.2980 4.6429   1 ## F4 1.1977 0.1729 0.8683 1.5547   1 #plotting factorial eigenvalue plot_lawbl(m2) # trace plot_lawbl(m2, what='density') #density plot_lawbl(m2, what='EPSR') #EPSR"},{"path":"/reference/LAWBL-package.html","id":null,"dir":"Reference","previous_headings":"","what":"LAWBL: Latent (Variable) Analysis with Bayesian Learning — LAWBL-package","title":"LAWBL: Latent (Variable) Analysis with Bayesian Learning — LAWBL-package","text":"package provide variety models analyze latent variables based Bayesian learning.","code":""},{"path":"/reference/LAWBL-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"LAWBL: Latent (Variable) Analysis with Bayesian Learning — LAWBL-package","text":"LAWBL represents partially confirmatory / exploratory approach model latent variables based Bayesian learning. Built power statistical learning, can address psychometric challenges parameter specification, local dependence, factor extraction. Built scalability flexibility Bayesian inference resampling techniques, can accommodate modeling frameworks factor analysis, item response theory, cognitive diagnosis modeling causal explanatory modeling. package can also handle different response formats mix , without missingness. variety models provide partial approach covering wide range exploratory-confirmatory continuum context latent variable modeling. Towards confirmatory end, package includes Partially Confirmatory Factor Analysis (PCFA) model continuous data (Chen, Guo, Zhang, & Pan, 2020), generalized PCFA (GPCFA) model covering continuous, categorical, mixed-type data, partially confirmatory item response model (PCIRM) continuous dichotomous data intercept terms (Chen, 2020). PCFA, GPCFA, PCIRM, two major model variants different constraints identification. One assumes local independence (LI) exploratory tendency, can also called E-step. allows local dependence (LD) confirmatory tendency, can also called C-step. Towards exploratory end, Bayesian regularized EFA (BREFA) factor extraction parameter estimation one step (Chen 2021) offered. improved Fully partially EFA better performance partial knowledge. Parameters obtained sampling posterior distributions Markov chain Monte Carlo (MCMC) techniques. Different Bayesian learning methods used regularize loading pattern, local dependence, /factor identification.","code":""},{"path":"/reference/LAWBL-package.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"LAWBL: Latent (Variable) Analysis with Bayesian Learning — LAWBL-package","text":"package development. welcome send comments  suggestions improvements, share problems may encounter   use package.","code":""},{"path":"/reference/LAWBL-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"LAWBL: Latent (Variable) Analysis with Bayesian Learning — LAWBL-package","text":"Chen, J. (2020). partially confirmatory approach multidimensional item response theory Bayesian Lasso. Psychometrika. 85(3), 738-774. DOI:10.1007/s11336-020-09724-3. Chen, J., Guo, Z., Zhang, L., & Pan, J. (2021). partially confirmatory approach scale development  Bayesian Lasso. Psychological Methods. 26(2), 210–235. DOI: 10.1037/met0000293. Chen, J. (2021). generalized partially confirmatory factor analysis framework mixed Bayesian Lasso methods.  Multivariate Behavioral Research. DOI: 10.1080/00273171.2021.1925520. Chen, J. (2021). Bayesian regularized approach exploratory factor analysis one step. Structural Equation Modeling: Multidisciplinary Journal. DOI: 10.1080/10705511.2020.1854763. Chen, J. (2022). Partially confirmatory approach factor analysis Bayesian learning: LAWBL tutorial.  Structural Equation Modeling: Multidisciplinary Journal. DOI: 10.1080/00273171.2021.1925520. Chen, J. (Press). Fully partially exploratory factor analysis bi-level Bayesian regularization.  Behavior Research Methods.","code":""},{"path":"/reference/LAWBL-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"LAWBL: Latent (Variable) Analysis with Bayesian Learning — LAWBL-package","text":"Jinsong Chen, jinsong.chen@live.com","code":""},{"path":"/reference/nlsy27.html","id":null,"dir":"Reference","previous_headings":"","what":"National Longitudinal Survey of Youth 1997 — nlsy27","title":"National Longitudinal Survey of Youth 1997 — nlsy27","text":"data set consisted 3,458 individual responses 27 mixed-type items, 1.12 percentage missing data","code":""},{"path":"/reference/nlsy27.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"National Longitudinal Survey of Youth 1997 — nlsy27","text":"","code":"nlsy27"},{"path":"/reference/nlsy27.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"National Longitudinal Survey of Youth 1997 — nlsy27","text":"list components: dat response data Q Intial design matrix three factors two three specified loadings per factor cati Indices categorical (polytomous) items","code":""},{"path":"/reference/pcfa.html","id":null,"dir":"Reference","previous_headings":"","what":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","title":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","text":"PCFA partially confirmatory approach covering wide range exploratory-confirmatory continuum factor analytic models (Chen, Guo, Zhang, & Pan, 2021). PCFA continuous data, generalized PCFA (GPCFA; Chen, 2021) covers continuous categorical data. two major model variants different constraints identification. One assumes local  independence (LI) exploratory tendency, can also called E-step.  allows local dependence (LD) confirmatory tendency, can also  called C-step. Parameters obtained sampling posterior distributions  Markov chain Monte Carlo (MCMC) techniques. Different Bayesian Lasso methods used  regularize loading pattern LD. estimation results can summarized summary.lawbl  factorial eigenvalue can plotted plot_lawbl.","code":""},{"path":"/reference/pcfa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","text":"","code":"pcfa(   dat,   Q,   LD = TRUE,   cati = NULL,   cand_thd = 0.2,   PPMC = FALSE,   burn = 5000,   iter = 5000,   update = 1000,   missing = NA,   rfit = TRUE,   sign_check = FALSE,   sign_eps = -0.5,   rs = FALSE,   auto_stop = FALSE,   max_conv = 10,   rseed = 12345,   digits = 4,   alas = FALSE,   verbose = FALSE )"},{"path":"/reference/pcfa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","text":"dat \\(N \\times J\\) data matrix data.frame consisting responses \\(N\\) individuals \\(J\\) items. Q \\(J \\times K\\) design matrix loading pattern \\(K\\) factors \\(J\\) items. Elements 1, -1, 0 specified, unspecified, zero-fixed loadings, respectively. models LI E-step, one can specify (e.g., 2) loadings per factor. models LD C-step, sufficient condition one specified loading per item suggested, although can items without specified loading. See Examples. LD logical; TRUE allowing LD (model LD C-step). cati set categorical (polytomous) items sequence number (.e., 1 \\(J\\)); NULL -1 items (default NULL). cand_thd Candidate parameter sampling thresholds MH algorithm. PPMC logical; TRUE conducting posterior predictive model checking. burn Number burn-iterations posterior sampling. iter Number formal iterations posterior sampling (> 0). update Number iterations update sampling information. missing Value missing data (default NA). rfit logical; TRUE providing relative fit (DIC, BIC, AIC). sign_check logical; TRUE checking sign switch loading vector. sign_eps minimum value switch sign loading vector (sign_check=TRUE). rs logical; TRUE enabling recommendation system. auto_stop logical; TRUE enabling auto stop based EPSR<1.1. max_conv maximum consecutive number convergence auto stop. rseed integer random seed. digits Number significant digits print printing numeric values. alas logical; adaptive Lasso . default FALSE. verbose logical; display sampling information every update . Feigen: Eigenvalue factor. NLA_le3: Number Loading estimates >= .3 factor. Shrink: Shrinkage (ave. shrinkage factor adaptive Lasso). EPSR & NCOV: EPSR factor & # convergence. Ave. Thd: Ave. thresholds polytomous items. Acc Rate: Acceptance rate threshold (MH algorithm). LD>.2 >.1 LD>.2 >.1: # LD terms larger .2 .1, LD's shrinkage parameter. #Sign_sw: Number sign switch factor.","code":""},{"path":"/reference/pcfa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","text":"pcfa returns object class lawbl without item intercepts. contains lot information posteriors can summarized using summary.lawbl.","code":""},{"path":"/reference/pcfa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","text":"Chen, J., Guo, Z., Zhang, L., & Pan, J. (2021). partially confirmatory approach scale development  Bayesian Lasso. Psychological Methods. 26(2), 210–235. DOI: 10.1037/met0000293. Chen, J. (2021). generalized partially confirmatory factor analysis framework mixed Bayesian Lasso methods.  Multivariate Behavioral Research. DOI: 10.1080/00273171.2021.1925520.","code":""},{"path":"/reference/pcfa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"(Generalized) Partially Confirmatory Factor Analysis — pcfa","text":"","code":"# \\donttest{ ##################################################### #  Example 1: Estimation with continuous data & LD  # #####################################################  dat <- sim18cfa1$dat J <- ncol(dat) K <- 3 Q<-matrix(-1,J,K); Q[1:6,1]<-Q[7:12,2]<-Q[13:18,3]<-1  m0 <- pcfa(dat = dat, Q = Q, LD = TRUE,burn = 2000, iter = 2000) summary(m0) # summarize basic information #> $NJK #> [1] 1000   18    3 #>  #> $`Miss%` #> [1] 0 #>  #> $`LD Allowed` #> [1] TRUE #>  #> $`Burn in` #> [1] 2000 #>  #> $Iteration #> [1] 2000 #>  #> $`No. of sig lambda` #> [1] 23 #>  #> $Selected #> [1] TRUE TRUE TRUE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  0 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.7125     3.5603 #> [2,]     1.0459     1.1902 #> [3,]     1.1321     1.4495 #>  #> $`No. of sig LD terms` #> [1] 6 #>  #> $`DIC, BIC, AIC` #> [1] 3597.172 2497.062 1378.094 #>  #> $Time #>    user  system elapsed  #>   48.34    8.33   56.78  #>  summary(m0, what = 'qlambda') #summarize significant loadings in pattern/Q-matrix format #>          1      2      3 #> I1  0.7233 0.0000 0.0000 #> I2  0.6469 0.0000 0.0000 #> I3  0.7660 0.0000 0.0000 #> I4  0.7660 0.0000 0.0000 #> I5  0.7658 0.1835 0.0000 #> I6  0.7425 0.0000 0.0000 #> I7  0.0000 0.7646 0.0000 #> I8  0.0000 0.7091 0.0000 #> I9  0.0000 0.7420 0.0000 #> I10 0.0000 0.7220 0.0000 #> I11 0.0000 0.7087 0.2341 #> I12 0.0000 0.7163 0.2194 #> I13 0.0000 0.0000 0.7084 #> I14 0.0000 0.0000 0.6745 #> I15 0.0000 0.0000 0.7426 #> I16 0.0000 0.0000 0.7343 #> I17 0.2472 0.0000 0.7259 #> I18 0.2328 0.0000 0.7234 summary(m0, what = 'offpsx') #summarize significant LD terms #>      row col    est     sd  lower  upper sig #> [1,]  14   1 0.2876 0.0416 0.2042 0.3671   1 #> [2,]   7   2 0.2495 0.0608 0.1408 0.3637   1 #> [3,]   4   3 0.2692 0.0516 0.1744 0.3658   1 #> [4,]  13   8 0.2654 0.0614 0.1418 0.3899   1 #> [5,]  10   9 0.3080 0.0608 0.2008 0.4382   1 #> [6,]  16  15 0.2631 0.0635 0.1374 0.3843   1  ###################################################### #  Example 2: Estimation with categorical data & LI  # ###################################################### dat <- sim18ccfa40$dat J <- ncol(dat) K <- 3 Q<-matrix(-1,J,K); Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1  m1 <- pcfa(dat = dat, Q = Q,LD = FALSE,cati=-1,burn = 2000, iter = 2000) summary(m1) # summarize basic information #> $NJK #> [1] 1000   18    3 #>  #> $`Miss%` #> [1] 9.888889 #>  #> $`LD Allowed` #> [1] FALSE #>  #> $`Burn in` #> [1] 2000 #>  #> $Iteration #> [1] 2000 #>  #> $`No. of sig lambda` #> [1] 24 #>  #> $Selected #> [1] TRUE TRUE TRUE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  0 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.2016     1.6828 #> [2,]     1.1469     1.4762 #> [3,]     1.0670     1.2669 #>  #> $`Cat Items` #>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 #>  #> $`max No. of categories` #> [1] 4 #>  #> $`DIC, BIC, AIC` #> [1] 4133.164 3834.688 3466.606 #>  #> $Time #>    user  system elapsed  #>   74.86   12.44   87.49  #>  summary(m1, what = 'qlambda') #summarize significant loadings in pattern/Q-matrix format #>          1      2      3 #> I1  0.7423 0.0000 0.0000 #> I2  0.7406 0.0000 0.0000 #> I3  0.7442 0.0000 0.0000 #> I4  0.7620 0.0000 0.0000 #> I5  0.7688 0.2287 0.0000 #> I6  0.7184 0.2275 0.0000 #> I7  0.0000 0.7350 0.0000 #> I8  0.0000 0.7322 0.0000 #> I9  0.0000 0.7314 0.0000 #> I10 0.0000 0.6976 0.0000 #> I11 0.0000 0.7014 0.2681 #> I12 0.0000 0.6945 0.2641 #> I13 0.0000 0.0000 0.7506 #> I14 0.0000 0.0000 0.7243 #> I15 0.0000 0.0000 0.7331 #> I16 0.0000 0.0000 0.7115 #> I17 0.2784 0.0000 0.7283 #> I18 0.3019 0.0000 0.6667 summary(m1, what = 'offpsx') #summarize significant LD terms #> NULL summary(m1,what='thd') #thresholds for categorical items #>          [,1]    [,2]   [,3] #>  [1,] -1.3566  0.0754 1.6245 #>  [2,] -1.4324  0.0571 1.4929 #>  [3,] -1.4491  0.0539 1.4929 #>  [4,] -1.3762  0.0598 1.5975 #>  [5,] -1.4274  0.0147 1.4727 #>  [6,] -1.4862  0.0849 1.5689 #>  [7,] -1.4943  0.0361 1.6604 #>  [8,] -1.5413 -0.0550 1.4096 #>  [9,] -1.4773 -0.0132 1.5135 #> [10,] -1.5041  0.0126 1.6268 #> [11,] -1.4495  0.0218 1.5745 #> [12,] -1.5340  0.0205 1.6335 #> [13,] -1.5586 -0.0522 1.4086 #> [14,] -1.4153  0.0509 1.5145 #> [15,] -1.5415 -0.0238 1.4803 #> [16,] -1.4598 -0.0093 1.3759 #> [17,] -1.4275  0.0653 1.4807 #> [18,] -1.5253  0.0380 1.5541 # }"},{"path":"/reference/pcirm.html","id":null,"dir":"Reference","previous_headings":"","what":"Partially Confirmatory Item Response Model — pcirm","title":"Partially Confirmatory Item Response Model — pcirm","text":"pcirm partially confirmatory approach item response models (Chen, 2020), estimates intercept continuous dichotomous data. Similar PCFA GPCFA,  two major model variants different constraints identification. One assumes local  independence (LI) exploratory tendency, can also called E-step.  allows local dependence (LD) confirmatory tendency, can also  called C-step. Parameters obtained sampling posterior distributions  Markov chain Monte Carlo (MCMC) techniques. Different Bayesian Lasso methods used  regularize loading pattern LD. estimation results can summarized summary.lawbl  factorial eigenvalue can plotted plot_lawbl.","code":""},{"path":"/reference/pcirm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Partially Confirmatory Item Response Model — pcirm","text":"","code":"pcirm(   dat,   Q,   LD = TRUE,   cati = NULL,   PPMC = FALSE,   burn = 5000,   iter = 5000,   update = 1000,   missing = NA,   rseed = 12345,   sign_check = FALSE,   sign_eps = -0.5,   auto_stop = FALSE,   max_conv = 10,   digits = 4,   alas = FALSE,   verbose = FALSE )"},{"path":"/reference/pcirm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Partially Confirmatory Item Response Model — pcirm","text":"dat \\(N \\times J\\) data matrix data.frame consisting responses \\(N\\) individuals \\(J\\) items. continuous dichotomous data supported. Q \\(J \\times K\\) design matrix loading pattern \\(K\\) factors \\(J\\) items. Elements 1, -1, 0 specified, unspecified, zero-fixed loadings, respectively. models LI E-step, one can specify (e.g., 2) loadings per factor. models LD C-step, sufficient condition one specified loading per item suggested, although can items without specified loading. See Examples. LD logical; TRUE allowing LD (model LD C-step). cati set dichotomous items sequence number (.e., 1 \\(J\\)); NULL -1 items (default NULL). PPMC logical; TRUE conducting posterior predictive model checking. burn Number burn-iterations posterior sampling. iter Number formal iterations posterior sampling (> 0). update Number iterations update sampling information. missing Value missing data (default NA). rseed integer random seed. sign_check logical; TRUE checking sign switch loading vector. sign_eps minimum value switch sign loading vector (sign_check=TRUE). auto_stop logical; TRUE enabling auto stop based EPSR<1.1. max_conv maximum consecutive number convergence auto stop. digits Number significant digits print printing numeric values. alas logical; adaptive Lasso . default FALSE. verbose logical; display sampling information every update . Feigen: Eigenvalue factor. NLA_le3: Number Loading estimates >= .3 factor. Shrink: Shrinkage (ave. shrinkage factor adaptive Lasso). EPSR & NCOV: EPSR factor & # convergence. Ave. Int.: Ave. item intercept. LD>.2 >.1 LD>.2 >.1: # LD terms larger .2 .1, LD's shrinkage parameter. #Sign_sw: Number sign switch factor.","code":""},{"path":"/reference/pcirm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Partially Confirmatory Item Response Model — pcirm","text":"pcirm returns object class lawbl item intercepts. contains lot information posteriors can summarized using summary.lawbl.","code":""},{"path":"/reference/pcirm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Partially Confirmatory Item Response Model — pcirm","text":"Chen, J. (2020). partially confirmatory approach multidimensional item response theory Bayesian Lasso. Psychometrika. 85(3), 738-774. DOI:10.1007/s11336-020-09724-3.","code":""},{"path":"/reference/pcirm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Partially Confirmatory Item Response Model — pcirm","text":"","code":"# \\donttest{ #################################### #  Example 1: Estimation with LD   # ####################################  dat <- sim24ccfa21$dat J <- ncol(dat) K <- 3 Q<-matrix(-1,J,K); Q[1:8,1]<-Q[9:16,2]<-Q[17:24,3]<-1  m0 <- pcirm(dat = dat, Q = Q, LD = TRUE, cati = -1, burn = 2000,iter = 2000) summary(m0) # summarize basic information #> $NJK #> [1] 1000   24    3 #>  #> $`Miss%` #> [1] 0 #>  #> $`LD Allowed` #> [1] TRUE #>  #> $`Burn in` #> [1] 2000 #>  #> $Iteration #> [1] 2000 #>  #> $`No. of sig lambda` #> [1] 24 #>  #> $Selected #> [1] TRUE TRUE TRUE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  0 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.0133     1.0639 #> [2,]     1.0858     1.3328 #> [3,]     1.0049     1.0197 #>  #> $`No. of sig LD terms` #> [1] 7 #>  #> $`Cat Items` #>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #>  #> $`max No. of categories` #> [1] 2 #>  #> $Time #>    user  system elapsed  #>   88.01   13.26  101.47  #>  summary(m0, what = 'qlambda') #summarize significant loadings in pattern/Q-matrix format #>          1      2      3 #> I1  0.7426 0.0000 0.0000 #> I2  0.7031 0.0000 0.0000 #> I3  0.6460 0.0000 0.0000 #> I4  0.6917 0.0000 0.0000 #> I5  0.6589 0.0000 0.0000 #> I6  0.7183 0.0000 0.0000 #> I7  0.7324 0.0000 0.0000 #> I8  0.7521 0.0000 0.0000 #> I9  0.0000 0.7047 0.0000 #> I10 0.0000 0.7254 0.0000 #> I11 0.0000 0.6958 0.0000 #> I12 0.0000 0.6760 0.0000 #> I13 0.0000 0.6842 0.0000 #> I14 0.0000 0.6680 0.0000 #> I15 0.0000 0.6866 0.0000 #> I16 0.0000 0.6746 0.0000 #> I17 0.0000 0.0000 0.6891 #> I18 0.0000 0.0000 0.7132 #> I19 0.0000 0.0000 0.6953 #> I20 0.0000 0.0000 0.7237 #> I21 0.0000 0.0000 0.7092 #> I22 0.0000 0.0000 0.6939 #> I23 0.0000 0.0000 0.6976 #> I24 0.0000 0.0000 0.7576 summary(m0, what = 'offpsx') #summarize significant LD terms #>      row col    est     sd  lower  upper sig #> [1,]   8   7 0.1230 0.0439 0.0381 0.2126   1 #> [2,]  16  15 0.1807 0.0637 0.0433 0.2927   1 #> [3,]  23  15 0.1618 0.0531 0.0504 0.2673   1 #> [4,]  24  15 0.1420 0.0512 0.0385 0.2421   1 #> [5,]  23  16 0.1480 0.0534 0.0364 0.2506   1 #> [6,]  24  16 0.1336 0.0496 0.0393 0.2393   1 #> [7,]  24  23 0.1540 0.0516 0.0571 0.2533   1  #################################### #  Example 2: Estimation with LD   # ####################################  Q<-cbind(Q,-1); Q[15:16,4]<-1  m1 <- pcirm(dat = dat, Q = Q, LD = FALSE, cati = -1, burn = 2000,iter = 2000) summary(m1) # summarize basic information #> $NJK #> [1] 1000   24    4 #>  #> $`Miss%` #> [1] 0 #>  #> $`LD Allowed` #> [1] FALSE #>  #> $`Burn in` #> [1] 2000 #>  #> $Iteration #> [1] 2000 #>  #> $`No. of sig lambda` #> [1] 28 #>  #> $Selected #> [1] TRUE TRUE TRUE TRUE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  0 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.0270     1.1205 #> [2,]     1.0927     1.3546 #> [3,]     1.0622     1.1633 #> [4,]     1.0002     1.0010 #>  #> $`Cat Items` #>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #>  #> $`max No. of categories` #> [1] 2 #>  #> $Time #>    user  system elapsed  #>   46.67    7.45   54.13  #>  summary(m1, what = 'qlambda') #summarize significant loadings in pattern/Q-matrix format #>          1      2      3      4 #> I1  0.7293 0.0000 0.0000 0.0000 #> I2  0.6933 0.0000 0.0000 0.0000 #> I3  0.6375 0.0000 0.0000 0.0000 #> I4  0.6896 0.0000 0.0000 0.0000 #> I5  0.6585 0.0000 0.0000 0.0000 #> I6  0.7073 0.0000 0.0000 0.0000 #> I7  0.8222 0.0000 0.0000 0.0000 #> I8  0.8333 0.0000 0.0000 0.0000 #> I9  0.0000 0.7155 0.0000 0.0000 #> I10 0.0000 0.7363 0.0000 0.0000 #> I11 0.0000 0.7253 0.0000 0.0000 #> I12 0.0000 0.7116 0.0000 0.0000 #> I13 0.0000 0.6982 0.0000 0.0000 #> I14 0.0000 0.6939 0.0000 0.0000 #> I15 0.0000 0.6868 0.0000 0.5954 #> I16 0.0000 0.6629 0.0000 0.5705 #> I17 0.0000 0.0000 0.6969 0.0000 #> I18 0.0000 0.0000 0.7431 0.0000 #> I19 0.0000 0.0000 0.7027 0.0000 #> I20 0.0000 0.0000 0.7418 0.0000 #> I21 0.0000 0.0000 0.7219 0.0000 #> I22 0.0000 0.0000 0.7068 0.0000 #> I23 0.0000 0.0000 0.6662 0.4724 #> I24 0.0000 0.0000 0.7286 0.4335 summary(m1, what = 'offpsx') #summarize significant LD terms #> NULL # }"},{"path":"/reference/pefa.html","id":null,"dir":"Reference","previous_headings":"","what":"Partially Exploratory Factor Analysis — pefa","title":"Partially Exploratory Factor Analysis — pefa","text":"PEFA partially exploratory approach factor analysis, can incorporate partial knowledge together unknown number factors, using bi-level Bayesian regularization. partial knowledge needed, reduces fully exploratory factor analysis (FEFA; Chen, 2021). large number factors can imposed selection true factors identified spurious factors. loading vector reparameterized tackle model sparsity factor loading levels multivariate spike slab priors. Parameters obtained sampling posterior distributions Markov chain Monte Carlo (MCMC) techniques. estimation results can summarized summary.lawbl trace density posterior can plotted plot_lawbl.","code":""},{"path":"/reference/pefa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Partially Exploratory Factor Analysis — pefa","text":"","code":"pefa(   dat,   Q = NULL,   K = 8,   mjf = 3,   PPMC = FALSE,   burn = 5000,   iter = 5000,   missing = NA,   eig_eps = 1,   sign_eps = 0,   rfit = TRUE,   rs = FALSE,   update = 1000,   rseed = 12345,   verbose = FALSE,   auto_stop = FALSE,   max_conv = 10,   digits = 4 )"},{"path":"/reference/pefa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Partially Exploratory Factor Analysis — pefa","text":"dat \\(N \\times J\\) data matrix data.frame consisting responses \\(N\\) individuals \\(J\\) items. Q \\(J \\times K\\) design matrix loading pattern \\(K\\) factors \\(J\\) items PEFA. Elements 1, -1, 0 specified, unspecified, zero-fixed loadings, respectively. needed FEFA, default. See Examples. K Maximum number factors selection FEFA. used PEFA. mjf Minimum number items per factor. PPMC logical; TRUE conducting posterior predictive model checking. burn Number burn-iterations posterior sampling. iter Number formal iterations posterior sampling (> 0). eig_eps minimum eigenvalue factor extraction. sign_eps minimum value switch sign loading vector. rfit logical; TRUE providing relative fit (DIC, BIC, AIC). rs logical; TRUE enabling recommendation system. update Number iterations update sampling information. rseed integer random seed. verbose logical; display sampling information every update . Feigen: Eigenvalue factor. NLA_lg0: Number Loading magnitudes > 0 factor. iShrink: Inverted shrinkage parameter factor. True Fa: factor identified true . EPSR & NCOV: EPSR factor & # convergence. ROW: LA overflow,sign switch,bk=0, <eig_eps: Loading overflow, sign switch,      vector bk=0 eigenvalue<eig_eps. auto_stop logical; TRUE enabling auto stop based EPSR. max_conv maximum consecutive number convergence auto stop. digits Number significant digits print printing numeric values.","code":""},{"path":"/reference/pefa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Partially Exploratory Factor Analysis — pefa","text":"pcfa returns object class lawbl without item intercepts. contains lot information posteriors can summarized using summary.lawbl.","code":""},{"path":"/reference/pefa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Partially Exploratory Factor Analysis — pefa","text":"Chen, J. (2021). Bayesian regularized approach exploratory factor analysis one step.  Structural Equation Modeling: Multidisciplinary Journal,   28(4), 518-528. DOI: 10.1080/10705511.2020.1854763. Chen, J. (Press). Fully partially exploratory factor analysis bi-level Bayesian regularization.  Behavior Research Methods.","code":""},{"path":"/reference/pefa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Partially Exploratory Factor Analysis — pefa","text":"","code":"# \\donttest{ ##################################################### #  Example 1: Fully EFA                             # #####################################################  dat <- sim18cfa0$dat  m0 <- pefa(dat = dat, K=5, burn = 2000, iter = 2000,verbose = TRUE) #>  #> Tot. Iter = 1000 #>           [,1]      [,2]    [,3]    [,4]      [,5] #> Feigen  3.0751 0.0000000  2.9399  3.1796 0.000e+00 #> NLA_lg0 9.0000 0.0000000 12.0000 10.0000 0.000e+00 #> iShrink 0.2006 0.0003665  0.2937  0.3649 2.847e-16 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0  195    0    0  240 #> [3,]    0  432    0    0  502 #> [4,]    1  544    3    8  498 #>  #> Tot. Iter = 2000 #>           [,1]      [,2]  [,3]    [,4]      [,5] #> Feigen  2.8513 0.0000000 2.853  3.0671 0.000e+00 #> NLA_lg0 9.0000 0.0000000 9.000 10.0000 0.000e+00 #> iShrink 0.2843 0.0005151 1.029  0.3692 1.657e-20 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0  366    0    0  502 #> [3,]    0  921    0    0  975 #> [4,]    1 1055    3    8 1025 #>  #> Tot. Iter = 3000 #>            [,1]   [,2]   [,3]   [,4]      [,5] #> Feigen   3.3503 0.0000 2.6914 3.1388 0.000e+00 #> NLA_lg0 11.0000 0.0000 9.0000 9.0000 0.000e+00 #> iShrink  0.3073 0.0459 0.4774 0.2367 7.354e-23 #> Tru Fac 1 0 1 1 0 #> EPSR & NCONV 1.01 1.022 1.012 1 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0  519    0    0  764 #> [3,]    0 1505    0    0 1488 #> [4,]    1 1471    3    8 1512 #>  #> Tot. Iter = 4000 #>            [,1]    [,2]   [,3]  [,4]      [,5] #> Feigen   3.2592 0.00000 3.1686 3.221 0.000e+00 #> NLA_lg0 11.0000 0.00000 8.0000 8.000 0.000e+00 #> iShrink  0.8602 0.04228 0.3323 1.006 7.724e-30 #> Tru Fac 1 0 1 1 0 #> EPSR & NCONV 1.011 1.005 1.006 2 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0  519    0    0 1009 #> [3,]    0 2501    0    0 2022 #> [4,]    1 1475    3    8 1978 #>    user  system elapsed  #>   15.80    2.51   18.36  summary(m0) # summarize basic information #> $NJK #> [1] 1000   18    5 #>  #> $`Miss%` #> [1] 0 #>  #> $`LD Allowed` #> [1] FALSE #>  #> $`Burn in` #> [1] 2000 #>  #> $Iteration #> [1] 2000 #>  #> $`No. of sig lambda` #> [1] 24 #>  #> $Selected #> [1]  TRUE FALSE  TRUE  TRUE FALSE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  2 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.0111     1.0306 #> [2,]     1.0046     1.0065 #> [3,]     1.0061     1.0313 #>  #> $`DIC, BIC, AIC` #> [1] 4911.460 2892.593 2313.478 #>  #> $Time #>    user  system elapsed  #>   15.80    2.51   18.36  #>  summary(m0, what = 'qlambda') #summarize significant loadings in pattern/Q-matrix format #>          1      3      4 #> I1  0.0000 0.0000 0.6798 #> I2  0.0000 0.0000 0.6883 #> I3  0.0000 0.0000 0.7043 #> I4  0.0000 0.0000 0.7103 #> I5  0.3235 0.0000 0.6952 #> I6  0.3406 0.0000 0.6749 #> I7  0.7229 0.0000 0.0000 #> I8  0.7178 0.0000 0.0000 #> I9  0.7231 0.0000 0.0000 #> I10 0.6968 0.0000 0.0000 #> I11 0.6961 0.2924 0.0000 #> I12 0.6972 0.2853 0.0000 #> I13 0.0000 0.6785 0.0000 #> I14 0.0000 0.6744 0.0000 #> I15 0.0000 0.7082 0.0000 #> I16 0.0000 0.6772 0.0000 #> I17 0.0000 0.6895 0.3005 #> I18 0.0000 0.6853 0.2872 summary(m0, what = 'phi') #summarize factorial correlations #>      row col    est     sd  lower  upper sig #> [1,]   3   1 0.2881 0.0358 0.2196 0.3587   1 #> [2,]   4   1 0.2688 0.0361 0.2025 0.3421   1 #> [3,]   4   3 0.3154 0.0358 0.2523 0.3897   1 summary(m0, what = 'eigen') #summarize factorial eigenvalue #>       est     sd  lower  upper sig #> F1 3.2443 0.1612 2.9169 3.5517   1 #> F3 2.9944 0.1521 2.7198 3.3141   1 #> F4 3.0561 0.1577 2.7607 3.3788   1  ########################################################## #  Example 2: PEFA with two factors partially specified  # ##########################################################  J <- ncol(dat) K <- 5 Q<-matrix(-1,J,K); Q[1:2,1]<-Q[7:8,2]<-1 Q #>       [,1] [,2] [,3] [,4] [,5] #>  [1,]    1   -1   -1   -1   -1 #>  [2,]    1   -1   -1   -1   -1 #>  [3,]   -1   -1   -1   -1   -1 #>  [4,]   -1   -1   -1   -1   -1 #>  [5,]   -1   -1   -1   -1   -1 #>  [6,]   -1   -1   -1   -1   -1 #>  [7,]   -1    1   -1   -1   -1 #>  [8,]   -1    1   -1   -1   -1 #>  [9,]   -1   -1   -1   -1   -1 #> [10,]   -1   -1   -1   -1   -1 #> [11,]   -1   -1   -1   -1   -1 #> [12,]   -1   -1   -1   -1   -1 #> [13,]   -1   -1   -1   -1   -1 #> [14,]   -1   -1   -1   -1   -1 #> [15,]   -1   -1   -1   -1   -1 #> [16,]   -1   -1   -1   -1   -1 #> [17,]   -1   -1   -1   -1   -1 #> [18,]   -1   -1   -1   -1   -1  m1 <- pefa(dat = dat, Q = Q,burn = 2000, iter = 2000,verbose = TRUE) #>  #> Tot. Iter = 1000 #>           [,1]   [,2]    [,3]     [,4]     [,5] #> Feigen  3.0879 3.3755  3.1763 0.000000 0.00e+00 #> NLA_lg0 9.0000 8.0000 10.0000 0.000000 0.00e+00 #> iShrink 0.8762 0.7396  0.5269 0.005856 3.38e-06 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0    0    0  160  219 #> [3,]    0    0    0  485  490 #> [4,]    0    0    1  515  510 #>  #> Tot. Iter = 2000 #>          [,1]  [,2]   [,3]     [,4]      [,5] #> Feigen  3.139 3.046  2.818 0.000000 0.000e+00 #> NLA_lg0 8.000 8.000 10.000 0.000000 0.000e+00 #> iShrink 1.218 0.937  1.071 0.002086 4.385e-07 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0    0    0  348  469 #> [3,]    0    0    0  972  964 #> [4,]    0    0    1 1028 1036 #>  #> Tot. Iter = 3000 #>           [,1]   [,2]   [,3]      [,4]      [,5] #> Feigen  3.1556 3.5876 2.8366 0.000e+00 0.000e+00 #> NLA_lg0 9.0000 9.0000 8.0000 0.000e+00 0.000e+00 #> iShrink 0.4709 0.8438 0.7828 4.889e-09 1.519e-10 #> Tru Fac 1 1 1 0 0 #> EPSR & NCONV 1.044 1.001 1.092 1 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0    0    0  587  740 #> [3,]    0    0    0 1468 1463 #> [4,]    0    0    1 1532 1537 #>  #> Tot. Iter = 4000 #>           [,1]  [,2]   [,3]      [,4]      [,5] #> Feigen  2.9765 2.998  3.223 0.000e+00 0.000e+00 #> NLA_lg0 9.0000 8.000 11.000 0.000e+00 0.000e+00 #> iShrink 0.5865 1.365  1.191 8.653e-15 1.355e-18 #> Tru Fac 1 1 1 0 0 #> EPSR & NCONV 1.004 1.008 1.013 2 #> [1] \"ROW: LA overflow, sign switch, bk=0, <eig_eps\" #>      [,1] [,2] [,3] [,4] [,5] #> [1,]    0    0    0    0    0 #> [2,]    0    0    0  856 1009 #> [3,]    0    0    0 1944 1942 #> [4,]    0    0    1 2056 2058 #>    user  system elapsed  #>   17.63    2.54   20.24  summary(m1) #> $NJK #> [1] 1000   18    5 #>  #> $`Miss%` #> [1] 0 #>  #> $`LD Allowed` #> [1] FALSE #>  #> $`Burn in` #> [1] 2000 #>  #> $Iteration #> [1] 2000 #>  #> $`No. of sig lambda` #> [1] 24 #>  #> $Selected #> [1]  TRUE  TRUE  TRUE FALSE FALSE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  2 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.0041     1.0220 #> [2,]     1.0078     1.0302 #> [3,]     1.0125     1.0507 #>  #> $`DIC, BIC, AIC` #> [1] 4906.446 2886.731 2307.616 #>  #> $Time #>    user  system elapsed  #>   17.63    2.54   20.24  #>  summary(m1, what = 'qlambda') #>          1      2      3 #> I1  0.6834 0.0000 0.0000 #> I2  0.6924 0.0000 0.0000 #> I3  0.7067 0.0000 0.0000 #> I4  0.7122 0.0000 0.0000 #> I5  0.6984 0.3245 0.0000 #> I6  0.6767 0.3411 0.0000 #> I7  0.0000 0.7283 0.0000 #> I8  0.0000 0.7231 0.0000 #> I9  0.0000 0.7268 0.0000 #> I10 0.0000 0.7001 0.0000 #> I11 0.0000 0.7017 0.2905 #> I12 0.0000 0.6995 0.2850 #> I13 0.0000 0.0000 0.6784 #> I14 0.0000 0.0000 0.6741 #> I15 0.0000 0.0000 0.7090 #> I16 0.0000 0.0000 0.6776 #> I17 0.3029 0.0000 0.6876 #> I18 0.2867 0.0000 0.6870 summary(m1, what = 'phi') #>      row col    est     sd  lower  upper sig #> [1,]   2   1 0.2711 0.0371 0.1995 0.3424   1 #> [2,]   3   1 0.3188 0.0363 0.2507 0.3863   1 #> [3,]   3   2 0.2879 0.0352 0.2213 0.3620   1 summary(m1,what='eigen') #>       est     sd  lower  upper sig #> F1 3.0802 0.1591 2.8060 3.4049   1 #> F2 3.2822 0.1694 2.9720 3.6228   1 #> F3 2.9940 0.1530 2.7138 3.3128   1 # }"},{"path":"/reference/plot_lawbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior plots for lawbl object — plot_lawbl","title":"Posterior plots for lawbl object — plot_lawbl","text":"Provide posterior plots based factorial eigenvalues lawbl object. PEFA FEFA, true factors plotted.","code":""},{"path":"/reference/plot_lawbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior plots for lawbl object — plot_lawbl","text":"","code":"plot_lawbl(object, what = \"trace\", istart = 1, iend = -1)"},{"path":"/reference/plot_lawbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior plots for lawbl object — plot_lawbl","text":"object lawbl object list options plot. trace: trace factor's eigenvalue. density: trace factor's eigenvalue. EPSR: Estimated Potential Scale Reduction (Gelman-Rubin diagnostics) factor. istart Starting point Markov chain plotting. iend Ending point Markov chain plotting; -1 actual final point.","code":""},{"path":"/reference/plot_lawbl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior plots for lawbl object — plot_lawbl","text":"","code":"# \\donttest{ dat <- sim18cfa0$dat J <- ncol(dat) K <- 3 Q<-matrix(-1,J,K); Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1   m0 <- pcfa(dat = dat, Q = Q, LD = FALSE,burn = 1000, iter = 1000) plot_lawbl(m0) # trace  plot_lawbl(m0, what='density')  plot_lawbl(m0, what='EPSR')  # }"},{"path":"/reference/sim18ccfa40.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated CCFA data with LI and missingness — sim18ccfa40","title":"Simulated CCFA data with LI and missingness — sim18ccfa40","text":"Categorical CFA data simulated based 18 items, 3 factors, 4 categories local independence  10 percent missingness random; factorial correlation \\(\\Phi=.3\\).","code":""},{"path":"/reference/sim18ccfa40.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated CCFA data with LI and missingness — sim18ccfa40","text":"","code":"sim18ccfa40"},{"path":"/reference/sim18ccfa40.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated CCFA data with LI and missingness — sim18ccfa40","text":"list components: dat dataset simulated responses 1000 individuals 18 items qlam Loading pattern values used simulated data","code":""},{"path":"/reference/sim18ccfa41.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated CCFA data with LD and missingness — sim18ccfa41","title":"Simulated CCFA data with LD and missingness — sim18ccfa41","text":"Categorical CFA data simulated based 18 items, 3 factors, 4 categories local dependence  10 percent missingness random; factorial correlation \\(\\Phi=.3\\).","code":""},{"path":"/reference/sim18ccfa41.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated CCFA data with LD and missingness — sim18ccfa41","text":"","code":"sim18ccfa41"},{"path":"/reference/sim18ccfa41.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated CCFA data with LD and missingness — sim18ccfa41","text":"list components: dat dataset simulated responses 1000 individuals 18 items qlam Loading pattern values used simulated data LD Local dependence items (LD effect = .3)","code":""},{"path":"/reference/sim18cfa0.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated CFA data with LI — sim18cfa0","title":"Simulated CFA data with LI — sim18cfa0","text":"CFA data simulated based 18 items, 3 factors local independence;  factorial correlation \\(\\Phi=.3\\).","code":""},{"path":"/reference/sim18cfa0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated CFA data with LI — sim18cfa0","text":"","code":"sim18cfa0"},{"path":"/reference/sim18cfa0.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated CFA data with LI — sim18cfa0","text":"list components: dat dataset simulated responses 1000 individuals 18 items qlam Loading pattern values used simulated data","code":""},{"path":"/reference/sim18cfa1.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated CFA data with LD — sim18cfa1","title":"Simulated CFA data with LD — sim18cfa1","text":"CFA data simulated based 18 items, 3 factors local dependence; factorial correlation \\(\\Phi=.3\\).","code":""},{"path":"/reference/sim18cfa1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated CFA data with LD — sim18cfa1","text":"","code":"sim18cfa1"},{"path":"/reference/sim18cfa1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated CFA data with LD — sim18cfa1","text":"list components: dat dataset simulated responses 1000 individuals 18 items qlam Loading pattern values used simulated data LD Local dependence items (LD effect = .3)","code":""},{"path":"/reference/sim18mcfa41.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated MCFA data with LD and Missingness — sim18mcfa41","title":"Simulated MCFA data with LD and Missingness — sim18mcfa41","text":"CFA data mixed continuous categorical responses simulated based 3 factors, 6 4-category items, 12 continuous items, local dependence, 10 percent missigness random; factorial correlation \\(\\Phi=.3\\).","code":""},{"path":"/reference/sim18mcfa41.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated MCFA data with LD and Missingness — sim18mcfa41","text":"","code":"sim18mcfa41"},{"path":"/reference/sim18mcfa41.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated MCFA data with LD and Missingness — sim18mcfa41","text":"list components: dat dataset simulated responses 1000 individuals 18 items qlam Loading pattern values used simulated data LD Local dependence items (LD effect = .3)","code":""},{"path":"/reference/sim24ccfa21.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated CCFA data (dichotomous) with LD and a minor factor/trait — sim24ccfa21","title":"Simulated CCFA data (dichotomous) with LD and a minor factor/trait — sim24ccfa21","text":"Categorical CFA data simulated based 24 items, 4 factors, 2 categories  local dependence; factorial correlation \\(\\Phi=.3\\).  last factor/trait minor (measured cross-loadings ).","code":""},{"path":"/reference/sim24ccfa21.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated CCFA data (dichotomous) with LD and a minor factor/trait — sim24ccfa21","text":"","code":"sim24ccfa21"},{"path":"/reference/sim24ccfa21.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated CCFA data (dichotomous) with LD and a minor factor/trait — sim24ccfa21","text":"list components: dat dataset simulated responses 1000 individuals 24 items qlam Loading pattern values used simulated data LD Local dependence items (LD effect = .3)","code":""},{"path":"/reference/sim_lvm.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating data with Latent Variable Modeling — sim_lvm","title":"Simulating data with Latent Variable Modeling — sim_lvm","text":"sim_lvm can simulate data based factor analysis item response models different response formats (continuous categorical), loading patterns residual covariance (local dependence) structures.","code":""},{"path":"/reference/sim_lvm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating data with Latent Variable Modeling — sim_lvm","text":"","code":"sim_lvm(   N = 1000,   mla = NULL,   K = 3,   J = 18,   cpf = 0,   lam = 0.7,   lac = 0.3,   phi = 0.3,   ph12 = -1,   ecr = 0,   P = 0,   b = 0.3,   K1 = 0,   ph1 = 0.2,   b1 = 0.3,   ilvl = NULL,   cati = NULL,   noc = c(4),   misp = 0,   ome_out = FALSE,   necw = K,   necb = K,   add_ind = c(),   add_la = 0.5,   add_phi = 0,   zero_it = 0,   rseed = 333,   digits = 4 )"},{"path":"/reference/sim_lvm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating data with Latent Variable Modeling — sim_lvm","text":"N Sample size. mla Population loading matrix. K Number factors (mla=NULL). J Number items (mla=NULL). cpf Number cross-loadings per factor (mla=NULL). lam Number formal iterations posterior sampling. lac Number iterations update sampling information. phi Homogeneous correlations two factors. ph12 Correlation factor 1 2 (different phi. ecr Residual correlation (local dependence). P Number observable predictors (MIMIC model). b Coefficients observable predictors (MIMIC model). K1 Number latent predictors (MIMIC model). ph1 Correlations latent predictors (MIMIC model). b1 Coefficients latent predictors (MIMIC model). ilvl Specified levels items (.e., need specify Item 1 \\(J+P\\)); value smaller 2 considered continuous item. cati set polytomous items sequence number (.e., can number set 1 \\(J+P\\)); NULL -1 (ilvl=NULL). noc Number levels polytomous items. misp Proportion missingness. ome_out Output factor score . necw Number within-factor local dependence. necb Number -factor local dependence. add_ind (Additional) minor factor cross-loadings. add_la Value cross-loadings (Additional) minor factor. add_phi Correlations (Additional) minor factor factors. zero_it Surplus items zero loading. rseed integer random seed. digits Number significant digits print printing numeric values.","code":""},{"path":"/reference/sim_lvm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating data with Latent Variable Modeling — sim_lvm","text":"object class list containing data, loading, factorial correlation matrix.","code":""},{"path":"/reference/sim_lvm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating data with Latent Variable Modeling — sim_lvm","text":"","code":"# for continuous data with cross-loadings and local dependence effect .3 out <- sim_lvm(N=1000,K=3,ipf=6,lam = .7, lac=.3,ecr=.3) #> Error in sim_lvm(N = 1000, K = 3, ipf = 6, lam = 0.7, lac = 0.3, ecr = 0.3): unused argument (ipf = 6) summary(out$dat) #> Error in summary(out$dat): object 'out' not found out$MLA #> Error in eval(expr, envir, enclos): object 'out' not found out$ofd_ind #> Error in eval(expr, envir, enclos): object 'out' not found  # for categorical data with cross-loadings .4 and 10% missingness out <- sim_lvm(N=1000,K=3,ipf=6,lam = .7, lac=.4,cati=-1,noc=4,misp=.1) #> Error in sim_lvm(N = 1000, K = 3, ipf = 6, lam = 0.7, lac = 0.4, cati = -1,     noc = 4, misp = 0.1): unused argument (ipf = 6) summary(out$dat) #> Error in summary(out$dat): object 'out' not found out$MLA #> Error in eval(expr, envir, enclos): object 'out' not found out$ofd_ind #> Error in eval(expr, envir, enclos): object 'out' not found"},{"path":"/reference/summary.lawbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for lawbl objects — summary.lawbl","title":"Summary method for lawbl objects — summary.lawbl","text":"Provide summaries posterior information lawbl object, .","code":""},{"path":"/reference/summary.lawbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for lawbl objects — summary.lawbl","text":"","code":"# S3 method for lawbl summary(   object,   what = \"basic\",   med = FALSE,   SL = 0.05,   detail = FALSE,   digits = 4,   istart = 1,   iend = -1,   ... )"},{"path":"/reference/summary.lawbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for lawbl objects — summary.lawbl","text":"object lawbl object list options summarize. basic: Basic information model posteriors. lambda: Loading estimates. qlambda: Loading estimates pattern/Q-matrix format. eigen: Factorial eigen value. dpsx: Diagonal elements residual covariance matrix PSX. offpsx: -diagonal elements PSX; local dependence terms. phi: Factorial correlations. thd: Threshold estimates. int: Intercept estimates ( pcirm ). shrink: (Ave) shrinkage factor's loadings LD (LD pcfa = T). factor: factors true (EFA). : information. med logical; posterior median (TRUE) mean (FALSE) used estimate. SL Significance level interval estimate. default .05. detail logical; significant (FALSE) (TRUE) estimates presented. digits Number significant digits print printing numeric values. istart Starting point Markov chain summary. iend Ending point Markov chain summary; -1 actual final point. ... additional arguments","code":""},{"path":"/reference/summary.lawbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for lawbl objects — summary.lawbl","text":"list matrix containing summarized information based option .","code":""},{"path":"/reference/summary.lawbl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary method for lawbl objects — summary.lawbl","text":"","code":"# \\donttest{ dat <- sim18cfa0$dat J <- ncol(dat) K <- 3 Q<-matrix(-1,J,K); Q[1:2,1]<-Q[7:8,2]<-Q[13:14,3]<-1  m0 <- pcfa(dat = dat, Q = Q, LD = FALSE,burn = 1000, iter = 1000) summary(m0) # summarize basic information #> $NJK #> [1] 1000   18    3 #>  #> $`Miss%` #> [1] 0 #>  #> $`LD Allowed` #> [1] FALSE #>  #> $`Burn in` #> [1] 1000 #>  #> $Iteration #> [1] 1000 #>  #> $`No. of sig lambda` #> [1] 24 #>  #> $Selected #> [1] TRUE TRUE TRUE #>  #> $`Auto, NCONV, MCONV` #> [1]  0  0 10 #>  #> $EPSR #>      Point est. Upper C.I. #> [1,]     1.3778     2.5388 #> [2,]     1.0232     1.0579 #> [3,]     1.3948     2.2712 #>  #> $`DIC, BIC, AIC` #> [1] 4859.694 2843.553 2475.471 #>  #> $Time #>    user  system elapsed  #>    9.13    1.42   10.54  #>  summary(m0, what = 'lambda') #summarize significant loadings #>       Item F     est     sd   lower   upper sig #>  [1,]    1 1  0.6814 0.0488  0.5736  0.7669   1 #>  [2,]    2 1  0.6971 0.0468  0.6117  0.7996   1 #>  [3,]    3 1  0.7011 0.0477  0.6117  0.7983   1 #>  [4,]    4 1  0.7240 0.0469  0.6305  0.8133   1 #>  [5,]    5 1  0.6980 0.0553  0.5878  0.7918   1 #>  [6,]    6 1  0.6711 0.0551  0.5548  0.7588   1 #>  [7,]   16 1 -0.1978 0.0947 -0.3649 -0.0192   1 #>  [8,]   17 1  0.1647 0.0922  0.0042  0.3265   1 #>  [9,]    5 2  0.2922 0.0693  0.1639  0.4138   1 #> [10,]    6 2  0.3096 0.0673  0.1870  0.4250   1 #> [11,]    7 2  0.7324 0.0409  0.6534  0.8110   1 #> [12,]    8 2  0.7277 0.0428  0.6527  0.8154   1 #> [13,]    9 2  0.7393 0.0417  0.6618  0.8217   1 #> [14,]   10 2  0.7208 0.0413  0.6499  0.8113   1 #> [15,]   11 2  0.7230 0.0462  0.6425  0.8247   1 #> [16,]   12 2  0.7131 0.0429  0.6304  0.7991   1 #> [17,]   11 3  0.2850 0.0647  0.1487  0.4047   1 #> [18,]   12 3  0.2689 0.0618  0.1488  0.3875   1 #> [19,]   13 3  0.7351 0.0491  0.6341  0.8276   1 #> [20,]   14 3  0.7115 0.0503  0.6214  0.8205   1 #> [21,]   15 3  0.7481 0.0518  0.6532  0.8524   1 #> [22,]   16 3  0.7429 0.0540  0.6358  0.8493   1 #> [23,]   17 3  0.7402 0.0512  0.6355  0.8329   1 #> [24,]   18 3  0.7443 0.0511  0.6369  0.8335   1 summary(m0, what = 'qlambda') #summarize significant loadings in pattern/Q-matrix format #>           1      2      3 #> I1   0.6814 0.0000 0.0000 #> I2   0.6971 0.0000 0.0000 #> I3   0.7011 0.0000 0.0000 #> I4   0.7240 0.0000 0.0000 #> I5   0.6980 0.2922 0.0000 #> I6   0.6711 0.3096 0.0000 #> I7   0.0000 0.7324 0.0000 #> I8   0.0000 0.7277 0.0000 #> I9   0.0000 0.7393 0.0000 #> I10  0.0000 0.7208 0.0000 #> I11  0.0000 0.7230 0.2850 #> I12  0.0000 0.7131 0.2689 #> I13  0.0000 0.0000 0.7351 #> I14  0.0000 0.0000 0.7115 #> I15  0.0000 0.0000 0.7481 #> I16 -0.1978 0.0000 0.7429 #> I17  0.1647 0.0000 0.7402 #> I18  0.0000 0.0000 0.7443 summary(m0, what = 'offpsx') #summarize significant LD terms #> NULL # }"},{"path":"/news/index.html","id":"lawbl-100","dir":"Changelog","previous_headings":"","what":"LAWBL 1.0.0","title":"LAWBL 1.0.0","text":"Initial release","code":""},{"path":"/news/index.html","id":"lawbl-110","dir":"Changelog","previous_headings":"","what":"LAWBL 1.1.0","title":"LAWBL 1.1.0","text":"CRAN release: 2020-07-23 Added - choice adaptive Lasso Added - tests Updated - vignettes Updated - Documents & references","code":""},{"path":"/news/index.html","id":"lawbl-120","dir":"Changelog","previous_headings":"","what":"LAWBL 1.2.0","title":"LAWBL 1.2.0","text":"Added - Generalized PCFA Added - sim_lvm Updated - vignettes Updated - Documents & references","code":""},{"path":"/news/index.html","id":"lawbl-130","dir":"Changelog","previous_headings":"","what":"LAWBL 1.3.0","title":"LAWBL 1.3.0","text":"CRAN release: 2020-11-03 Added - PCIRM Added - datasets Fixed - bugs Updated - vignettes PCFA, GPCFA, PCIRM Updated - Documents & references","code":""},{"path":"/news/index.html","id":"lawbl-140","dir":"Changelog","previous_headings":"","what":"LAWBL 1.4.0","title":"LAWBL 1.4.0","text":"CRAN release: 2021-04-01 Added - Fully partially EFA Added - datasets Fixed - bugs Updated - vignettes & online tutorials Updated - Documents & references","code":""},{"path":"/news/index.html","id":"lawbl-150","dir":"Changelog","previous_headings":"","what":"LAWBL 1.5.0","title":"LAWBL 1.5.0","text":"Updated - pcfa,pefa,pcirm Updated - sim_lvm,summary.lawbl,plot_lawbl Fixed - bugs Updated - vignettes & online tutorials Updated - Documents & references","code":""}]
